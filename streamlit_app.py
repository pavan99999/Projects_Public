
"outputs": [
    {
     "ename": "ModuleNotFoundError",
     "evalue": "No module named 'yfinance'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[1], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01myfinance\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01myf\u001b[39;00m\n\u001b[0;32m      2\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01mpd\u001b[39;00m\n\u001b[0;32m      3\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mta\u001b[39;00m\n",
      "\u001b[1;31mModuleNotFoundError\u001b[0m: No module named 'yfinance'"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Load IBM data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\", end=\"2024-12-31\")\n",
    "\n",
    "# Step 2: Technical indicators\n",
    "df['rsi'] = ta.momentum.RSIIndicator(df['Close']).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(df['High'], df['Low'], df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(df['Close'], df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Targets\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Feature set\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Targets\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 5: Split sets\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 6: Train models\n",
    "models = {}\n",
    "for name, target_train, target_test in [\n",
    "    ('price_1d', y_train_price_1d, y_test_price_1d),\n",
    "    ('price_3d', y_train_price_3d, y_test_price_3d),\n",
    "    ('price_5d', y_train_price_5d, y_test_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = (reg, target_test)\n",
    "\n",
    "for name, target_train, target_test in [\n",
    "    ('dir_1d', y_train_dir_1d, y_test_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d, y_test_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d, y_test_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = (clf, target_test)\n",
    "\n",
    "# Step 7: Make predictions and evaluate\n",
    "results = X_test.copy()\n",
    "for name, (model, target) in models.items():\n",
    "    pred = model.predict(X_test)\n",
    "    results[f'pred_{name}'] = pred\n",
    "    if 'price' in name:\n",
    "        mae = mean_absolute_error(target, pred)\n",
    "        r2 = r2_score(target, pred)\n",
    "        print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "    else:\n",
    "        print(f\"\\n{name.upper()} Classification Report:\")\n",
    "        print(classification_report(target, pred > 0.5, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "# Step 8: Add actual values for comparison\n",
    "results['actual_price_1d'] = y_test_price_1d.values\n",
    "results['actual_dir_1d'] = y_test_dir_1d.values\n",
    "\n",
    "# Step 9: Save to CSV\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved results to ibm_predictions.csv\")\n",
    "\n",
    "# Step 10: Optional preview\n",
    "print(\"\\nðŸ“„ Sample Output:\")\n",
    "print(results[['pred_price_1d', 'actual_price_1d', 'pred_dir_1d', 'actual_dir_1d']].tail(10))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "9dd14dba-4cf1-407b-879f-51a17db718aa",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting yfinance\n",
      "  Downloading yfinance-0.2.61-py2.py3-none-any.whl.metadata (5.8 kB)\n",
      "Collecting ta\n",
      "  Downloading ta-0.11.0.tar.gz (25 kB)\n",
      "  Preparing metadata (setup.py): started\n",
      "  Preparing metadata (setup.py): finished with status 'done'\n",
      "Requirement already satisfied: scikit-learn in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (1.6.1)\n",
      "Requirement already satisfied: pandas in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (2.2.3)\n",
      "Requirement already satisfied: matplotlib in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (3.10.0)\n",
      "Requirement already satisfied: numpy>=1.16.5 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from yfinance) (2.2.2)\n",
      "Requirement already satisfied: requests>=2.31 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from yfinance) (2.32.3)\n",
      "Collecting multitasking>=0.0.7 (from yfinance)\n",
      "  Downloading multitasking-0.0.11-py3-none-any.whl.metadata (5.5 kB)\n",
      "Requirement already satisfied: platformdirs>=2.0.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from yfinance) (3.10.0)\n",
      "Requirement already satisfied: pytz>=2022.5 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from yfinance) (2024.1)\n",
      "Collecting frozendict>=2.3.4 (from yfinance)\n",
      "  Downloading frozendict-2.4.6-py313-none-any.whl.metadata (23 kB)\n",
      "Collecting peewee>=3.16.2 (from yfinance)\n",
      "  Downloading peewee-3.18.1.tar.gz (3.0 MB)\n",
      "     ---------------------------------------- 0.0/3.0 MB ? eta -:--:--\n",
      "     ------------- -------------------------- 1.0/3.0 MB 5.5 MB/s eta 0:00:01\n",
      "     ---------------------------------------- 3.0/3.0 MB 11.7 MB/s eta 0:00:00\n",
      "  Installing build dependencies: started\n",
      "  Installing build dependencies: finished with status 'done'\n",
      "  Getting requirements to build wheel: started\n",
      "  Getting requirements to build wheel: finished with status 'done'\n",
      "  Preparing metadata (pyproject.toml): started\n",
      "  Preparing metadata (pyproject.toml): finished with status 'done'\n",
      "Requirement already satisfied: beautifulsoup4>=4.11.1 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from yfinance) (4.12.3)\n",
      "Collecting curl_cffi>=0.7 (from yfinance)\n",
      "  Downloading curl_cffi-0.11.1-cp39-abi3-win_amd64.whl.metadata (15 kB)\n",
      "Collecting protobuf>=3.19.0 (from yfinance)\n",
      "  Downloading protobuf-6.31.0-cp310-abi3-win_amd64.whl.metadata (593 bytes)\n",
      "Collecting websockets>=13.0 (from yfinance)\n",
      "  Downloading websockets-15.0.1-cp313-cp313-win_amd64.whl.metadata (7.0 kB)\n",
      "Requirement already satisfied: scipy>=1.6.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from scikit-learn) (1.15.1)\n",
      "Requirement already satisfied: joblib>=1.2.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from scikit-learn) (1.4.2)\n",
      "Requirement already satisfied: threadpoolctl>=3.1.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from scikit-learn) (3.5.0)\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from pandas) (2.9.0.post0)\n",
      "Requirement already satisfied: tzdata>=2022.7 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from pandas) (2023.3)\n",
      "Requirement already satisfied: contourpy>=1.0.1 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from matplotlib) (1.3.1)\n",
      "Requirement already satisfied: cycler>=0.10 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from matplotlib) (0.11.0)\n",
      "Requirement already satisfied: fonttools>=4.22.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from matplotlib) (4.55.3)\n",
      "Requirement already satisfied: kiwisolver>=1.3.1 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from matplotlib) (1.4.8)\n",
      "Requirement already satisfied: packaging>=20.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from matplotlib) (24.2)\n",
      "Requirement already satisfied: pillow>=8 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from matplotlib) (11.1.0)\n",
      "Requirement already satisfied: pyparsing>=2.3.1 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from matplotlib) (3.2.0)\n",
      "Requirement already satisfied: soupsieve>1.2 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from beautifulsoup4>=4.11.1->yfinance) (2.5)\n",
      "Requirement already satisfied: cffi>=1.12.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from curl_cffi>=0.7->yfinance) (1.17.1)\n",
      "Requirement already satisfied: certifi>=2024.2.2 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from curl_cffi>=0.7->yfinance) (2025.1.31)\n",
      "Requirement already satisfied: six>=1.5 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from python-dateutil>=2.8.2->pandas) (1.16.0)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from requests>=2.31->yfinance) (3.3.2)\n",
      "Requirement already satisfied: idna<4,>=2.5 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from requests>=2.31->yfinance) (3.7)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from requests>=2.31->yfinance) (2.3.0)\n",
      "Requirement already satisfied: pycparser in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from cffi>=1.12.0->curl_cffi>=0.7->yfinance) (2.21)\n",
      "Downloading yfinance-0.2.61-py2.py3-none-any.whl (117 kB)\n",
      "Downloading curl_cffi-0.11.1-cp39-abi3-win_amd64.whl (1.4 MB)\n",
      "   ---------------------------------------- 0.0/1.4 MB ? eta -:--:--\n",
      "   ---------------------------------------- 1.4/1.4 MB 22.2 MB/s eta 0:00:00\n",
      "Downloading frozendict-2.4.6-py313-none-any.whl (16 kB)\n",
      "Downloading multitasking-0.0.11-py3-none-any.whl (8.5 kB)\n",
      "Downloading protobuf-6.31.0-cp310-abi3-win_amd64.whl (435 kB)\n",
      "Downloading websockets-15.0.1-cp313-cp313-win_amd64.whl (176 kB)\n",
      "Building wheels for collected packages: ta, peewee\n",
      "  Building wheel for ta (setup.py): started\n",
      "  Building wheel for ta (setup.py): finished with status 'done'\n",
      "  Created wheel for ta: filename=ta-0.11.0-py3-none-any.whl size=29423 sha256=6e3c0ef987c64436a88726d23b1a5f9a1da8dfe1af95bedc28a975434faf8421\n",
      "  Stored in directory: c:\\users\\pavan\\appdata\\local\\pip\\cache\\wheels\\e3\\3a\\ee\\4955a26c90a4b7deb6d725dc8ec7b8604a7aef44e43a2e8af7\n",
      "  Building wheel for peewee (pyproject.toml): started\n",
      "  Building wheel for peewee (pyproject.toml): finished with status 'done'\n",
      "  Created wheel for peewee: filename=peewee-3.18.1-py3-none-any.whl size=139097 sha256=a833c26248e1b6f1a0a4097f2b93a1091f7a93aa35938c9be05804032bdc9f4c\n",
      "  Stored in directory: c:\\users\\pavan\\appdata\\local\\pip\\cache\\wheels\\91\\08\\75\\7ec051c4c2b139cc4aa3a4ae6059d80900c301473b215aad59\n",
      "Successfully built ta peewee\n",
      "Installing collected packages: peewee, multitasking, websockets, protobuf, frozendict, curl_cffi, yfinance, ta\n",
      "Successfully installed curl_cffi-0.11.1 frozendict-2.4.6 multitasking-0.0.11 peewee-3.18.1 protobuf-6.31.0 ta-0.11.0 websockets-15.0.1 yfinance-0.2.61\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install yfinance ta scikit-learn pandas matplotlib\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "960065c1-30ef-47d0-b26a-edf09eac4c85",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "YF.download() has changed argument auto_adjust default to True\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1760, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[1], line 14\u001b[0m\n\u001b[0;32m     11\u001b[0m df \u001b[38;5;241m=\u001b[39m yf\u001b[38;5;241m.\u001b[39mdownload(ticker, start\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2018-01-01\u001b[39m\u001b[38;5;124m\"\u001b[39m, end\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2024-12-31\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Step 2: Technical indicators\u001b[39;00m\n\u001b[1;32m---> 14\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mRSIIndicator(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     15\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mStochasticOscillator(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     16\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mtrend\u001b[38;5;241m.\u001b[39mMACD(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1760, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Load IBM data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\", end=\"2024-12-31\")\n",
    "\n",
    "# Step 2: Technical indicators\n",
    "df['rsi'] = ta.momentum.RSIIndicator(df['Close']).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(df['High'], df['Low'], df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(df['Close'], df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Targets\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Feature set\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Targets\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 5: Split sets\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 6: Train models\n",
    "models = {}\n",
    "for name, target_train, target_test in [\n",
    "    ('price_1d', y_train_price_1d, y_test_price_1d),\n",
    "    ('price_3d', y_train_price_3d, y_test_price_3d),\n",
    "    ('price_5d', y_train_price_5d, y_test_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = (reg, target_test)\n",
    "\n",
    "for name, target_train, target_test in [\n",
    "    ('dir_1d', y_train_dir_1d, y_test_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d, y_test_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d, y_test_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = (clf, target_test)\n",
    "\n",
    "# Step 7: Make predictions and evaluate\n",
    "results = X_test.copy()\n",
    "for name, (model, target) in models.items():\n",
    "    pred = model.predict(X_test)\n",
    "    results[f'pred_{name}'] = pred\n",
    "    if 'price' in name:\n",
    "        mae = mean_absolute_error(target, pred)\n",
    "        r2 = r2_score(target, pred)\n",
    "        print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "    else:\n",
    "        print(f\"\\n{name.upper()} Classification Report:\")\n",
    "        print(classification_report(target, pred > 0.5, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "# Step 8: Add actual values for comparison\n",
    "results['actual_price_1d'] = y_test_price_1d.values\n",
    "results['actual_dir_1d'] = y_test_dir_1d.values\n",
    "\n",
    "# Step 9: Save to CSV\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved results to ibm_predictions.csv\")\n",
    "\n",
    "# Step 10: Optional preview\n",
    "print(\"\\nðŸ“„ Sample Output:\")\n",
    "print(results[['pred_price_1d', 'actual_price_1d', 'pred_dir_1d', 'actual_dir_1d']].tail(10))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7f17f273-5af0-4390-a1e7-deffbf3da116",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "AttributeError",
     "evalue": "'numpy.ndarray' object has no attribute 'diff'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[5], line 14\u001b[0m\n\u001b[0;32m     11\u001b[0m df \u001b[38;5;241m=\u001b[39m yf\u001b[38;5;241m.\u001b[39mdownload(ticker, start\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2018-01-01\u001b[39m\u001b[38;5;124m\"\u001b[39m, end\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2024-12-31\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Step 2: Technical indicators\u001b[39;00m\n\u001b[1;32m---> 14\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mRSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mvalues\u001b[38;5;241m.\u001b[39mflatten())\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     15\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mStochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     16\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mtrend\u001b[38;5;241m.\u001b[39mMACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:37\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     36\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_run\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[1;32m---> 37\u001b[0m     diff \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mdiff(\u001b[38;5;241m1\u001b[39m)\n\u001b[0;32m     38\u001b[0m     up_direction \u001b[38;5;241m=\u001b[39m diff\u001b[38;5;241m.\u001b[39mwhere(diff \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m0.0\u001b[39m)\n\u001b[0;32m     39\u001b[0m     down_direction \u001b[38;5;241m=\u001b[39m \u001b[38;5;241m-\u001b[39mdiff\u001b[38;5;241m.\u001b[39mwhere(diff \u001b[38;5;241m<\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m0.0\u001b[39m)\n",
      "\u001b[1;31mAttributeError\u001b[0m: 'numpy.ndarray' object has no attribute 'diff'"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Load IBM data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\", end=\"2024-12-31\")\n",
    "\n",
    "# Step 2: Technical indicators\n",
    "df['rsi'] = ta.momentum.RSIIndicator(close=df['Close'].values.flatten()).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Targets\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Feature set\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 5: Split sets\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 6: Train models\n",
    "models = {}\n",
    "for name, target_train, target_test in [\n",
    "    ('price_1d', y_train_price_1d, y_test_price_1d),\n",
    "    ('price_3d', y_train_price_3d, y_test_price_3d),\n",
    "    ('price_5d', y_train_price_5d, y_test_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = (reg, target_test)\n",
    "\n",
    "for name, target_train, target_test in [\n",
    "    ('dir_1d', y_train_dir_1d, y_test_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d, y_test_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d, y_test_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = (clf, target_test)\n",
    "\n",
    "# Step 7: Make predictions and evaluate\n",
    "results = X_test.copy()\n",
    "for name, (model, target) in models.items():\n",
    "    pred = model.predict(X_test)\n",
    "    results[f'pred_{name}'] = pred\n",
    "    if 'price' in name:\n",
    "        mae = mean_absolute_error(target, pred)\n",
    "        r2 = r2_score(target, pred)\n",
    "        print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "    else:\n",
    "        print(f\"\\n{name.upper()} Classification Report:\")\n",
    "        print(classification_report(target, pred > 0.5, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "results['actual_price_1d'] = y_test_price_1d.values\n",
    "results['actual_dir_1d'] = y_test_dir_1d.values\n",
    "\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved results to ibm_predictions.csv\")\n",
    "\n",
    "# Step 8: Visualization\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_3d'], label='Predicted 3-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_3d.values, label='Actual 3-Day Price')\n",
    "plt.title(\"IBM - 3-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_5d'], label='Predicted 5-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_5d.values, label='Actual 5-Day Price')\n",
    "plt.title(\"IBM - 5-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "# Step 9: Real-time prediction\n",
    "today_df = yf.download(ticker, period=\"90d\")\n",
    "today_df['rsi'] = ta.momentum.RSIIndicator(close=today_df['Close']).rsi()\n",
    "today_df['stoch'] = ta.momentum.StochasticOscillator(high=today_df['High'], low=today_df['Low'], close=today_df['Close']).stoch()\n",
    "today_df['macd'] = ta.trend.MACD(close=today_df['Close']).macd_diff()\n",
    "today_df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=today_df['Close'], volume=today_df['Volume']).on_balance_volume()\n",
    "today_df['sma_10'] = ta.trend.SMAIndicator(close=today_df['Close'], window=10).sma_indicator()\n",
    "today_df['ema_20'] = ta.trend.EMAIndicator(close=today_df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(close=today_df['Close'], window=20, window_dev=2)\n",
    "today_df['bb_bbm'] = bb.bollinger_mavg()\n",
    "today_df['bb_bbh'] = bb.bollinger_hband()\n",
    "today_df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "today_df.dropna(inplace=True)\n",
    "latest_features = today_df[features].iloc[-1:]\n",
    "\n",
    "predictions = {}\n",
    "for name, (model, _) in models.items():\n",
    "    pred = model.predict(latest_features)[0]\n",
    "    predictions[name] = pred\n",
    "\n",
    "print(f\"\\nðŸ”® IBM Real-Time Predictions (as of {today_df.index[-1].date()}):\")\n",
    "print(f\"ðŸ“Œ Current Close: ${today_df['Close'].iloc[-1]:.2f}\")\n",
    "print(f\"ðŸ“ˆ 1-Day Price: ${predictions['price_1d']:.2f} | Direction: {'Up' if predictions['dir_1d'] > 0.5 else 'Down'}\")\n",
    "print(f\"ðŸ“ˆ 3-Day Price: ${predictions['price_3d']:.2f} | Direction: {'Up' if predictions['dir_3d'] > 0.5 else 'Down'}\")\n",
    "print(f\"ðŸ“ˆ 5-Day Price: ${predictions['price_5d']:.2f} | Direction: {'Up' if predictions['dir_5d'] > 0.5 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4631b6fe-5dda-425c-93e3-24d742a03e3e",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1760, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[4], line 14\u001b[0m\n\u001b[0;32m     11\u001b[0m df \u001b[38;5;241m=\u001b[39m yf\u001b[38;5;241m.\u001b[39mdownload(ticker, start\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2018-01-01\u001b[39m\u001b[38;5;124m\"\u001b[39m, end\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2024-12-31\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Step 2: Technical indicators\u001b[39;00m\n\u001b[1;32m---> 14\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mRSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     15\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mStochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     16\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mtrend\u001b[38;5;241m.\u001b[39mMACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1760, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Load IBM data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\", end=\"2024-12-31\")\n",
    "\n",
    "# Step 2: Technical indicators\n",
    "df['rsi'] = ta.momentum.RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Targets\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Feature set\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 5: Split sets\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 6: Train models\n",
    "models = {}\n",
    "for name, target_train, target_test in [\n",
    "    ('price_1d', y_train_price_1d, y_test_price_1d),\n",
    "    ('price_3d', y_train_price_3d, y_test_price_3d),\n",
    "    ('price_5d', y_train_price_5d, y_test_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = (reg, target_test)\n",
    "\n",
    "for name, target_train, target_test in [\n",
    "    ('dir_1d', y_train_dir_1d, y_test_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d, y_test_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d, y_test_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = (clf, target_test)\n",
    "\n",
    "# Step 7: Make predictions and evaluate\n",
    "results = X_test.copy()\n",
    "for name, (model, target) in models.items():\n",
    "    pred = model.predict(X_test)\n",
    "    results[f'pred_{name}'] = pred\n",
    "    if 'price' in name:\n",
    "        mae = mean_absolute_error(target, pred)\n",
    "        r2 = r2_score(target, pred)\n",
    "        print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "    else:\n",
    "        print(f\"\\n{name.upper()} Classification Report:\")\n",
    "        print(classification_report(target, pred > 0.5, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "results['actual_price_1d'] = y_test_price_1d.values\n",
    "results['actual_dir_1d'] = y_test_dir_1d.values\n",
    "\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved results to ibm_predictions.csv\")\n",
    "\n",
    "# Step 8: Visualization\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_3d'], label='Predicted 3-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_3d.values, label='Actual 3-Day Price')\n",
    "plt.title(\"IBM - 3-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_5d'], label='Predicted 5-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_5d.values, label='Actual 5-Day Price')\n",
    "plt.title(\"IBM - 5-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "# Step 9: Real-time prediction\n",
    "today_df = yf.download(ticker, period=\"90d\")\n",
    "today_df['rsi'] = ta.momentum.RSIIndicator(close=today_df['Close'].values.flatten()).rsi()\n",
    "today_df['stoch'] = ta.momentum.StochasticOscillator(high=today_df['High'], low=today_df['Low'], close=today_df['Close']).stoch()\n",
    "today_df['macd'] = ta.trend.MACD(close=today_df['Close']).macd_diff()\n",
    "today_df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=today_df['Close'], volume=today_df['Volume']).on_balance_volume()\n",
    "today_df['sma_10'] = ta.trend.SMAIndicator(close=today_df['Close'], window=10).sma_indicator()\n",
    "today_df['ema_20'] = ta.trend.EMAIndicator(close=today_df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(close=today_df['Close'], window=20, window_dev=2)\n",
    "today_df['bb_bbm'] = bb.bollinger_mavg()\n",
    "today_df['bb_bbh'] = bb.bollinger_hband()\n",
    "today_df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "today_df.dropna(inplace=True)\n",
    "latest_features = today_df[features].iloc[-1:]\n",
    "\n",
    "predictions = {}\n",
    "for name, (model, _) in models.items():\n",
    "    pred = model.predict(latest_features)[0]\n",
    "    predictions[name] = pred\n",
    "\n",
    "print(f\"\\nðŸ”® IBM Real-Time Predictions (as of {today_df.index[-1].date()}):\")\n",
    "print(f\"ðŸ“Œ Current Close: ${today_df['Close'].iloc[-1]:.2f}\")\n",
    "print(f\"ðŸ“ˆ 1-Day Price: ${predictions['price_1d']:.2f} | Direction: {'Up' if predictions['dir_1d'] > 0.5 else 'Down'}\")\n",
    "print(f\"ðŸ“ˆ 3-Day Price: ${predictions['price_3d']:.2f} | Direction: {'Up' if predictions['dir_3d'] > 0.5 else 'Down'}\")\n",
    "print(f\"ðŸ“ˆ 5-Day Price: ${predictions['price_5d']:.2f} | Direction: {'Up' if predictions['dir_5d'] > 0.5 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "f23a217c-2705-408a-a247-6a621a95d38a",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (1651754068.py, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  Cell \u001b[1;32mIn[6], line 1\u001b[1;36m\u001b[0m\n\u001b[1;33m    [*********************100%***********************]  1 of 1 completed\u001b[0m\n\u001b[1;37m     ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "[*********************100%***********************]  1 of 1 completed\n",
    "---------------------------------------------------------------------------\n",
    "ValueError                                Traceback (most recent call last)\n",
    "Cell In[3], line 14\n",
    "     11 df = yf.download(ticker, start=\"2018-01-01\", end=\"2024-12-31\")\n",
    "     13 # Step 2: Technical indicators\n",
    "---> 14 df['rsi'] = ta.momentum.RSIIndicator(close=df['Close']).rsi()\n",
    "     15 df['stoch'] = ta.momentum.StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "     16 df['macd'] = ta.trend.MACD(close=df['Close']).macd_diff()\n",
    "\n",
    "File ~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34, in RSIIndicator.__init__(self, close, window, fillna)\n",
    "     32 self._window = window\n",
    "     33 self._fillna = fillna\n",
    "---> 34 self._run()\n",
    "\n",
    "File ~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48, in RSIIndicator._run(self)\n",
    "     44 emadn = down_direction.ewm(\n",
    "     45     alpha=1 / self._window, min_periods=min_periods, adjust=False\n",
    "     46 ).mean()\n",
    "     47 relative_strength = emaup / emadn\n",
    "---> 48 self._rsi = pd.Series(\n",
    "     49     np.where(emadn == 0, 100, 100 - (100 / (1 + relative_strength))),\n",
    "     50     index=self._close.index,\n",
    "     51 )\n",
    "\n",
    "File ~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584, in Series.__init__(self, data, index, dtype, name, copy, fastpath)\n",
    "    582         data = data.copy()\n",
    "    583 else:\n",
    "--> 584     data = sanitize_array(data, index, dtype, copy)\n",
    "    586     manager = _get_option(\"mode.data_manager\", silent=True)\n",
    "    587     if manager == \"block\":\n",
    "\n",
    "File ~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659, in sanitize_array(data, index, dtype, copy, allow_2d)\n",
    "    656             subarr = cast(np.ndarray, subarr)\n",
    "    657             subarr = maybe_infer_to_datetimelike(subarr)\n",
    "--> 659 subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)\n",
    "    661 if isinstance(subarr, np.ndarray):\n",
    "    662     # at this point we should have dtype be None or subarr.dtype == dtype\n",
    "    663     dtype = cast(np.dtype, dtype)\n",
    "\n",
    "File ~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718, in _sanitize_ndim(result, data, dtype, index, allow_2d)\n",
    "    716     if allow_2d:\n",
    "    717         return result\n",
    "--> 718     raise ValueError(\n",
    "    719         f\"Data must be 1-dimensional, got ndarray of shape {data.shape} instead\"\n",
    "    720     )\n",
    "    721 if is_object_dtype(dtype) and isinstance(dtype, ExtensionDtype):\n",
    "    722     # i.e. NumpyEADtype(\"O\")\n",
    "    724     result = com.asarray_tuplesafe(data, dtype=np.dtype(\"object\"))\n",
    "\n",
    "ValueError: Data must be 1-dimensional, got ndarray of shape (1760, 1) instead"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "13199573-49ad-4502-bc05-00368ffedf0b",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "41dcdd90-14ce-4de6-82c9-4933ed3297f0",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1760, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[7], line 14\u001b[0m\n\u001b[0;32m     11\u001b[0m df \u001b[38;5;241m=\u001b[39m yf\u001b[38;5;241m.\u001b[39mdownload(ticker, start\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2018-01-01\u001b[39m\u001b[38;5;124m\"\u001b[39m, end\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2024-12-31\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Step 2: Technical indicators\u001b[39;00m\n\u001b[1;32m---> 14\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mRSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     15\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mStochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     16\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mtrend\u001b[38;5;241m.\u001b[39mMACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1760, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Load IBM data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\", end=\"2024-12-31\")\n",
    "\n",
    "# Step 2: Technical indicators\n",
    "df['rsi'] = ta.momentum.RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Targets\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Feature set\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 5: Split sets\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 6: Train models\n",
    "models = {}\n",
    "for name, target_train, target_test in [\n",
    "    ('price_1d', y_train_price_1d, y_test_price_1d),\n",
    "    ('price_3d', y_train_price_3d, y_test_price_3d),\n",
    "    ('price_5d', y_train_price_5d, y_test_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = (reg, target_test)\n",
    "\n",
    "for name, target_train, target_test in [\n",
    "    ('dir_1d', y_train_dir_1d, y_test_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d, y_test_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d, y_test_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = (clf, target_test)\n",
    "\n",
    "# Step 7: Make predictions and evaluate\n",
    "results = X_test.copy()\n",
    "for name, (model, target) in models.items():\n",
    "    pred = model.predict(X_test)\n",
    "    results[f'pred_{name}'] = pred\n",
    "    if 'price' in name:\n",
    "        mae = mean_absolute_error(target, pred)\n",
    "        r2 = r2_score(target, pred)\n",
    "        print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "    else:\n",
    "        print(f\"\\n{name.upper()} Classification Report:\")\n",
    "        print(classification_report(target, pred > 0.5, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "results['actual_price_1d'] = y_test_price_1d.values\n",
    "results['actual_dir_1d'] = y_test_dir_1d.values\n",
    "\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved results to ibm_predictions.csv\")\n",
    "\n",
    "# Step 8: Visualization\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_3d'], label='Predicted 3-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_3d.values, label='Actual 3-Day Price')\n",
    "plt.title(\"IBM - 3-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_5d'], label='Predicted 5-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_5d.values, label='Actual 5-Day Price')\n",
    "plt.title(\"IBM - 5-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "# Step 9: Real-time prediction\n",
    "today_df = yf.download(ticker, period=\"90d\")\n",
    "today_df['rsi'] = ta.momentum.RSIIndicator(close=today_df['Close'].values.flatten()).rsi()\n",
    "today_df['stoch'] = ta.momentum.StochasticOscillator(high=today_df['High'], low=today_df['Low'], close=today_df['Close']).stoch()\n",
    "today_df['macd'] = ta.trend.MACD(close=today_df['Close']).macd_diff()\n",
    "today_df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=today_df['Close'], volume=today_df['Volume']).on_balance_volume()\n",
    "today_df['sma_10'] = ta.trend.SMAIndicator(close=today_df['Close'], window=10).sma_indicator()\n",
    "today_df['ema_20'] = ta.trend.EMAIndicator(close=today_df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(close=today_df['Close'], window=20, window_dev=2)\n",
    "today_df['bb_bbm'] = bb.bollinger_mavg()\n",
    "today_df['bb_bbh'] = bb.bollinger_hband()\n",
    "today_df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "today_df.dropna(inplace=True)\n",
    "latest_features = today_df[features].iloc[-1:]\n",
    "\n",
    "predictions = {}\n",
    "for name, (model, _) in models.items():\n",
    "    pred = model.predict(latest_features)[0]\n",
    "    predictions[name] = pred\n",
    "\n",
    "print(f\"\\nðŸ”® IBM Real-Time Predictions (as of {today_df.index[-1].date()}):\")\n",
    "print(f\"ðŸ“Œ Current Close: ${today_df['Close'].iloc[-1]:.2f}\")\n",
    "print(f\"ðŸ“ˆ 1-Day Price: ${predictions['price_1d']:.2f} | Direction: {'Up' if predictions['dir_1d'] > 0.5 else 'Down'}\")\n",
    "print(f\"ðŸ“ˆ 3-Day Price: ${predictions['price_3d']:.2f} | Direction: {'Up' if predictions['dir_3d'] > 0.5 else 'Down'}\")\n",
    "print(f\"ðŸ“ˆ 5-Day Price: ${predictions['price_5d']:.2f} | Direction: {'Up' if predictions['dir_5d'] > 0.5 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "6dd2be88-e541-4f58-9259-5b9268c53487",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1760, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[8], line 14\u001b[0m\n\u001b[0;32m     11\u001b[0m df \u001b[38;5;241m=\u001b[39m yf\u001b[38;5;241m.\u001b[39mdownload(ticker, start\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2018-01-01\u001b[39m\u001b[38;5;124m\"\u001b[39m, end\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2024-12-31\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Step 2: Technical indicators (corrected)\u001b[39;00m\n\u001b[1;32m---> 14\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mRSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     15\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mStochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     16\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mtrend\u001b[38;5;241m.\u001b[39mMACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1760, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Load IBM data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\", end=\"2024-12-31\")\n",
    "\n",
    "# Step 2: Technical indicators (corrected)\n",
    "df['rsi'] = ta.momentum.RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Targets\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Feature set\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Targets\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 5: Split sets\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 6: Train models\n",
    "models = {}\n",
    "for name, target_train, target_test in [\n",
    "    ('price_1d', y_train_price_1d, y_test_price_1d),\n",
    "    ('price_3d', y_train_price_3d, y_test_price_3d),\n",
    "    ('price_5d', y_train_price_5d, y_test_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = (reg, target_test)\n",
    "\n",
    "for name, target_train, target_test in [\n",
    "    ('dir_1d', y_train_dir_1d, y_test_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d, y_test_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d, y_test_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = (clf, target_test)\n",
    "\n",
    "# Step 7: Make predictions and evaluate\n",
    "results = X_test.copy()\n",
    "for name, (model, target) in models.items():\n",
    "    pred = model.predict(X_test)\n",
    "    results[f'pred_{name}'] = pred\n",
    "    if 'price' in name:\n",
    "        mae = mean_absolute_error(target, pred)\n",
    "        r2 = r2_score(target, pred)\n",
    "        print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "    else:\n",
    "        print(f\"\\n{name.upper()} Classification Report:\")\n",
    "        print(classification_report(target, pred > 0.5, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "# Step 8: Add actual values for comparison\n",
    "results['actual_price_1d'] = y_test_price_1d.values\n",
    "results['actual_dir_1d'] = y_test_dir_1d.values\n",
    "\n",
    "# Step 9: Save to CSV\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved results to ibm_predictions.csv\")\n",
    "\n",
    "# Step 10: Visualization for 3-day and 5-day price prediction\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_3d'], label='Predicted 3-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_3d.values, label='Actual 3-Day Price')\n",
    "plt.title(\"ðŸ“‰ IBM - 3-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_5d'], label='Predicted 5-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_5d.values, label='Actual 5-Day Price')\n",
    "plt.title(\"ðŸ“‰ IBM - 5-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "28c462d2-e0f5-4af2-a7db-b3def9dbd8ad",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1760, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[9], line 19\u001b[0m\n\u001b[0;32m     16\u001b[0m         df[col] \u001b[38;5;241m=\u001b[39m df[col]\u001b[38;5;241m.\u001b[39miloc[:, \u001b[38;5;241m0\u001b[39m]\n\u001b[0;32m     18\u001b[0m \u001b[38;5;66;03m# Step 2: Technical indicators (all produce 1D Series)\u001b[39;00m\n\u001b[1;32m---> 19\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mRSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     20\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mmomentum\u001b[38;5;241m.\u001b[39mStochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     21\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m ta\u001b[38;5;241m.\u001b[39mtrend\u001b[38;5;241m.\u001b[39mMACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1760, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Load IBM data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\", end=\"2024-12-31\")\n",
    "\n",
    "# Fix for possible (n,1) DataFrame instead of Series issues:\n",
    "for col in ['Close', 'High', 'Low', 'Volume']:\n",
    "    if isinstance(df[col], pd.DataFrame):\n",
    "        df[col] = df[col].iloc[:, 0]\n",
    "\n",
    "# Step 2: Technical indicators (all produce 1D Series)\n",
    "df['rsi'] = ta.momentum.RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = ta.volatility.BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Targets (shifted close and direction for 1, 3, 5 day horizons)\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Drop rows with NaN values created by indicator calculations and target shifts\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 5: Train/test split (no shuffle because time series)\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 6: Train models\n",
    "models = {}\n",
    "\n",
    "# Regression models for price prediction\n",
    "for name, target_train in [\n",
    "    ('price_1d', y_train_price_1d),\n",
    "    ('price_3d', y_train_price_3d),\n",
    "    ('price_5d', y_train_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = reg\n",
    "\n",
    "# Classification models for direction prediction\n",
    "for name, target_train in [\n",
    "    ('dir_1d', y_train_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = clf\n",
    "\n",
    "# Step 7: Predictions and evaluation\n",
    "results = X_test.copy()\n",
    "\n",
    "for name, model in models.items():\n",
    "    pred = model.predict(X_test)\n",
    "    results[f'pred_{name}'] = pred\n",
    "\n",
    "# Regression metrics\n",
    "for name, y_test in [\n",
    "    ('price_1d', y_test_price_1d),\n",
    "    ('price_3d', y_test_price_3d),\n",
    "    ('price_5d', y_test_price_5d),\n",
    "]:\n",
    "    mae = mean_absolute_error(y_test, results[f'pred_{name}'])\n",
    "    r2 = r2_score(y_test, results[f'pred_{name}'])\n",
    "    print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "\n",
    "# Classification reports\n",
    "for name, y_test in [\n",
    "    ('dir_1d', y_test_dir_1d),\n",
    "    ('dir_3d', y_test_dir_3d),\n",
    "    ('dir_5d', y_test_dir_5d),\n",
    "]:\n",
    "    pred_labels = (results[f'pred_{name}'] > 0.5).astype(int)\n",
    "    print(f\"\\n{name.upper()} Classification Report:\")\n",
    "    print(classification_report(y_test, pred_labels, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "# Step 8: Add actual values for comparison (1-day targets shown here, extend as needed)\n",
    "results['actual_price_1d'] = y_test_price_1d.values\n",
    "results['actual_dir_1d'] = y_test_dir_1d.values\n",
    "\n",
    "# Step 9: Save results\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved results to ibm_predictions.csv\")\n",
    "\n",
    "# Step 10: Visualization example for 3-day price\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_3d'], label='Predicted 3-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_3d.values, label='Actual 3-Day Price')\n",
    "plt.title(\"IBM 3-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Date Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "# Step 11: Real-time prediction using latest data row (today's indicators)\n",
    "latest_data = df[features].iloc[-1:].copy()\n",
    "\n",
    "pred_price_1d = models['price_1d'].predict(latest_data)[0]\n",
    "pred_dir_1d = models['dir_1d'].predict(latest_data)[0]\n",
    "\n",
    "print(f\"\\nðŸ”® Real-time Prediction for next day:\")\n",
    "print(f\"Predicted next day closing price: ${pred_price_1d:.2f}\")\n",
    "print(f\"Predicted direction: {'Up' if pred_dir_1d == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "fc0c0d95-dedb-423a-bddd-94d2ba7bbf59",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Expected column 'Close' not found in data",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[10], line 21\u001b[0m\n\u001b[0;32m     19\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m col \u001b[38;5;129;01min\u001b[39;00m [\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]:\n\u001b[0;32m     20\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m col \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m df\u001b[38;5;241m.\u001b[39mcolumns:\n\u001b[1;32m---> 21\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mExpected column \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mcol\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m not found in data\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m     22\u001b[0m     \u001b[38;5;66;03m# If the column is a DataFrame (2D), convert to Series\u001b[39;00m\n\u001b[0;32m     23\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(df[col], pd\u001b[38;5;241m.\u001b[39mDataFrame):\n",
      "\u001b[1;31mValueError\u001b[0m: Expected column 'Close' not found in data"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Download data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\",)\n",
    "\n",
    "# If multi-level columns, flatten them (sometimes yf.download returns this)\n",
    "if isinstance(df.columns, pd.MultiIndex):\n",
    "    df.columns = ['_'.join(col).strip() for col in df.columns.values]\n",
    "\n",
    "# Now ensure columns of interest are 1D Series:\n",
    "for col in ['Close', 'High', 'Low', 'Volume']:\n",
    "    if col not in df.columns:\n",
    "        raise ValueError(f\"Expected column '{col}' not found in data\")\n",
    "    # If the column is a DataFrame (2D), convert to Series\n",
    "    if isinstance(df[col], pd.DataFrame):\n",
    "        df[col] = df[col].iloc[:, 0]\n",
    "\n",
    "# Just to be safe, explicitly convert to 1D Series:\n",
    "df['Close'] = df['Close'].astype(float).squeeze()\n",
    "df['High'] = df['High'].astype(float).squeeze()\n",
    "df['Low'] = df['Low'].astype(float).squeeze()\n",
    "df['Volume'] = df['Volume'].astype(float).squeeze()\n",
    "\n",
    "# Step 2: Compute technical indicators (all expect 1D Series)\n",
    "df['rsi'] = ta.momentum.RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(\n",
    "    high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "\n",
    "bb = ta.volatility.BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Create targets for price and direction at 1, 3, 5 days ahead\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Drop rows with NaN from indicator calc or shifting\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Define features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 5: Train/test split - no shuffle for time series\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 6: Train models\n",
    "models = {}\n",
    "\n",
    "# Regression models\n",
    "for name, target_train in [\n",
    "    ('price_1d', y_train_price_1d),\n",
    "    ('price_3d', y_train_price_3d),\n",
    "    ('price_5d', y_train_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = reg\n",
    "\n",
    "# Classification models\n",
    "for name, target_train in [\n",
    "    ('dir_1d', y_train_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = clf\n",
    "\n",
    "# Step 7: Predict and evaluate\n",
    "results = X_test.copy()\n",
    "for name, model in models.items():\n",
    "    results[f'pred_{name}'] = model.predict(X_test)\n",
    "\n",
    "# Regression evaluation\n",
    "for name, y_test in [\n",
    "    ('price_1d', y_test_price_1d),\n",
    "    ('price_3d', y_test_price_3d),\n",
    "    ('price_5d', y_test_price_5d),\n",
    "]:\n",
    "    mae = mean_absolute_error(y_test, results[f'pred_{name}'])\n",
    "    r2 = r2_score(y_test, results[f'pred_{name}'])\n",
    "    print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "\n",
    "# Classification reports\n",
    "for name, y_test in [\n",
    "    ('dir_1d', y_test_dir_1d),\n",
    "    ('dir_3d', y_test_dir_3d),\n",
    "    ('dir_5d', y_test_dir_5d),\n",
    "]:\n",
    "    pred_labels = (results[f'pred_{name}'] > 0.5).astype(int)\n",
    "    print(f\"\\n{name.upper()} Classification Report:\")\n",
    "    print(classification_report(y_test, pred_labels, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "# Step 8: Save predictions\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved predictions to ibm_predictions.csv\")\n",
    "\n",
    "# Step 9: Visualize 3-day price predictions\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_3d'], label='Predicted 3-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_3d.values, label='Actual 3-Day Price')\n",
    "plt.title(\"IBM 3-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Date Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "# Step 10: Real-time prediction (latest available row)\n",
    "latest_data = df[features].iloc[-1:].copy()\n",
    "pred_price_1d = models['price_1d'].predict(latest_data)[0]\n",
    "pred_dir_1d = models['dir_1d'].predict(latest_data)[0]\n",
    "\n",
    "print(f\"\\nðŸ”® Real-time Prediction for next day:\")\n",
    "print(f\"Predicted next day closing price: ${pred_price_1d:.2f}\")\n",
    "print(f\"Predicted direction: {'Up' if pred_dir_1d == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b59e8f75-dfbd-4578-b537-1a5381467272",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "PRICE_1D - MAE: 49.00, RÂ²: -2.23\n",
      "\n",
      "PRICE_3D - MAE: 49.65, RÂ²: -2.29\n",
      "\n",
      "PRICE_5D - MAE: 48.81, RÂ²: -2.19\n",
      "\n",
      "DIR_1D Classification Report:\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "        Down       0.49      0.20      0.29       159\n",
      "          Up       0.58      0.84      0.68       206\n",
      "\n",
      "    accuracy                           0.56       365\n",
      "   macro avg       0.53      0.52      0.48       365\n",
      "weighted avg       0.54      0.56      0.51       365\n",
      "\n",
      "\n",
      "DIR_3D Classification Report:\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "        Down       0.41      1.00      0.58       149\n",
      "          Up       0.00      0.00      0.00       216\n",
      "\n",
      "    accuracy                           0.41       365\n",
      "   macro avg       0.20      0.50      0.29       365\n",
      "weighted avg       0.17      0.41      0.24       365\n",
      "\n",
      "\n",
      "DIR_5D Classification Report:\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "        Down       0.50      0.03      0.05       152\n",
      "          Up       0.59      0.98      0.73       213\n",
      "\n",
      "    accuracy                           0.58       365\n",
      "   macro avg       0.54      0.50      0.39       365\n",
      "weighted avg       0.55      0.58      0.45       365\n",
      "\n",
      "\n",
      "âœ… Saved results to ibm_predictions.csv\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\pavan\\Desktop\\sample_project\\env\\Lib\\site-packages\\sklearn\\metrics\\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", len(result))\n",
      "C:\\Users\\pavan\\Desktop\\sample_project\\env\\Lib\\site-packages\\sklearn\\metrics\\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", len(result))\n",
      "C:\\Users\\pavan\\Desktop\\sample_project\\env\\Lib\\site-packages\\sklearn\\metrics\\_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, f\"{metric.capitalize()} is\", len(result))\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABKUAAAHqCAYAAADVi/1VAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAA6fdJREFUeJzs3Xd0VFXXx/HvpPdAEkLohN57UbpUBVQsFCso1gexl1d9VGxgLw82VIqCKGJBREVAmogIUqSK0ltCJwmQnvv+cTKThPRkkkn5fdbKundu3TM3AbLZZx+bZVkWIiIiIiIiIiIipcjN1QGIiIiIiIiIiEjlo6SUiIiIiIiIiIiUOiWlRERERERERESk1CkpJSIiIiIiIiIipU5JKRERERERERERKXVKSomIiIiIiIiISKlTUkpEREREREREREqdklIiIiIiIiIiIlLqlJQSEREREREREZFSp6SUiIhIGTFjxgxsNht//vmnY9uECROw2WyOLzc3N2rUqMHgwYP57bffspy/b98+x3ETJkzI8R633nqr45j8LFmyhAEDBlCzZk28vb0JDw+nb9++/PjjjwV+T3369MkSe2BgII0aNWL48OF89dVXpKWlFfhaJeXBBx/EZrMxdOjQHPcvX74cm83GV199VcqR5c4e0/Lly/M8zv49Zf/y8PCgdu3a3HLLLRw+fLhA9xozZgz169cvftCFYH9/9i93d3eqV6/O8OHD2bFjR6nE0KdPH/r06eN4bf/5mjFjRqGus337diZMmMC+ffuy7XPFZysiIlKWKCklIiJSDixcuJDff/+dVatW8eabbxIdHU2fPn3YsGFDtmMDAwOZMWNGtoTP2bNnmTt3LkFBQQW658mTJ2nZsiVvvvkmixYtYsqUKXh6ejJkyBBmzZpV4NgbNGjA77//zurVq5k3bx7/93//R3x8PMOHD6dPnz7ExMQU+FrOlpyc7HgvCxcuLHCipryZPn06v//+O4sXL+b222/n888/p2fPnpw7dy7fc5966im+/fbbUogyu4kTJ/L777+zbNkyHnvsMRYvXkz37t1d8pxq1KjB77//zpAhQwp13vbt23n22WdzTEq58rMVEREpCzxcHYCIiIjkr2PHjoSFhQHQrVs3unTpQsOGDfnqq6/o0KFDlmNHjhzJxx9/zC+//MKAAQMc2+fMmUNqairDhg0rUFJp5MiRjBw5Msu2oUOHEhkZyYcffsiNN95YoNh9fX256KKLsmy77bbbmD59Orfeeit33HEHc+bMKdC1nO27777j+PHjDBkyhB9++IFPPvmEJ554wiWxlKRWrVrRqVMnAC655BJSU1N5/vnnmTdvHjfccEOO55w/fx4/Pz8aNmxYmqFm0bhxY8f3Tq9evahSpQpjx45lxowZPPnkkzmeY4/b2by9vbN9HxeXKz9bERGRskCVUiIiIuVQcHAwAJ6entn2NW3alG7dujFt2rQs26dNm8bVV1/tOLcoPD09qVKlCh4exf9/rVtuuYXBgwczd+5c9u/f79j+7rvv0qtXL8LDw/H396d169a88sorJCcnO455/vnn8fDw4ODBg9mue+uttxIaGkpCQkK+MUydOhUvLy+mT59OnTp1mD59OpZl5XhscnIyTz75JDVr1iQoKIj+/fuzc+fObMctWbKEfv36ERQUhJ+fH927d+eXX37JcsyuXbu45ZZbaNy4MX5+ftSqVYvLL7+cLVu2ZLve33//zaWXXoqfnx9hYWHcddddxMXF5fve8mJPrtg/9zFjxhAQEMCWLVsYOHAggYGB9OvXz7HvwiFmaWlpTJ48mXbt2uHr60uVKlW46KKLmD9/fpbj5syZw8UXX4y/vz8BAQEMGjSIjRs3Oi1u+/DWDRs2cO2111K1alVHoseyLN577z1HjFWrVuXaa69lz549Wa5pWRavvPIK9erVw8fHhw4dOvDTTz9lu3duw/f+/vtvrrvuOqpXr463tzd169bl5ptvJjExkRkzZjB8+HDAJAPtwxHt18jps01ISODxxx8nMjISLy8vatWqxbhx4zhz5kyW4+rXr8/QoUNZuHAhHTp0wNfXl2bNmmX7uRcRESnLlJQSEREpB1JTU0lJSSEpKYldu3Yxbtw4vL29ufbaa3M8fuzYscybN4/Tp08DsHPnTlavXs3YsWMLfe+0tDRSUlI4cuQIzzzzDP/88w8PPfRQsd6P3RVXXIFlWfz666+Obbt37+b6669n5syZLFiwgLFjx/Lqq69y5513Oo6588478fDwYMqUKVmud+rUKb744gvGjh2Lj49Pnvc+dOgQixYt4sorr6RatWqMHj2aXbt2sXLlyhyPf+KJJ9i/fz8ff/wxH374If/++y+XX345qampjmNmzZrFwIEDCQoK4pNPPuHLL78kJCSEQYMGZUlMHTlyhNDQUF566SUWLlzIu+++i4eHB127ds2S6Dp69Ci9e/dm69atvPfee8ycOZOzZ89yzz33FOwDzsWuXbsAqFatmmNbUlISV1xxBX379uW7777j2WefzfX8MWPGcN9999G5c2fmzJnDF198wRVXXJFliNrEiRO57rrraNGiBV9++SUzZ84kLi6Onj17sn37dqfFDXD11VfTqFEj5s6dywcffACY75H777+f/v37M2/ePN577z22bdtGt27dOHr0qOPcZ599lscee4wBAwYwb9487r77bm6//fYcE44X+uuvv+jcuTNr1qzhueee46effmLSpEkkJiaSlJTEkCFDmDhxImCSrb///nueQwAty2LYsGG89tpr3HTTTfzwww88+OCDfPLJJ/Tt25fExMRs93/ooYd44IEH+O6772jTpg1jx47N9XtYRESkzLFERESkTJg+fboFWOvWrXNse+aZZywg21dQUJD1zTffZDl/7969FmC9+uqrVlxcnBUQEGC98847lmVZ1iOPPGJFRkZaaWlp1rhx46zC/BNg0KBBed43L71797ZatmyZ6/6ffvrJAqyXX345x/2pqalWcnKy9emnn1ru7u7WqVOnHPtGjx5thYeHW4mJiY5tL7/8suXm5mbt3bs339iee+45C7AWLlxoWZZl7dmzx7LZbNZNN92U5bhly5ZZgDV48OAs27/88ksLsH7//XfLsizr3LlzVkhIiHX55Zdnew9t27a1unTpkmssKSkpVlJSktW4cWPrgQcecGx/7LHHLJvNZm3atCnL8QMGDLAAa9myZXm+R/v31Jo1a6zk5GQrLi7OWrBggVWtWjUrMDDQio6OtizLfJaANW3atGzXGD16tFWvXj3H65UrV1qA9eSTT+Z63wMHDlgeHh7W+PHjs2yPi4uzIiIirBEjRuQZt/0znzNnjpWcnGydP3/eWrlypdWoUSPL3d3d+uuvvyzLyvj5ePrpp7Oc//vvv1uA9frrr2fZfvDgQcvX19d69NFHLcuyrNOnT1s+Pj7WVVddleW43377zQKs3r17O7bZf76mT5/u2Na3b1+rSpUq1rFjx3J9L3Pnzs31WV342S5cuNACrFdeeSXLcXPmzLEA68MPP3Rsq1evnuXj42Pt37/fsS0+Pt4KCQmx7rzzzlzjERERKUtUKSUiIlIOLFmyhHXr1rF27VoWLFhA//79GTVqVK5NkgMCAhg+fDjTpk0jJSWFTz/9lFtuuaVAs+5daPLkyaxdu5bvvvuOQYMGMXLkSD7//HPHfnsllf0rc+VQfqwchspt3LiRK664gtDQUNzd3fH09OTmm28mNTWVf/75x3Hcfffdx7Fjx5g7d64jjvfff58hQ4bkO6OZZVmOIXv2vluRkZH06dOHr7/+mtjY2GznXHHFFVlet2nTBsgYSrZ69WpOnTrF6NGjs3weaWlpXHrppaxbt87RWDwlJYWJEyfSokULvLy88PDwwMvLi3///TfL7HLLli2jZcuWtG3bNsu9r7/++jzf34UuuugiPD09CQwMZOjQoURERPDTTz9RvXr1LMddc801+V7LPrRt3LhxuR7z888/k5KSws0335zls/Dx8aF37975zhpoN3LkSDw9PfHz86NXr16kpqby1VdfOT773OJesGABNpuNG2+8Mcv9IyIiaNu2reP+v//+OwkJCdn6anXr1o169erlGdv58+dZsWIFI0aMyFa5VVRLly4FTCVaZsOHD8ff3z/bMNB27dpRt25dx2sfHx+aNGmSZTisiIhIWaZG5yIiIuVA27ZtHY3OAS677DJat27NuHHjuOqqq3I8Z+zYsfTo0YMXX3yR48ePZ/tFt6AaN27sWL/iiiu47LLLGDduHCNHjsTNzY1bb72VTz75xHFMYZIO9l+ea9asCcCBAwfo2bMnTZs25e2336Z+/fr4+Piwdu1axo0bR3x8vOPc9u3b07NnT959911uuOEGFixYwL59+7IN6cvJ0qVL2bt3Lw8++GCWBNSIESNYtmwZn3/+eZbhggChoaFZXnt7ewM4YrIPCcttSCWY4YX+/v48+OCDvPvuuzz22GP07t2bqlWr4ubmxm233ZblPZ48eZLIyMhs14mIiMj3PWb26aef0rx5czw8PKhevTo1atTIdoyfn1+BZmY8fvw47u7uecZg/yw6d+6c4343t4L9v+jLL79M3759cXd3JywsjDp16uR43IXv5+jRo1iWlS3pZtegQQPAfL6Q8+eZ32d8+vRpUlNTqV27dr7vo6BOnjyJh4dHtiSXzWYjIiLCEa/dhd+TYL4vM38PiYiIlGVKSomIiJRDbm5utGzZkrlz53Ls2DHCw8OzHdO9e3eaNm3Kc889x4ABA3L9hb6wunTpwsKFCzl+/DjVq1dnwoQJWXocBQYGFvha8+fPx2az0atXLwDmzZvHuXPn+Oabb7JUqmzatCnH8++9916GDx/Ohg0beOedd2jSpEmWGQdzM3XqVADeeOMN3njjjRz3X5iUyo89aTh58uRcZ2mzJ0lmzZrFzTff7Og3ZHfixAmqVKnieB0aGkp0dHS26+S0LS/Nmzd3zL6Xm4JW0VWrVo3U1FSio6NzTG5Bxmfx1Vdf5VtxlJcGDRrkGzdkjz0sLAybzcavv/7qSB5mZt9mT+rk9hnnVXEXEhKCu7s7hw4dyje+ggoNDSUlJYXjx49nSUxZlkV0dHSuST4REZHySsP3REREyqHU1FS2bNmCt7d3ntUt//3vf7n88sud1pjcsixWrFhBlSpVHL/Q169fn06dOjm+mjZtWqBrTZ8+nZ9++onrrrvOMQTJnlzInEiwLIuPPvoox2tcddVV1K1bl4ceeoglS5bwn//8J9/kyunTp/n222/p3r07y5Yty/Z1ww03sG7dOrZu3Vqg92HXvXt3qlSpwvbt27N8Hpm/vLy8HO/zwmTJDz/8wOHDh7Nsu+SSS9i2bRt//fVXlu2zZ88uVGzOdNlllwHw/vvv53rMoEGD8PDwYPfu3bl+FiVp6NChWJbF4cOHc7x369atATOs0cfHh88++yzL+atXr853CJyvry+9e/dm7ty5nDhxItfjLqyoy4t9xsNZs2Zl2f71119z7tw5x34REZGKQpVSIiIi5cD69esJDg4GzNCkadOm8ffff/PAAw/kOcvcjTfeyI033like1555ZW0bduWdu3aERoaypEjR5gxYwYrVqxwzBZXEPHx8axZs8axvmfPHubNm8eCBQvo3bu3Y7Y0gAEDBuDl5cV1113Ho48+SkJCAu+//75jFsELubu7M27cOB577DH8/f0LNETxs88+IyEhgXvvvZc+ffpk2x8aGspnn33G1KlTefPNNwv0HsH08Zo8eTKjR4/m1KlTXHvttYSHh3P8+HH++usvjh8/7kjkDB06lBkzZtCsWTPatGnD+vXrefXVV7MNBbv//vuZNm0aQ4YM4YUXXqB69ep89tln/P333wWOy9l69uzJTTfdxAsvvMDRo0cZOnQo3t7ebNy4ET8/P8aPH0/9+vV57rnnePLJJ9mzZw+XXnopVatW5ejRo6xduxZ/f/88Z/crru7du3PHHXdwyy238Oeff9KrVy/8/f2Jiopi1apVtG7dmrvvvpuqVavy8MMP88ILL3DbbbcxfPhwDh48yIQJEwo0RPKNN96gR48edO3alf/7v/+jUaNGHD16lPnz5zNlyhQCAwNp1aoVAB9++CGBgYH4+PgQGRmZ49C7AQMGMGjQIB577DFiY2Pp3r07mzdv5plnnqF9+/bcdNNNTv+sREREXElJKRERkXLg0ksvdayHhITQuHFjpk2bxujRo0vsnt27d+err77inXfeITY2lipVqtCpUycWLFiQ65T2OdmzZw8XX3wxAP7+/lSvXp0OHTowd+5crr766iz9hZo1a8bXX3/Nf//7X66++mpCQ0O5/vrrefDBBx0VOhcaOXIkjz32GDfddJMjcZeXqVOnEh4ezrBhw3Lc37p1ay666CJmzZrFyy+/XOD3CSYJWLduXV555RXuvPNO4uLiCA8Pp127dlkSZm+//Taenp5MmjSJs2fP0qFDB7755hv++9//ZrleREQEK1as4L777uPuu+/Gz8+Pq666infeeYcrr7yyULE504wZM+jQoQNTp05lxowZ+Pr60qJFC5544gnHMY8//jgtWrTg7bff5vPPPycxMZGIiAg6d+7MXXfdVeIxTpkyhYsuuogpU6bw3nvvkZaWRs2aNenevTtdunRxHPfcc8/h7+/Pe++9x8yZM2nWrBkffPABr732Wr73aNu2LWvXruWZZ57h8ccfJy4ujoiICPr27euoiouMjOStt97i7bffpk+fPqSmpjJ9+vQcE6g2m4158+YxYcIEpk+fzosvvkhYWBg33XQTEydOzHEoooiISHlms3Ka9kZERESknJg8eTL33nsvW7dupWXLlq4OR0REREQKSEkpERERKZc2btzI3r17ufPOO+nevTvz5s1zdUgiIiIiUghKSomIiEi5VL9+faKjo+nZsyczZ84sUA8gERERESk7lJQSEREREREREZFS55b/ISIiIiIiIiIiIs6lpJSIiIiIiIiIiJQ6JaVERERERERERKTUebg6gLIgLS2NI0eOEBgYiM1mc3U4IiIiIiIiIiLllmVZxMXFUbNmTdzccq+HUlIKOHLkCHXq1HF1GCIiIiIiIiIiFcbBgwepXbt2rvuVlAICAwMB82EFBQW5OBqxS05OZtGiRQwcOBBPT09XhyNFpOdYseh5Vix6nhWTnmvFo2daseh5lm96fhWLnmfJiY2NpU6dOo58S26UlALHkL2goCAlpcqQ5ORk/Pz8CAoK0h8Q5ZieY8Wi51mx6HlWTHquFY+eacWi51m+6flVLHqeJS+/FklqdC4iIiIiIiIiIqVOSSkRERERERERESl1SkqJiIiIiIiIiEipU0+pQkhNTSU5OdnVYVQaycnJeHh4kJCQQGpqqqvDkQt4eXnlObWniIiIiIiISF6UlCoAy7KIjo7mzJkzrg6lUrEsi4iICA4ePJhvczQpfW5ubkRGRuLl5eXqUERERERERKQcUlKqAOwJqfDwcPz8/JQgKSVpaWmcPXuWgIAAVeSUMWlpaRw5coSoqCjq1q2rnwkREREREREpNCWl8pGamupISIWGhro6nEolLS2NpKQkfHx8lJQqg6pVq8aRI0dISUnR9KkiIiIiIiJSaPpNPx/2HlJ+fn4ujkSkbLEP21O/LxERERERESkKJaUKSMOTRLLSz4SIiIiIiIgUh5JSIiIiIiIiIiJS6pSUkmKbMGEC7dq1c7weM2YMw4YNK/U49u3bh81mY9OmTaV+77JIn4eIiIiIiIiUZUpKVVBjxozBZrNhs9nw9PSkQYMGPPzww5w7d67E7/32228zY8aMAh1b2omTCRMm0KxZM/z9/alatSr9+/fnjz/+yPc8+2dps9nw9/encePGjBkzhvXr15dC1FnvHxgYSKdOnfjmm2/yPKdOnTpERUXRqlWrUolRREREREREpDCUlKrALr30UqKiotizZw8vvPAC7733Hg8//HCOx9obujtDcHAwVapUcdr1nKlJkya88847bNmyhVWrVlG/fn0GDhzI8ePH8z13+vTpREVFsW3bNt59913Onj1L165d+fTTT0sh8oz7r1u3jrZt2zJ8+HB+//33HI9NSkrC3d2diIgIPDw0yaaIiIiIiIiUPUpKVWDe3t5ERERQp04drr/+em644QbmzZsHZAy5mzZtGg0aNMDb2xvLsoiJieGOO+4gPDycoKAg+vbty19//ZXlui+99BLVq1cnMDCQsWPHkpCQkGX/hcP30tLSePnll2nUqBHe3t7UrVuXF198EYDIyEgA2rdvj81mo0+fPo7zpk+fTteuXfHz86NZs2a89957We6zdu1a2rdvj4+PD506dWLjxo35fibXX389/fv3p0GDBrRs2ZI33niD2NhYNm/enO+5VapUISIi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PaVEmoCY8CBO7Va1nlUiUn09E6N8ZsrxB06HvUn1FrTZbCYJbgUXiK2bh1a7B43NZiMuMrjcxOqemSilYTSmoVJSt8KCnD4zcdUXm81GZHAAkcEBZQ7TkaYnPiq4UQSdpGmJjQgiNqL6M78GBzjol9QMl8vFoXVWqfuqwmazlTu5h1Rd0/p5WERERERERERE/IKCUiIiIiIiIiIiUu8UlBIRERERERERkXqnoJSIiIiIiIiIiNQ7BaVERERERERERKTeKSglIiIiIiIiIiL1TkEpERERERERERGpdwpKiYiIiIiIiIhIvVNQSkRERERERERE6p2CUiIiIiIiIiIiUu8UlBIRERERERERkXqnoJSIiIiIiIiIiNQ7BaVERERERERERKTeKSglIiIiIiIiIiL1TkEpERERERERERGpd86GrkBjYFkWAOnp6Q1cEynJ5XKRnZ1Neno6AQEBDV0dOU5qR/+i9vQvak//pHb1P2pT/6L2bNrUfv5F7Vl3PPEVT7ylPApKARkZGQAkJSU1cE1ERERERERERPxDRkYGUVFR5d5vsyoLW50A3G43+/btIyIiApvN1tDVkSLp6ekkJSWxe/duIiMjG7o6cpzUjv5F7elf1J7+Se3qf9Sm/kXt2bSp/fyL2rPuWJZFRkYGiYmJ2O3lZ45STynAbrfTunXrhq6GlCMyMlJfEH5A7ehf1J7+Re3pn9Su/kdt6l/Unk2b2s+/qD3rRkU9pDyU6FxEREREREREROqdglIiIiIiIiIiIlLvFJSSRisoKIhHHnmEoKCghq6K1IDa0b+oPf2L2tM/qV39j9rUv6g9mza1n39RezY8JToXEREREREREZF6p55SIiIiIiIiIiJS7xSUEhERERERERGReqeglIiIiIiIiIiI1DsFpaRannrqKQYNGkRERAQtW7bknHPOYePGjT5lLMvi0UcfJTExkZCQEEaPHs3atWu99x85coQpU6bQtWtXQkNDadOmDbfffjtpaWllPmZeXh79+vXDZrOxcuXKSuu4evVqRo0aRUhICK1ateLxxx+nZOq0/fv3c9lll9G1a1fsdjt33nnncb0WTZk/tOPChQs55ZRTiImJISQkhG7duvH8888f3wvSxPlDe86fPx+bzVbqb8OGDcf3ojRh/tCe11xzTZnt2bNnz+N7UfyAP7QrwCuvvEL37t0JCQmha9euvPfee9V/MfxEY2/T3NxcrrnmGnr37o3T6eScc84pVUbnRMXqsz3btWtX6vvx/vvvr7SOOsctnz+0n85ti/lDe+rcthoskWqYMGGC9c4771hr1qyxVq5caZ1++ulWmzZtrMzMTG+Zp59+2oqIiLA+//xza/Xq1dbFF19sJSQkWOnp6ZZlWdbq1aut8847z5o1a5a1ZcsW6/vvv7c6d+5snX/++WU+5u23325NmjTJAqwVK1ZUWL+0tDQrLi7OuuSSS6zVq1dbn3/+uRUREWH94x//8JbZvn27dfvtt1vvvvuu1a9fP+uOO+6o8evS1PhDOy5fvtyaNm2atWbNGmv79u3W+++/b4WGhlqvv/56zV+gJsYf2nPevHkWYG3cuNHav3+/96+goKDmL1AT4w/tmZqa6tOOu3fvtqKjo61HHnmkxq9PU+UP7frqq69aERER1kcffWRt3brV+u9//2uFh4dbs2bNqvkL1AQ19jbNzMy0br75ZuuNN96wJkyYYJ199tmlyuicqFh9tmfbtm2txx9/3Od7MiMjo8L66Ry3Yv7Qfjq3LeYP7alz26pTUEpqJDk52QKsH3/80bIsy3K73VZ8fLz19NNPe8vk5uZaUVFR1muvvVbucT755BMrMDDQcrlcPttnz55tdevWzVq7dm2VTsBeffVVKyoqysrNzfVue+qpp6zExETL7XaXKj9q1KgT6h92eZp6O3qce+651hVXXFHhsU8ETbE9Pf+4jx49Ws1n6/+aYnsea8aMGZbNZrN27NhR2dM9YTTFdh06dKh17733+ux3xx13WKecckqVnrO/a2xtWtLVV19dZlCqJJ0T+arL9mzbtq31/PPPV6s+Osetnqbefh46tzWaYnvq3LbqNHxPasTT/TE6OhqA7du3c+DAAcaPH+8tExQUxKhRo1i0aFGFx4mMjMTpdHq3HTx4kBtvvJH333+f0NDQKtVn8eLFjBo1iqCgIO+2CRMmsG/fPnbs2FGdp3ZC8Yd2XLFiBYsWLWLUqFFVegx/1pTbs3///iQkJDB27FjmzZtXpeP7u6bcnh5vvfUW48aNo23btlV6jBNBU2zXvLw8goODffYLCQnht99+w+VyVelx/Flja1OpmbpsT4BnnnmGmJgY+vXrx9/+9jfy8/MrrI/OcavHH9pP57bFmnJ76ty2cgpKyXGzLIu7776b4cOH06tXLwAOHDgAQFxcnE/ZuLg4733HOnz4ME888QQ33XSTz7GvueYabr75Zk466aQq1+nAgQNlPnbJuomvpt6OrVu3JigoiJNOOolbb72VG264ocqP44+aansmJCTwxhtv8PnnnzN9+nS6du3K2LFjWbBgQZUfxx811fYsaf/+/XzzzTcn/GezpKbarhMmTODNN99k2bJlWJbF0qVLefvtt3G5XKSkpFT5sfxRY2xTOX512Z4Ad9xxBx999BHz5s3jtttu44UXXuCWW26psE46x626pt5+Orf11VTbU+e2VeesvIhI2W677TZWrVrFwoULS91ns9l8bluWVWobQHp6Oqeffjo9evTgkUce8W5/+eWXSU9P54EHHij38Xv27MnOnTsBGDFiBN988025j13WdjGaejv+9NNPZGZm8ssvv3D//ffTqVMnLr300oqesl9rqu3ZtWtXunbt6r1/6NCh7N69m3/84x+MHDmywufsz5pqe5Y0depUmjVrVmaS5RNVU23Xhx9+mAMHDjBkyBAsyyIuLo5rrrmGZ599FofDUZWn7rcaa5vK8anL9gS46667vOt9+vShefPmXHDBBd7eGjrHrZmm3n46t/XVVNtT57ZVp6CUHJcpU6Ywa9YsFixYQOvWrb3b4+PjARMhTkhI8G5PTk4uFU3OyMhg4sSJhIeHM2PGDAICArz3/fDDD/zyyy8+XSIBTjrpJC6//HLeffddZs+e7R0uEBIS4n38Y6PjycnJQOlIuvhHO7Zv3x6A3r17c/DgQR599NET9h+3P7RnSUOGDOGDDz6o8vP3N/7QnpZl8fbbb3PllVcSGBh4XK+Dv2nK7RoSEsLbb7/N66+/zsGDB72/AkdERNCiRYsavS5NWWNtUzk+dd2eZRkyZAgAW7ZsISYmRue4NeAP7adz22L+0J7HHvtEPrctVx3nrBI/43a7rVtvvdVKTEy0Nm3aVOb98fHx1jPPPOPdlpeXVyrpXFpamjVkyBBr1KhRVlZWVqnj7Ny501q9erX373//+58FWJ999pm1e/fucuv36quvWs2aNbPy8vK8255++mklgTyGv7Wjx+OPP261bdu2sqfvd/y1Pc8//3xrzJgxlT5/f+NP7elJ8rl69epqvQb+yJ/ataSRI0dal156aaXP3x819jYtSYnOK1df7VmWL7/80gKsnTt3lltG57gV87f289C5rX+154l6blsZBaWkWv74xz9aUVFR1vz5832mtszOzvaWefrpp62oqChr+vTp1urVq61LL73UZ3rO9PR0a/DgwVbv3r2tLVu2VGmKzO3bt1dpppnU1FQrLi7OuvTSS63Vq1db06dPtyIjI32m57Qsy1qxYoW1YsUKa+DAgdZll11mrVixwlq7dm3NXpwmxB/a8V//+pc1a9Ysa9OmTdamTZust99+24qMjLQeeuihmr9ATYw/tOfzzz9vzZgxw9q0aZO1Zs0a6/7777cA6/PPP6/5C9TE+EN7elxxxRXW4MGDj//F8CP+0K4bN2603n//fWvTpk3Wr7/+al188cVWdHS0tX379hq/Pk1RY29Ty7KstWvXWitWrLDOPPNMa/To0d7zn5JO9HMij/pqz0WLFlnPPfectWLFCmvbtm3Wxx9/bCUmJlpnnXVWhfXTOW7F/KH9dG5bzB/aU+e2VaeglFQLUObfO++84y3jdrutRx55xIqPj7eCgoKskSNH+vxK7vnlvKy/8k5sq3MCtmrVKmvEiBFWUFCQFR8fbz366KOlItZlPfaJ9CuEP7TjSy+9ZPXs2dMKDQ21IiMjrf79+1uvvvqqVVhYeLwvS5PlD+35zDPPWB07drSCg4Ot5s2bW8OHD7e+/vrr431JmjR/aE/LMidsISEh1htvvHE8L4Pf8Yd2XbdundWvXz8rJCTEioyMtM4++2xrw4YNx/uSNHlNoU3btm1b5rErex4n0jmRR32157Jly6zBgwdbUVFRVnBwsNW1a1frkUceqVIvDp3jls8f2k/ntsX8oT11blt1NssqysglIiIiIiIiIiJST+wNXQERERERERERETnxKCglIiIiIiIiIiL1TkEpERERERERERGpdwpKiYiIiIiIiIhIvVNQSkRERERERERE6p2CUiIiIiIiIiIiUu8UlBIRERERERERkXqnoJSIiIiIiIiIiNQ7BaVERERETkDz58/HZrORmpra0FURERGRE5SCUiIiIiLluOaaa7DZbNhsNgICAoiLi+O0007j7bffxu12V+tYU6dOpVmzZrVSr3bt2vHCCy/UyrFEREREGoqCUiIiIiIVmDhxIvv372fHjh188803jBkzhjvuuIMzzjiDgoKChq6eiIiISJOloJSIiIhIBYKCgoiPj6dVq1YMGDCABx98kC+++IJvvvmGqVOness999xz9O7dm7CwMJKSkrjlllvIzMwEzFC5a6+9lrS0NG/Pq0cffRSA/Px87rvvPlq1akVYWBiDBw9m/vz51aqjzWbjzTff5NxzzyU0NJTOnTsza9YsnzKzZ8+mS5cuhISEMGbMGHbs2FHqOIsWLWLkyJGEhISQlJTE7bffTlZWFgDvvfce4eHhbN682Vt+ypQpdOnSxVtGREREpDoUlBIRERGpplNPPZW+ffsyffp07za73c5LL73EmjVrePfdd/nhhx+47777ABg2bBgvvPACkZGR7N+/n/3793PvvfcCcO211/Lzzz/z0UcfsWrVKi688EImTpzoE/ypiscee4yLLrqIVatWMXnyZC6//HKOHDkCwO7duznvvPOYPHkyK1eu5IYbbuD+++/32X/16tVMmDCB8847j1WrVvHxxx+zcOFCbrvtNgCuuuoq73ELCgqYM2cOr7/+Oh9++CFhYWHH/VqKiIjIictmWZbV0JUQERERaYyuueYaUlNTmTlzZqn7LrnkElatWsW6devK3PfTTz/lj3/8IykpKYDJKXXnnXf6JBbfunUrnTt3Zs+ePSQmJnq3jxs3jpNPPpknn3yyzGO3a9eOO++8kzvvvBMwPaX+8pe/8MQTTwCQlZVFREQEs2fPZuLEiTz44IPMnDmTtWvXYrPZALj//vt55plnOHr0KM2aNeOqq64iJCSE119/3fs4CxcuZNSoUWRlZREcHMzRo0fp06cPZ555JtOnT2fKlCk89NBDVX49RUREREpyNnQFRERERJoiy7K8AR6AefPm8eSTT7Ju3TrS09MpKCggNzeXrKyscnsSLV++HMuy6NKli8/2vLw8YmJiqlWfPn36eNfDwsKIiIggOTkZgPXr1zNkyBCf+g4dOtRn/2XLlrFlyxY+/PBDn+fodrvZvn073bt3p3nz5rz11ltMmDCBYcOGleptJSIiIlIdCkqJiIiIHIf169fTvn17AHbu3MnkyZO5+eabeeKJJ4iOjmbhwoVcf/31uFyuco/hdrtxOBwsW7YMh8Phc194eHi16hMQEOBz22azeWcIrErHeLfbzU033cTtt99e6r42bdp41xcsWIDD4WDfvn1kZWURGRlZrXqKiIiIeCgoJSIiIlJNP/zwA6tXr+auu+4CYOnSpRQUFPDPf/4Tu92k7Pzkk0989gkMDKSwsNBnW//+/SksLCQ5OZkRI0bUWX179OhRagjiL7/84nN7wIABrF27lk6dOpV7nEWLFvHss8/y5Zdfcv/99zNlyhTefffduqiyiIiInACU6FxERESkAnl5eRw4cIC9e/eyfPlynnzySc4++2zOOOMMrrrqKgA6duxIQUEBL7/8Mtu2beP999/ntdde8zlOu3btyMzM5PvvvyclJYXs7Gy6dOnC5ZdfzlVXXcX06dPZvn07S5Ys4ZlnnmH27Nm19hxuvvlmtm7dyt13383GjRuZNm2az8yBAH/+859ZvHgxt956KytXrmTz5s3MmjWLKVOmAJCRkcGVV17JlClTmDRpEtOmTeOTTz7h008/rbV6ioiIyIlFQSkRERGRCsyZM4eEhATatWvHxIkTmTdvHi+99BJffPGFd8hdv379eO6553jmmWfo1asXH374IU899ZTPcYYNG8bNN9/MxRdfTGxsLM8++ywA77zzDldddRX33HMPXbt25ayzzuLXX38lKSmp1p5DmzZt+Pzzz/nyyy/p27cvr732Wqkk6n369OHHH39k8+bNjBgxgv79+/Pwww+TkJAAwB133EFYWJh3v549e/LMM89w8803s3fv3lqrq4iIiJw4NPueiIiIiIiIiIjUO/WUEhERERERERGReqeglIiIiIiIiIiI1DsFpUREREREREREpN4pKCUiIiIiIiIiIvVOQSkREREREREREal3CkqJiIiIiIiIiEi9U1BKRERERERERETqnYJSIiIiIiIiIiJS7xSUEhERERERERGReqeglIiIiIiIiIiI1DsFpUREREREREREpN4pKCUiIiIiIiIiIvXu/wFrsiqahAQsCAAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 1200x500 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABKUAAAHqCAYAAADVi/1VAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAA8T9JREFUeJzs3Xd4VNXWx/HvpPcAgRA6oSO9iYoCUhVQsYCoKCjWCzZsr9eGiliv5WK9SlGwIBbEhoJSRER6L9JrQicJEFIm5/1jZ2YS0iZ1ksnv8zx5zpkz+5yzZg5wb5Zrr22zLMtCRERERERERESkDPl4OgAREREREREREal8lJQSEREREREREZEyp6SUiIiIiIiIiIiUOSWlRERERERERESkzCkpJSIiIiIiIiIiZU5JKRERERERERERKXNKSomIiIiIiIiISJlTUkpERERERERERMqcklIiIiIiIiIiIlLmlJQSEREpJ6ZOnYrNZmPFihXOY+PGjcNmszl/fHx8qFWrFgMGDODPP//Mdv7u3bud48aNG5frPW677TbnGHfjye0nPj7erc/Us2fPbLGHh4fTpEkThgwZwldffUVGRoZb1ylNY8eOxWazMWjQoFzfX7BgATabja+++qqMI8ubI6YFCxbkO+7cZ+jn50fdunW59dZbOXDggFv3GjlyJA0bNix+0IXg+HyOH19fX2rWrMmQIUPYvHlzmcTQs2dPevbs6Xzt+Ps1derUQl1n06ZNjBs3jt27d+d4zxPfrYiISHni5+kAREREpGBz5swhMjKSjIwM9u7dyyuvvELPnj35+++/6dixY7ax4eHhTJ06laeffhofH9d/fzp16hQzZ84kIiKCxMREt+89ZcoUWrRoke1YVFSU2+c3atSITz/9FIDTp0+za9cuZs2axZAhQ7jkkkv4/vvviYyMdPt6JSktLY3p06cD5js+cOAAderU8UgspcnxDJOTk1m0aBEvvvgiCxcuZP369YSGhuZ77lNPPcX9999fRpFmN2HCBC699FJSU1NZsWIFzz33HL/99hvr168v8+dUq1Yt/vrrLxo3blyo8zZt2sSzzz5Lz549cySgPPndioiIlAdKSomIiFQAnTp1onr16gBcdNFFnH/++TRu3JivvvoqR1Lq+uuv56OPPuK3336jb9++zuMzZszAbrczePBgZyLGHa1bt6Zz585Fjj04OJgLLrgg27Hbb7+dKVOmcNttt3HnnXcyY8aMIl+/OL777juOHDnCwIED+fHHH/n444/597//7ZFYSlPWZ3jppZdit9t5/vnnmTVrFjfddFOu55w5c4aQkJBCJ2FKUtOmTZ1/drp3706VKlUYNWoUU6dO5Yknnsj1HEfcJS0wMDDHn+Pi8uR3KyIiUh5o+p6IiEgF5Kgs8vf3z/Fe8+bNueiii5g8eXK245MnT+aaa67xWFXSuW699VYGDBjAzJkz2bNnj/P4O++8Q/fu3YmOjiY0NJQ2bdrwyiuvkJaW5hzz/PPP4+fnx759+3Jc97bbbiMqKoqzZ88WGMOkSZMICAhgypQp1KtXjylTpmBZVq5j09LSeOKJJ6hduzYRERH06dOHrVu35hg3b948evfuTUREBCEhIXTr1o3ffvst25jt27dz66230rRpU0JCQqhTpw5XXHEF69evz3G9LVu2cNlllxESEkL16tW5++67SUpKKvCz5ceRXHF87yNHjiQsLIz169fTr18/wsPD6d27t/O9cyt8MjIymDhxIu3btyc4OJgqVapwwQUXMHv27GzjZsyYwYUXXkhoaChhYWH079+f1atXl1jcjumtq1at4rrrrqNq1arORI9lWbz77rvOGKtWrcp1113Hzp07s13TsixeeeUVGjRoQFBQEB07duTnn3/Oce+8pu9t2bKFG264gZo1axIYGEj9+vW55ZZbSElJYerUqQwZMgQwyUDHdETHNXL7bs+ePcvjjz9ObGwsAQEB1KlTh9GjR3Py5Mls4xo2bMigQYOYM2cOHTt2JDg4mBYtWuT4ey8iIlKeKSklIiJSAdjtdtLT00lNTWX79u2MHj2awMBArrvuulzHjxo1ilmzZnHixAkAtm7dypIlSxg1alSh7z1o0CB8fX2pVq0a11xzDRs2bCjWZ8nqyiuvxLIs/vjjD+exHTt2cOONNzJt2jR++OEHRo0axauvvspdd93lHHPXXXfh5+fHBx98kO16x48f54svvmDUqFEEBQXle+/9+/fz66+/ctVVV1GjRg1GjBjB9u3bWbRoUa7j//3vf7Nnzx4++ugj/ve//7Ft2zauuOIK7Ha7c8z06dPp168fERERfPzxx3z55ZdUq1aN/v37Z0tMHTx4kKioKF566SXmzJnDO++8g5+fH127ds2W6Dp06BA9evRgw4YNvPvuu0ybNo1Tp04xZswY977gPGzfvh2AGjVqOI+lpqZy5ZVX0qtXL7777jueffbZPM8fOXIk999/P126dGHGjBl88cUXXHnlldn6Jk2YMIEbbriB8847jy+//JJp06aRlJTEJZdcwqZNm0osboBrrrmGJk2aMHPmTN5//33A/Bl54IEH6NOnD7NmzeLdd99l48aNXHTRRRw6dMh57rPPPstjjz1G3759mTVrFvfccw933HFHrgnHc61du5YuXbqwdOlSnnvuOX7++WdefPFFUlJSSE1NZeDAgUyYMAEwyda//vqLv/76i4EDB+Z6PcuyGDx4MK+99ho333wzP/74I2PHjuXjjz+mV69epKSk5Lj/Qw89xIMPPsh3331H27ZtGTVqVJ5/hkVERModS0RERMqFKVOmWIC1fPly57FnnnnGAnL8REREWN98802283ft2mUB1quvvmolJSVZYWFh1ttvv21ZlmU98sgjVmxsrJWRkWGNHj3acuf/Avz888/WE088YX3//ffWwoULrbffftuqW7euFRoaaq1Zs8atz9SjRw+rVatW+d4DsF5++eVc37fb7VZaWpr1ySefWL6+vtbx48ed740YMcKKjo62UlJSnMdefvlly8fHx9q1a1eBsT333HMWYM2ZM8eyLMvauXOnZbPZrJtvvjnbuPnz51uANWDAgGzHv/zySwuw/vrrL8uyLOv06dNWtWrVrCuuuCLHZ2jXrp11/vnn5xlLenq6lZqaajVt2tR68MEHnccfe+wxy2az5fi++/btawHW/Pnz8/2Mjj9TS5cutdLS0qykpCTrhx9+sGrUqGGFh4db8fHxlmWZ7xKwJk+enOMaI0aMsBo0aOB8vWjRIguwnnjiiTzvu3fvXsvPz8+69957sx1PSkqyYmJirKFDh+Ybt+M7nzFjhpWWlmadOXPGWrRokdWkSRPL19fXWrt2rWVZrr8fTz/9dLbz//rrLwuw/vOf/2Q7vm/fPis4ONh69NFHLcuyrBMnTlhBQUHW1VdfnW3cn3/+aQFWjx49nMccf7+mTJniPNarVy+rSpUq1uHDh/P8LDNnzszzWZ373c6ZM8cCrFdeeSXbuBkzZliA9b///c95rEGDBlZQUJC1Z88e57Hk5GSrWrVq1l133ZVnPCIiIuWJKqVEREQqgHnz5rF8+XKWLVvGDz/8QJ8+fRg2bBjffvttruPDwsIYMmQIkydPJj09nU8++YRbb73VrVX3HC677DLGjx/PoEGD6N69O6NHj+aPP/7AZrPx9NNPO8dlZGSQnp7u/MlaOVQQK5epcqtXr+bKK68kKioKX19f/P39ueWWW7Db7fzzzz/Ocffffz+HDx9m5syZzjjee+89Bg4cWOCKZpZlOafsOfpuxcbG0rNnT77++utcG8FfeeWV2V63bdsWcE0lW7JkCcePH2fEiBHZvo+MjAwuu+wyli9fzunTpwFIT09nwoQJnHfeeQQEBODn50dAQADbtm3Ltrrc/PnzadWqFe3atct27xtvvDHfz3euCy64AH9/f8LDwxk0aBAxMTH8/PPP1KxZM9u4a6+9tsBrOaa2jR49Os8xv/zyC+np6dxyyy3ZvougoCB69OhR4KqBDtdffz3+/v6EhITQvXt37HY7X331lfO7zyvuH374AZvNxvDhw7PdPyYmhnbt2jnv/9dff3H27NkcfbUuuugiGjRokG9sZ86cYeHChQwdOjRH5VZR/f7774CpRMtqyJAhhIaG5pgG2r59e+rXr+98HRQURLNmzbJNhxURESnP1OhcRESkAmjXrp2z0TnA5ZdfTps2bRg9ejRXX311rueMGjWKiy++mBdeeIEjR47k+EW3KBo2bMjFF1/M0qVLncduu+02Pv74Y+frwiQdHL88165dG4C9e/dyySWX0Lx5c9566y0aNmxIUFAQy5YtY/To0SQnJzvP7dChA5dccgnvvPMON910Ez/88AO7d+/OMaUvN7///ju7du1i7Nix2RJQQ4cOZf78+Xz++efZpgtCzhUHAwMDAZwxOaaE5TWlEsz0wtDQUMaOHcs777zDY489Ro8ePahatSo+Pj7cfvvt2T7jsWPHiI2NzXGdmJiYAj9jVp988gktW7bEz8+PmjVrUqtWrRxjQkJCiIiIKPBaR44cwdfXN98YHN9Fly5dcn0/66qQ+Xn55Zfp1asXvr6+VK9enXr16uU67tzPc+jQISzLypF0c2jUqBFgvl/I/fss6Ds+ceIEdrudunXrFvg53HXs2DH8/PxyJLlsNhsxMTHOeB1yWwUzMDAw258hERGR8kxJKRERkQrIx8eHVq1aMXPmTA4fPkx0dHSOMd26daN58+Y899xz9O3bN89f6AvLsqxsSYVx48Zl63EUHh7u9rVmz56NzWaje/fuAMyaNYvTp0/zzTffZKtUWbNmTa7n33fffQwZMoRVq1bx9ttv06xZs2wrDuZl0qRJALz++uu8/vrrub5/blKqII6k4cSJE/Ncpc2RJJk+fTq33HKLs9+Qw9GjR6lSpYrzdVRUFPHx8Tmuk9ux/LRs2bLAFRTdraKrUaMGdrud+Pj4XJNb4PouvvrqqwIrjvLTqFEjt1Z+PDf26tWrY7PZ+OOPP5zJw6wcxxxJnby+4/wq7qpVq4avry/79+8vMD53RUVFkZ6ezpEjR7IlpizLIj4+Ps8kn4iISEWl6XsiIiIVkN1uZ/369QQGBuZb3fLkk09yxRVX8NBDD5XIfXft2sWff/6ZLenSsGFDOnfu7Pxp3ry5W9eaMmUKP//8MzfccINzCpIjuZA1kWBZFh9++GGu17j66qupX78+Dz30EPPmzeNf//pXgcmVEydO8O2339KtWzfmz5+f4+emm25i+fLlhW7o3q1bN6pUqcKmTZuyfR9ZfwICApyf89xkyY8//siBAweyHbv00kvZuHEja9euzXb8s88+K1RsJenyyy8H4L333stzTP/+/fHz82PHjh15fheladCgQViWxYEDB3K9d5s2bQAzrTEoKIhPP/002/lLliwpcApccHAwPXr0YObMmRw9ejTPcedW1OXHseLh9OnTsx3/+uuvOX36tPN9ERERb6FKKRERkQpg5cqVREZGAmZq0uTJk9myZQsPPvhgvqvMDR8+nOHDhxfpnn369KF79+60bduWiIgI1q9fzyuvvILNZuP55593+zrJycnO6X7Jycns3LmTWbNm8cMPP9CjRw/namkAffv2JSAggBtuuIFHH32Us2fP8t577zlXETyXr68vo0eP5rHHHiM0NNStKYqffvopZ8+e5b777qNnz5453o+KiuLTTz9l0qRJvPHGG25/zrCwMCZOnMiIESM4fvw41113HdHR0Rw5coS1a9dy5MgRZyJn0KBBTJ06lRYtWtC2bVtWrlzJq6++mmMq2AMPPMDkyZMZOHAg48ePp2bNmnz66ads2bLF7bhK2iWXXMLNN9/M+PHjOXToEIMGDSIwMJDVq1cTEhLCvffeS8OGDXnuued44okn2LlzJ5dddhlVq1bl0KFDLFu2jNDQ0HxX9yuubt26ceedd3LrrbeyYsUKunfvTmhoKHFxcSxevJg2bdpwzz33ULVqVR5++GHGjx/P7bffzpAhQ9i3bx/jxo1za4rk66+/zsUXX0zXrl35v//7P5o0acKhQ4eYPXs2H3zwAeHh4bRu3RqA//3vf4SHhxMUFERsbGyuU+/69u1L//79eeyxx0hMTKRbt26sW7eOZ555hg4dOnDzzTeX+HclIiLiSUpKiYiIVACXXXaZc79atWo0bdqUyZMnM2LEiFK7Z5s2bZgxYwavvfYaycnJREdH06tXL5566imaNWvm9nV27tzJhRdeCEBoaCg1a9akY8eOzJw5k2uuuSbbVMAWLVrw9ddf8+STT3LNNdcQFRXFjTfeyNixY50VOue6/vrreeyxx7j55pudibv8TJo0iejoaAYPHpzn577ggguYPn06L7/8stufE0wSsH79+rzyyivcddddJCUlER0dTfv27bMlzN566y38/f158cUXOXXqFB07duSbb77hySefzHa9mJgYFi5cyP33388999xDSEgIV199NW+//TZXXXVVoWIrSVOnTqVjx45MmjSJqVOnEhwczHnnnce///1v55jHH3+c8847j7feeovPP/+clJQUYmJi6NKlC3fffXepx/jBBx9wwQUX8MEHH/Duu++SkZFB7dq16datG+eff75z3HPPPUdoaCjvvvsu06ZNo0WLFrz//vu89tprBd6jXbt2LFu2jGeeeYbHH3+cpKQkYmJi6NWrl7MqLjY2ljfffJO33nqLnj17YrfbmTJlSq4JVJvNxqxZsxg3bhxTpkzhhRdeoHr16tx8881MmDAh16mIIiIiFZnNym3ZGxEREZEKYuLEidx3331s2LCBVq1aeTocEREREXGTklIiIiJSIa1evZpdu3Zx11130a1bN2bNmuXpkERERESkEJSUEhERkQqpYcOGxMfHc8kllzBt2jS3egCJiIiISPmhpJSIiIiIiIiIiJQ5n4KHiIiIiIiIiIiIlCwlpUREREREREREpMwpKSUiIiIiIiIiImXOz9MBlAcZGRkcPHiQ8PBwbDabp8MREREREREREamwLMsiKSmJ2rVr4+OTdz2UklLAwYMHqVevnqfDEBERERERERHxGvv27aNu3bp5vq+kFBAeHg6YLysiIsLD0YhDWloav/76K/369cPf39/T4UgR6Tl6Fz1P76Ln6Z30XL2Pnql30fOs2PT8vIueZ+lJTEykXr16znxLXpSUAueUvYiICCWlypG0tDRCQkKIiIjQPxAVmJ6jd9Hz9C56nt5Jz9X76Jl6Fz3Pik3Pz7voeZa+glokqdG5iIiIiIiIiIiUOSWlRERERERERESkzCkpJSIiIiIiIiIiZU49pQrBbreTlpbm6TAqjbS0NPz8/Dh79ix2u93T4cg5AgIC8l3aU0RERERERCQ/Skq5wbIs4uPjOXnypKdDqVQsyyImJoZ9+/YV2BxNyp6Pjw+xsbEEBAR4OhQRERERERGpgJSUcoMjIRUdHU1ISIgSJGUkIyODU6dOERYWpoqcciYjI4ODBw8SFxdH/fr19XdCRERERERECk1JqQLY7XZnQioqKsrT4VQqGRkZpKamEhQUpKRUOVSjRg0OHjxIenq6lk8VERERERGRQtNv+gVw9JAKCQnxcCQi5Ytj2p76fYmIiIiIiEhRKCnlJk1PEslOfydERERERESkOJSUEhERERERERGRMqeklBTbuHHjaN++vfP1yJEjGTx4cJnHsXv3bmw2G2vWrCnze5dH+j5ERERERESkPFNSykuNHDkSm82GzWbD39+fRo0a8fDDD3P69OlSv/dbb73F1KlT3Rpb1omTrN+L4+eCCy4o8Lys40NDQ2natCkjR45k5cqVZRB19vuHh4fTuXNnvvnmm3zPqVevHnFxcbRu3bpMYhQREREREREpDCWlvNhll11GXFwcO3fuZPz48bz77rs8/PDDuY51NHQvCZGRkVSpUqXErlfSHN+L4+enn35y67wpU6YQFxfHxo0beeeddzh16hRdu3blk08+KeWIs99/+fLltGvXjiFDhvDXX3/lOjY1NRVfX19iYmLw89MimyIiIiIiIlL+KCnlxQIDA4mJiaFevXrceOON3HTTTcyaNQtwTbmbPHkyjRo1IjAwEMuySEhI4M477yQ6OpqIiAh69erF2rVrs133pZdeombNmoSHhzNq1CjOnj2b7f1zp+9lZGTw8ssv06RJEwIDA6lfvz4vvPACALGxsQB06NABm81Gz549nedNmTKFrl27EhISQosWLXj33Xez3WfZsmV06NCBoKAgOnfuzOrVqwv1vTh+qlWr5tZ5VapUISYmhoYNG9KvXz+++uorbrrpJsaMGcOJEycAOHbsGDfccAN169YlJCSENm3a8Pnnnzuv8cknnxAVFUVKSkq2a1977bXccsstbt2/RYsWvP/++wQFBTF79mwAGjZsyPjx4xk5ciSRkZHccccduVahbdy4kYEDBxIREUF4eDiXXHIJO3bscL4/ZcoUWrZsSVBQUK7fuYiIiIiIiEhJUVKqiM6kpuf5czbNXuJjS0JwcHC2iqjt27fz5Zdf8vXXXzsTFwMHDiQ+Pp6ffvqJlStX0rFjR3r37s3x48cB+PLLL3nmmWd44YUXWLFiBbVq1SowcfH444/z8ssv89RTT7Fp0yY+++wzatasCZjEEsC8efOIi4tzTkn78MMPeeqpp3jyySfZuHEjEyZM4KmnnuLjjz8G4PTp0wwaNIjmzZuzcuVKxo0bl2cV2LkWLFhAdHQ0zZo144477uDw4cPuf4nnePDBB0lKSmLu3LkAnD17lk6dOvHDDz+wYcMG7rzzTm6++Wb+/vtvAIYMGYLdbncmkwCOHj3KDz/8wK233ur2ff39/fHz88v2PF999VVat27NypUreeqpp3Kcc+DAAbp3705QUBC///47K1eu5LbbbiM93fz5+vDDD3niiSd44YUX2Lx5c47vXERERERERApwNgES9ns6igpD83qK6Lynf8nzvUub12DKrec7X3d6fh7J5ySfHLrGVmPGXRc6X1/88nyOn07NMW73SwOLEa1J/nz22Wf07t3beSw1NZVp06ZRo0YNAH7//XfWr1/P4cOHCQwMBOC1115j1qxZfPXVV9x55528+eab3Hbbbdx+++0AjB8/nnnz5uWolnJISkrirbfe4u2332bEiBEANG7cmIsvvhjAee+oqChiYmKc5z3//PO8+uqrzqqexo0bs2nTJj744ANGjBjBp59+it1uZ/LkyYSEhNCqVSv279/PPffck+/3cPnllzNkyBAaNGjArl27eOqpp+jVqxcrV650fubCaNGiBWB6YwHUqVMnW3Ls3nvvZc6cOcycOZOuXbsSHBzMjTfeyJQpUxgyZAgAn376KXXr1s1WJZaflJQUXn31VRITE7M9z169emW7tyMmh3feeYfIyEi++OIL/P39AWjWrJnz/eeff57//Oc/XHPNNYCpYsv6nYuIiIiIiEg+4tfD9GvhbCL86y+oFuvpiMo9JaW82A8//EBYWBjp6emkpaVx1VVXMXHiROf7DRo0cCaFAFauXMmpU6eIiorKdp3k5GTnFK/Nmzdz9913Z3v/wgsvZP78+bnGsHnzZlJSUrIlTwpy5MgR9u3bxx133IGPj6uYLz09ncjISOd127VrR0hISLY4CnL99dc791u3bk3nzp1p0KABP/74I9dccw13330306dPd445depUvtezLAswjcgB7HY7L730EjNmzODAgQOkpKSQkpJCaGio85w77riDLl26cODAAerUqcOUKVOcDdjzc8MNN+Dr60tycjKRkZG89tprXH755c73O3funO/5a9as4ZJLLnEmpLJyfOejRo3ijjvucB7P+p2LiIiIiIhIHnYvhs9vgJRE83rFJOg33rMxVQBKShXRpuf65/mezznJhZVP9XF77OLHLi1eYFlceumlvPfee/j7+1O7du0cyYisiRIwvZ9q1arFggULclyrqI3Lg4ODC31ORkYGAB988AGtWrUiLCzMmZzy9fUFXMmg4qpVqxYNGjRg27ZtADz33HNuTwMEkxwDV2+s//znP7zxxhu8+eabtGnThtDQUB544AFSU13Vbx06dKBdu3Z88skn9O/fn/Xr1/P9998XeK833niDPn36EBERQXR0dI73z32e58rvWTi+8w8//JCuXbtme8/xnYuIiIiIiEgutvwIM28FewpUaQAn98Dq6XDpE+Bf+N+JKxMlpYooJMD9r660xhYkNDSUJk2auD2+Y8eOxMfH4+fnR8OGDXMd07JlS5YuXZqtKffSpUvzvGbTpk0JDg7mt99+c075yyogIAAwFUYONWvWpE6dOuzatYsrrriCiIiIbBVTAOeddx7Tpk0jOTnZmWzJL468HDt2jH379lGrVi0AoqOjc0345OXNN98kIiKCPn1M4vGPP/7gqquuYvjw4YBJ9mzbto2WLVtmO+/222/njTfe4MCBA/Tp04d69eoVeK+YmJhCPc9ztW3blo8//pi0tLQcCUrHd75z505uuummIt9DRERERESkUlk1Db6/D6wMaD4ArvkQ3r0AEvbBxlnQ/gZPR1iuqdG5OPXp04cLL7yQwYMH88svv7B7926WLFnCk08+yYoVKwC4//77mTx5MpMnT+aff/7hmWeeYePGjXleMygoiMcee4xHH32UTz75hB07drB06VImTZoEmCRQcHAwc+bM4dChQyQkJABmdcCXXnqJ999/n3/++Yf169czZcoUXn/9dQBuvPFGfHx8GDVqFJs2beKnn37itddey/fznTp1iocffpi//vqL3bt3s2DBAq644gqqV6/O1VdfXeD3c/LkSeLj49mzZw9z587luuuu47PPPuO9995zVpI1adKEuXPnsmTJEjZv3sxdd91FfHx8jmvddNNNHDhwgA8//JDbbrutwHuXhDFjxpCYmMiwYcNYsWIF27ZtY9q0aWzduhUw3/mLL77IW2+9let3LiIiIiIiIpksCxa/AbPHmIRU++EwdBoEhkGnkWbMikkeDbEiUFJKnGw2Gz/99BPdu3fntttuo1mzZgwbNozdu3c7V8u7/vrrefrpp3nsscfo1KkTe/bsKbC5+FNPPcVDDz3E008/TcuWLbn++uudK975+fnx3//+lw8++IDatWtz1VVXAaaS6H//+x+fffYZ7dq1o0ePHkydOtU5TS4sLIzvv/+eTZs20aFDB5544glefvnlfOPw9fVl/fr1XHXVVTRr1owRI0bQrFkz/vrrL8LDwwv8fm699VZq1apFixYtuOeeewgLC2PZsmXceOON2T5rx44d6d+/Pz179iQmJobBgwfnuFZERATXXnstYWFhub5fGqKiovj99985deoUPXr0oFOnTnz44YfOqqnbb7+djz76iKlTp9KmTZsc37mIiIiIiEild3gzTBkIrzWDeePMsW4PwFVvg2/mzKeOtwA22L8cTh/1UKAVg80qqeY8FVhiYiKRkZEkJCQQERGR7b2zZ8+ya9cuYmNjCQoK8lCElVNGRgaJiYm5Tt/zBn379qVly5b897//9XQoReLu3420tDR++uknBgwYkGuTdalY9Dy9i56nd9Jz9T56pt5Fz7Ni0/PzLkV6nr8+CUsyFxDz8Yc+4+CiMTnHvdoETh+Bu/6AWm1LLOaKIr88S1bqKSVSxo4fP86vv/7K77//zttvv+3pcERERERERMRdZ06Y7QWjoef/QVAeCZewGJOUOnWo7GKrgJSUEiljHTt25MSJE7z88ss0b97c0+GIiIiIiIiIu5Izk1JRjfNOSAGEx8Ch9ZCUs8ewuCgpJVLGdu/e7ekQREREREREpCjOnjTb4Cr5jws3fZmVlMqf9zXqEREREREREREpDcknzTa4av7jwmLM9pSSUvlRUkpERERERERExB2O6XtBVfIfF56ZlFKlVL6UlBIRERERERERcYdz+l4BlVJKSrlFSSkRERERERERkYKkp0DaGbNfUE8p5/Q9rb6XHyWlREREREREREQK4ugnhQ0CI/Mfm7VSyrJK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XQz5e6Dt8dD+hEOvXxehUTD6bhh4hbk6X/fT4Lf3YcY95v6QKOg4NvAxrQfhOf05vrVGMq51EY42AyFaJ48iIiIiIiIiwUJBKTEcThj9h4bdR0wKDLjUzPf5HXzzAHjd0OUUkyVVjTJnDN5BF+BQKqWIiIiIiIhIUFGerjSNqCTodbaZ73dR07ZFRERERERERBqdMqWk6Zz+LxhxO6T0OvS6IiIiIiIiIhJUlCklTSc0UgEpERERERERkWOUglIiIiIiIiIiItLoFJQSEREREREREZFGp6CUiIiIiIiIiIg0OgWlRERERERERESk0SkoJSIiIiIiIiIijU5BKRERERERERERaXQKSomIiIiIiIiISKNTUEpERERERERERBqdglIiIiIiIiIiItLoFJQSEREREREREZFGp6CUiIiIiIiIiIg0OgWlRERERERERESk0SkoJSIiIiIiIiIijU5BKRERERERERERaXQKSomIiIiIiIiISKNzNnUDjgaWZQGQl5fXxC2RylwuF0VFReTl5RESEtLUzZHDpH4MLurP4KL+DE7q1+CjPg0u6s/mTf0XXNSfDccXX/HFW2qioBSQn58PQNu2bZu4JSIiIiIiIiIiwSE/P5+4uLga77dZhwpbHQO8Xi+7du0iJiYGm83W1M2Rcnl5ebRt25bt27cTGxvb1M2Rw6R+DC7qz+Ci/gxO6tfgoz4NLurP5k39F1zUnw3Hsizy8/NJS0vDbq+5cpQypQC73U6bNm2auhlSg9jYWH1ABAH1Y3BRfwYX9WdwUr8GH/VpcFF/Nm/qv+Ci/mwYB8uQ8lGhcxERERERERERaXQKSomIiIiIiIiISKNTUEqOWmFhYTz44IOEhYU1dVPkCKgfg4v6M7ioP4OT+jX4qE+Di/qzeVP/BRf1Z9NToXMREREREREREWl0ypQSEREREREREZFGp6CUiIiIiIiIiIg0OgWlRERERERERESk0SkoJXXy2GOPcdxxxxETE0NycjJnnXUWa9euDVjHsiweeugh0tLSiIiIYMyYMaxcudJ/f3Z2NlOmTKFbt25ERkbSrl07brnlFnJzc6vdZ2lpKf3798dms7F06dJDtnH58uWMHj2aiIgIWrduzSOPPELl0mm7d+/m4osvplu3btjtdm677bbDei2as2Dox7lz53LCCSeQmJhIREQE3bt35+mnnz68F6SZC4b+nD17NjabrcrfmjVrDu9FacaCoT+vvPLKavuzV69eh/eiBIFg6FeA559/nh49ehAREUG3bt1466236v5iBImjvU9LSkq48sor6dOnD06nk7POOqvKOjomqtCY/dm+ffsqn4/33HPPIduoY9yaBUP/6di2QjD0p45t68ASqYPx48dbr7/+urVixQpr6dKl1qRJk6x27dpZBQUF/nUef/xxKyYmxpo6daq1fPly64ILLrBatWpl5eXlWZZlWcuXL7fOOecca9q0adaGDRus7777zurSpYt17rnnVrvPW265xTr11FMtwFqyZMlB25ebm2ulpKRYF154obV8+XJr6tSpVkxMjPX3v//dv87mzZutW265xXrzzTet/v37W7feeusRvy7NTTD04+LFi6333nvPWrFihbV582br7bfftiIjI62XXnrpyF+gZiYY+nPWrFkWYK1du9bavXu3/8/tdh/5C9TMBEN/5uTkBPTj9u3brYSEBOvBBx884tenuQqGfn3hhResmJgY64MPPrA2btxovf/++1Z0dLQ1bdq0I3+BmqGjvU8LCgqsyZMnWy+//LI1fvx468wzz6yyjo6JKjRmf6anp1uPPPJIwOdkfn7+QdunY9yDC4b+07FthWDoTx3b1p6CUnJEMjMzLcD64YcfLMuyLK/Xa6WmplqPP/64f52SkhIrLi7OevHFF2vczocffmiFhoZaLpcrYPn06dOt7t27WytXrqzVAdgLL7xgxcXFWSUlJf5ljz32mJWWlmZ5vd4q648ePfqY+sKuSXPvR5+zzz7buvTSSw+67WNBc+xP3xf3/v376/hsg19z7M8DffLJJ5bNZrO2bNlyqKd7zGiO/Tps2DDrrrvuCnjcrbfeap1wwgm1es7B7mjr08quuOKKaoNSlemYKFBD9md6err19NNP16k9Osatm+befz46tjWaY3/q2Lb2NHxPjogv/TEhIQGAzZs3k5GRwbhx4/zrhIWFMXr0aObNm3fQ7cTGxuJ0Ov3L9uzZw3XXXcfbb79NZGRkrdozf/58Ro8eTVhYmH/Z+PHj2bVrF1u2bKnLUzumBEM/LlmyhHnz5jF69Oha7SOYNef+HDBgAK1ateKkk05i1qxZtdp+sGvO/enz6quvcvLJJ5Oenl6rfRwLmmO/lpaWEh4eHvC4iIgIfvnlF1wuV632E8yOtj6VI9OQ/QnwxBNPkJiYSP/+/fnrX/9KWVnZQdujY9y6CYb+07Fthebcnzq2PTQFpeSwWZbFHXfcwYgRI+jduzcAGRkZAKSkpASsm5KS4r/vQPv27ePRRx/l97//fcC2r7zySiZPnszgwYNr3aaMjIxq9125bRKoufdjmzZtCAsLY/Dgwdx0001ce+21td5PMGqu/dmqVStefvllpk6dyscff0y3bt046aSTmDNnTq33E4yaa39Wtnv3br766qtj/n+zsubar+PHj+eVV15h0aJFWJbFwoULee2113C5XOzdu7fW+wpGR2OfyuFryP4EuPXWW/nggw+YNWsWN998M8888ww33njjQdukY9zaa+79p2PbQM21P3VsW3vOQ68iUr2bb76ZZcuWMXfu3Cr32Wy2gNuWZVVZBpCXl8ekSZPo2bMnDz74oH/5s88+S15eHvfee2+N++/Vqxdbt24FYOTIkXz11Vc17ru65WI093788ccfKSgoYMGCBdxzzz107tyZiy666GBPOag11/7s1q0b3bp1898/bNgwtm/fzt///ndGjRp10OcczJprf1b2xhtv0KJFi2qLLB+rmmu//ulPfyIjI4OhQ4diWRYpKSlceeWVPPnkkzgcjto89aB1tPapHJ6G7E+A22+/3T/ft29f4uPjOe+88/zZGjrGPTLNvf90bBuoufanjm1rT0EpOSxTpkxh2rRpzJkzhzZt2viXp6amAiZC3KpVK//yzMzMKtHk/Px8JkyYQHR0NJ988gkhISH++77//nsWLFgQkBIJMHjwYC655BLefPNNpk+f7h8uEBER4d//gdHxzMxMoGokXYKjHzt06ABAnz592LNnDw899NAx+8UdDP1Z2dChQ3nnnXdq/fyDTTD0p2VZvPbaa1x22WWEhoYe1usQbJpzv0ZERPDaa6/x0ksvsWfPHv+vwDExMSQlJR3R69KcHa19KoenofuzOkOHDgVgw4YNJCYm6hj3CARD/+nYtkIw9OeB2z6Wj21r1MA1qyTIeL1e66abbrLS0tKsdevWVXt/amqq9cQTT/iXlZaWVik6l5ubaw0dOtQaPXq0VVhYWGU7W7dutZYvX+7/+/rrry3A+t///mdt3769xva98MILVosWLazS0lL/sscff1xFIA8QbP3o88gjj1jp6emHevpBJ1j789xzz7XGjh17yOcfbIKpP31FPpcvX16n1yAYBVO/VjZq1CjroosuOuTzD0ZHe59WpkLnh9ZY/Vmdzz//3AKsrVu31riOjnEPLtj6z0fHtsHVn8fqse2hKCgldXLDDTdYcXFx1uzZswMubVlUVORf5/HHH7fi4uKsjz/+2Fq+fLl10UUXBVyeMy8vzxoyZIjVp08fa8OGDbW6RObmzZtrdaWZnJwcKyUlxbrooous5cuXWx9//LEVGxsbcHlOy7KsJUuWWEuWLLEGDRpkXXzxxdaSJUuslStXHtmL04wEQz8+99xz1rRp06x169ZZ69ats1577TUrNjbWuv/++4/8BWpmgqE/n376aeuTTz6x1q1bZ61YscK65557LMCaOnXqkb9AzUww9KfPpZdeag0ZMuTwX4wgEgz9unbtWuvtt9+21q1bZ/3888/WBRdcYCUkJFibN28+4tenOTra+9SyLGvlypXWkiVLrNNPP90aM2aM//insmP9mMinsfpz3rx51lNPPWUtWbLE2rRpk/Xf//7XSktLs84444yDtk/HuAcXDP2nY9sKwdCfOratPQWlpE6Aav9ef/11/zper9d68MEHrdTUVCssLMwaNWpUwK/kvl/Oq/ur6cC2Lgdgy5Yts0aOHGmFhYVZqamp1kMPPVQlYl3dvo+lXyGCoR//9a9/Wb169bIiIyOt2NhYa8CAAdYLL7xgeTyew31Zmq1g6M8nnnjC6tSpkxUeHm7Fx8dbI0aMsL788svDfUmatWDoT8syB2wRERHWyy+/fDgvQ9AJhn5dtWqV1b9/fysiIsKKjY21zjzzTGvNmjWH+5I0e82hT9PT06vd9qGex7F0TOTTWP25aNEia8iQIVZcXJwVHh5udevWzXrwwQdrlcWhY9yaBUP/6di2QjD0p45ta89mWeUVuURERERERERERBqJvakbICIiIiIiIiIixx4FpUREREREREREpNEpKCUiIiIiIiIiIo1OQSkREREREREREWl0CkqJiIiIiIiIiEijU1BKREREREREREQanYJSIiIiIiIiIiLS6BSUEhERERERERGRRqeglIiIiMgxaPbs2dhsNnJycpq6KSIiInKMUlBKREREpAZXXnklNpsNm81GSEgIKSkpnHLKKbz22mt4vd46beuNN96gRYsW9dKu9u3b88wzz9TLtkRERESaioJSIiIiIgcxYcIEdu/ezZYtW/jqq68YO3Yst956K6eddhput7upmyciIiLSbCkoJSIiInIQYWFhpKam0rp1awYOHMh9993HZ599xldffcUbb7zhX++pp56iT58+REVF0bZtW2688UYKCgoAM1TuqquuIjc315959dBDDwFQVlbG3XffTevWrYmKimLIkCHMnj27Tm202Wy88sornH322URGRtKlSxemTZsWsM706dPp2rUrERERjB07li1btlTZzrx58xg1ahQRERG0bduWW265hcLCQgDeeustoqOjWb9+vX/9KVOm0LVrV/86IiIiInWhoJSIiIhIHZ144on069ePjz/+2L/Mbrfzr3/9ixUrVvDmm2/y/fffc/fddwMwfPhwnnnmGWJjY9m9eze7d+/mrrvuAuCqq67ip59+4oMPPmDZsmX87ne/Y8KECQHBn9p4+OGHOf/881m2bBkTJ07kkksuITs7G4Dt27dzzjnnMHHiRJYuXcq1117LPffcE/D45cuXM378eM455xyWLVvGf//7X+bOncvNN98MwOWXX+7frtvtZsaMGbz00ku8++67REVFHfZrKSIiIscum2VZVlM3QkRERORodOWVV5KTk8Onn35a5b4LL7yQZcuWsWrVqmof+9FHH3HDDTewd+9ewNSUuu222wIKi2/cuJEuXbqwY8cO0tLS/MtPPvlkjj/+eP72t79Vu+327dtz2223cdtttwEmU+qBBx7g0UcfBaCwsJCYmBimT5/OhAkTuO+++/j0009ZuXIlNpsNgHvuuYcnnniC/fv306JFCy6//HIiIiJ46aWX/PuZO3cuo0ePprCwkPDwcPbv30/fvn05/fTT+fjjj5kyZQr3339/rV9PERERkcqcTd0AERERkebIsix/gAdg1qxZ/O1vf2PVqlXk5eXhdrspKSmhsLCwxkyixYsXY1kWXbt2DVheWlpKYmJindrTt29f/3xUVBQxMTFkZmYCsHr1aoYOHRrQ3mHDhgU8ftGiRWzYsIF333034Dl6vV42b95Mjx49iI+P59VXX2X8+PEMHz68SraViIiISF0oKCUiIiJyGFavXk2HDh0A2Lp1KxMnTmTy5Mk8+uijJCQkMHfuXK655hpcLleN2/B6vTgcDhYtWoTD4Qi4Lzo6uk7tCQkJCbhts9n8VwisTWK81+vl97//PbfcckuV+9q1a+efnzNnDg6Hg127dlFYWEhsbGyd2ikiIiLio6CUiIiISB19//33LF++nNtvvx2AhQsX4na7+cc//oHdbkp2fvjhhwGPCQ0NxePxBCwbMGAAHo+HzMxMRo4c2WDt7dmzZ5UhiAsWLAi4PXDgQFauXEnnzp1r3M68efN48skn+fzzz7nnnnuYMmUKb775ZkM0WURERI4BKnQuIiIichClpaVkZGSwc+dOFi9ezN/+9jfOPPNMTjvtNC6//HIAOnXqhNvt5tlnn2XTpk28/fbbvPjiiwHbad++PQUFBXz33Xfs3buXoqIiunbtyiWXXMLll1/Oxx9/zObNm/n111954oknmD59er09h8mTJ7Nx40buuOMO1q5dy3vvvRdw5UCAP/7xj8yfP5+bbrqJpUuXsn79eqZNm8aUKVMAyM/P57LLLmPKlCmceuqpvPfee3z44Yd89NFH9dZOERERObYoKCUiIiJyEDNmzKBVq1a0b9+eCRMmMGvWLP71r3/x2Wef+Yfc9e/fn6eeeoonnniC3r178+677/LYY48FbGf48OFMnjyZCy64gJYtW/Lkk08C8Prrr3P55Zdz55130q1bN8444wx+/vln2rZtW2/PoV27dkydOpXPP/+cfv368eKLL1Ypot63b19++OEH1q9fz8iRIxkwYAB/+tOfaNWqFQC33norUVFR/sf16tWLJ554gsmTJ7Nz5856a6uIiIgcO3T1PRERERERERERaXTKlBIRERERERERkUanoJSIiIiIiIiIiDQ6BaVERERERERERKTRKSglIiIiIiIiIiKNTkEpERERERERERFpdApKiYiIiIiIiIhIo1NQSkREREREREREGp2CUiIiIiIiIiIi0ugUlBIRERERERERkUanoJSIiIiIiIiIiDQ6BaVERERERERERKTRKSglIiIiIiIiIiKN7v8BFn7ojtiXrXMAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 1200x500 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ”® Real-time Prediction for next day:\n",
      "Predicted next day closing price: $152.01\n",
      "Predicted direction: Up\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import ta\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_absolute_error, r2_score, classification_report\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Download data\n",
    "ticker = \"IBM\"\n",
    "df = yf.download(ticker, start=\"2018-01-01\",)\n",
    "\n",
    "# Step 2: Handle MultiIndex columns if present\n",
    "if isinstance(df.columns, pd.MultiIndex):\n",
    "    # Flatten multi-level columns by joining with underscore\n",
    "    df.columns = ['_'.join(col).strip() for col in df.columns.values]\n",
    "\n",
    "# Step 3: Standardize column names for ease of use\n",
    "# Find columns that contain 'Close', 'High', 'Low', 'Volume' in their names (case insensitive)\n",
    "def find_column(cols, name):\n",
    "    for col in cols:\n",
    "        if name.lower() in col.lower():\n",
    "            return col\n",
    "    raise ValueError(f\"Expected column containing '{name}' not found in data\")\n",
    "\n",
    "close_col = find_column(df.columns, 'close')\n",
    "high_col = find_column(df.columns, 'high')\n",
    "low_col = find_column(df.columns, 'low')\n",
    "volume_col = find_column(df.columns, 'volume')\n",
    "\n",
    "# Step 4: Extract columns and convert to float Series\n",
    "df['Close'] = df[close_col].astype(float).squeeze()\n",
    "df['High'] = df[high_col].astype(float).squeeze()\n",
    "df['Low'] = df[low_col].astype(float).squeeze()\n",
    "df['Volume'] = df[volume_col].astype(float).squeeze()\n",
    "\n",
    "# Step 5: Compute technical indicators\n",
    "df['rsi'] = ta.momentum.RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = ta.momentum.StochasticOscillator(\n",
    "    high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = ta.trend.MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = ta.volume.OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = ta.trend.SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = ta.trend.EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "\n",
    "bb = ta.volatility.BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 6: Create target variables for future price and direction\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "\n",
    "df['dir_1d'] = (df['next_1d_close'] > df['Close']).astype(int)\n",
    "df['dir_3d'] = (df['next_3d_close'] > df['Close']).astype(int)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Drop rows with NaN (caused by indicator calculations and shifting)\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 7: Define features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 8: Split data (no shuffle for time series)\n",
    "X_train, X_test = train_test_split(X, test_size=0.2, shuffle=False)\n",
    "y_train_price_1d, y_test_price_1d = train_test_split(y_price_1d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_1d, y_test_dir_1d = train_test_split(y_dir_1d, test_size=0.2, shuffle=False)\n",
    "y_train_price_3d, y_test_price_3d = train_test_split(y_price_3d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_3d, y_test_dir_3d = train_test_split(y_dir_3d, test_size=0.2, shuffle=False)\n",
    "y_train_price_5d, y_test_price_5d = train_test_split(y_price_5d, test_size=0.2, shuffle=False)\n",
    "y_train_dir_5d, y_test_dir_5d = train_test_split(y_dir_5d, test_size=0.2, shuffle=False)\n",
    "\n",
    "# Step 9: Train models\n",
    "models = {}\n",
    "\n",
    "# Regression models for price prediction\n",
    "for name, target_train in [\n",
    "    ('price_1d', y_train_price_1d),\n",
    "    ('price_3d', y_train_price_3d),\n",
    "    ('price_5d', y_train_price_5d),\n",
    "]:\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    reg.fit(X_train, target_train)\n",
    "    models[name] = reg\n",
    "\n",
    "# Classification models for direction prediction\n",
    "for name, target_train in [\n",
    "    ('dir_1d', y_train_dir_1d),\n",
    "    ('dir_3d', y_train_dir_3d),\n",
    "    ('dir_5d', y_train_dir_5d),\n",
    "]:\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    clf.fit(X_train, target_train)\n",
    "    models[name] = clf\n",
    "\n",
    "# Step 10: Predictions and evaluation\n",
    "results = X_test.copy()\n",
    "for name, model in models.items():\n",
    "    results[f'pred_{name}'] = model.predict(X_test)\n",
    "\n",
    "# Regression metrics\n",
    "for name, y_test in [\n",
    "    ('price_1d', y_test_price_1d),\n",
    "    ('price_3d', y_test_price_3d),\n",
    "    ('price_5d', y_test_price_5d),\n",
    "]:\n",
    "    mae = mean_absolute_error(y_test, results[f'pred_{name}'])\n",
    "    r2 = r2_score(y_test, results[f'pred_{name}'])\n",
    "    print(f\"\\n{name.upper()} - MAE: {mae:.2f}, RÂ²: {r2:.2f}\")\n",
    "\n",
    "# Classification reports\n",
    "for name, y_test in [\n",
    "    ('dir_1d', y_test_dir_1d),\n",
    "    ('dir_3d', y_test_dir_3d),\n",
    "    ('dir_5d', y_test_dir_5d),\n",
    "]:\n",
    "    pred_labels = (results[f'pred_{name}'] > 0.5).astype(int)\n",
    "    print(f\"\\n{name.upper()} Classification Report:\")\n",
    "    print(classification_report(y_test, pred_labels, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "# Step 11: Save results\n",
    "results.to_csv(\"ibm_predictions.csv\")\n",
    "print(\"\\nâœ… Saved results to ibm_predictions.csv\")\n",
    "\n",
    "# Step 12: Visualization for 3-day and 5-day price predictions\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_3d'], label='Predicted 3-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_3d.values, label='Actual 3-Day Price')\n",
    "plt.title(\"IBM 3-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Date Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['pred_price_5d'], label='Predicted 5-Day Price', linestyle='--')\n",
    "plt.plot(results.index, y_test_price_5d.values, label='Actual 5-Day Price')\n",
    "plt.title(\"IBM 5-Day Ahead Price Prediction\")\n",
    "plt.xlabel(\"Date Index\")\n",
    "plt.ylabel(\"Price\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n",
    "\n",
    "# Step 13: Real-time prediction with latest data row\n",
    "latest_features = df[features].iloc[-1:].copy()\n",
    "pred_price_1d = models['price_1d'].predict(latest_features)[0]\n",
    "pred_dir_1d = models['dir_1d'].predict(latest_features)[0]\n",
    "\n",
    "print(f\"\\nðŸ”® Real-time Prediction for next day:\")\n",
    "print(f\"Predicted next day closing price: ${pred_price_1d:.2f}\")\n",
    "print(f\"Predicted direction: {'Up' if pred_dir_1d == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "2097eb7f-febe-4354-9a25-4932425cb081",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“ˆ Classification Report:\n",
      "\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "        Down       0.42      1.00      0.59        83\n",
      "          Up       1.00      0.01      0.02       117\n",
      "\n",
      "    accuracy                           0.42       200\n",
      "   macro avg       0.71      0.50      0.30       200\n",
      "weighted avg       0.76      0.42      0.25       200\n",
      "\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAABKUAAAHqCAYAAADVi/1VAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQABAABJREFUeJzsnXe8FNX5/z+zs3vv3ktTOgoCYgdFFAsKggXUa2/REDtqUGPD2KOCmq9fW2ILxCQiP0sSy9cYNVgQBRFUBMFIsQLSLtL7LVvm98fumZmtd2Z2Tpnd5/168brcvbtnzp45c8pzns/zaIZhGCAIgiAIgiAIgiAIgiAIgYRkV4AgCIIgCIIgCIIgCIKoPMgoRRAEQRAEQRAEQRAEQQiHjFIEQRAEQRAEQRAEQRCEcMgoRRAEQRAEQRAEQRAEQQiHjFIEQRAEQRAEQRAEQRCEcMgoRRAEQRAEQRAEQRAEQQiHjFIEQRAEQRAEQRAEQRCEcMgoRRAEQRAEQRAEQRAEQQiHjFIEQRAEQRAEQRAEQRCEcMgoRRAEQRCcmTRpEjRNw5w5c8zXxo4dC03TzH+hUAjdunVDXV0dZs6cmfH5ZcuWme8bO3Zs3mtcfvnl5nuc1iffvzVr1jj6TsOGDcuoe5s2bbDXXnvhvPPOw2uvvYZkMumoHL/Jbtfa2lp0794dJ554Ip566ils27Yt5zOXXnopevXqJbyuO3fuxNixYzFt2rScv7F7tGzZMuH1ysewYcMwbNgwR++zt39NTQ369++Pxx9/XEifmDZtGjRNy2hTr/d3/PjxmDRpUs7r7HnM9zeCIAiCINwRll0BgiAIgqhk3n33XbRr1w7JZBLLly/Hww8/jGHDhuHzzz/HIYcckvHeNm3aYNKkSbjnnnsQClnnStu3b8err76Ktm3bYuvWrY6v/dxzz2G//fbLeK1Dhw6OP7/nnnvipZdeAgDs2LEDS5cuxRtvvIHzzjsPQ4YMwVtvvYV27do5Ls9PWLs2Nzdj9erVmDp1Km699VY88sgjeOutt9C/f3/zvXfffTduuOEG4XXcuXMnxo0bBwA5Bp9TTjkFn376Kbp16ya8XqVi7xdr167Fn//8Z9x0002or6/HQw89JLw+Xu/v+PHj0bFjR1x66aUZr3fr1g2ffvop+vTp41MNCYIgCKJyIaMUQRAEQUjk0EMPRceOHQEARx11FA4//HD06dMHr732Wo5R6vzzz8ff/vY3TJ06FcOHDzdff/nll5FIJHDmmWfixRdfdHztfv36YeDAgZ7rXlNTgyOPPDLjtSuuuALPPfccLr/8clx11VV4+eWXPZdfCvZ2BYALLrgAv/nNbzB06FCcfvrp+O6771BdXQ0AjowLhmGgsbERNTU13Opsp1OnTujUqZOQa/lNdr84+eSTsd9+++Hpp5/GAw88gEgkkvMZnu3rt/Gouro6p98TBEEQBOENku8RBEEQhEIwz6J8G/d9990XRx11FCZOnJjx+sSJE3H22WdL80rK5rLLLkNdXR1effVV/PTTT+brf/rTn3DMMcegc+fOaNWqFQ488EA8/PDDiMVi5nvuv/9+hMNhrFixIqfcyy+/HB06dEBjY6OnevXv3x933XUXli9fnmEsyyfv0jQNv/nNb/DnP/8Z+++/P6qrq/H//t//AwB8//33GDlyJDp37ozq6mrsv//++NOf/pRzvc2bN+Pmm2/GnnvuierqanTu3Bl1dXX45ptvsGzZMtPoNG7cOFPuxrxyCsn3Jk6ciP79+yMajaJ9+/Y466yzsHjx4oz3XHrppWjdujV++OEH1NXVoXXr1ujRowduvvlmNDU1Zbx33LhxOOKII9C+fXu0bdsWhxxyCJ599lkYhuGlifMSiURw6KGHYufOnVi3bh0Af9r3m2++wUknnYTa2lp07NgRo0ePdizPTCaTeOqpp3DwwQejpqYGu+yyC4488ki8+eabAIBevXph4cKFmD59unlvWBmF5HuffPIJjj/+eLRp0wa1tbU46qij8J///CfjPey+fvTRR7j66qvRsWNHdOjQAWeffTZWr17tpXkJgiAIItCQUYogCIIgJJJIJBCPx9Hc3IwffvgB1157Laqrq3Huuefmff+oUaPwxhtvYNOmTQCAb7/9FrNmzcKoUaNcX/vUU0+Fruto3749zj77bCxYsKCk72Ln9NNPh2EYmDFjhvnajz/+iJEjR+KFF17A22+/jVGjRuGRRx7Br3/9a/M9v/71rxEOh/HMM89klLdx40b885//xKhRoxCNRkuqFwB8/PHHLb73jTfewIQJE3DPPffgvffew5AhQ7Bo0SIcdthhWLBgAR577DG8/fbbOOWUU3D99debUjwA2LZtGwYPHoxnnnkGl112Gd566y38+c9/xj777IP6+np069YN7777LoDUPf3000/x6aef4u677y5YnwcffBCjRo1C37598frrr+OJJ57Af//7XwwaNAjff/99xntjsRhOP/10HH/88fj3v/+Nyy+/HH/84x9z5HPLli3Dr3/9a7zyyit4/fXXcfbZZ+O6667D/fff77hNnfDjjz8iHA5j1113NV8rpX1//vlnDB06FAsWLMD48ePxwgsvYPv27fjNb37jqD6XXnopbrjhBhx22GF4+eWX8c9//hOnn366aQT817/+hT333BMDBgww782//vWvguVNnz4dxx13HLZs2YJnn30W//jHP9CmTRucdtppeb0Fr7jiCkQiEfz973/Hww8/jGnTpuHCCy902JoEQRAEUUYYBEEQBEFw5bnnnjMAGF988YX52r333msAyPnXtm1b4/XXX8/4/NKlSw0AxiOPPGJs27bNaN26tfH0008bhmEYt9xyi9G7d28jmUwa1157reFkan/nnXeMu+66y3jrrbeM6dOnG08//bTRvXt3o1WrVsb8+fMdfaehQ4caffv2LXoNAMZDDz2U9++JRMKIxWLG888/b+i6bmzcuNH82yWXXGJ07tzZaGpqMl976KGHjFAoZCxdurRovVi7rlu3Lu/fGxoaDADGySefnHG9nj17ZrwPgNGuXbuMehmGYZx44olG9+7djS1btmS8/pvf/MaIRqPm+++77z4DgDFlypSCdV23bp0BwLj33ntz/sb6DPu+mzZtMmpqaoy6urqM9y1fvtyorq42Ro4cmfF9ABivvPJKxnvr6uqMfffdt2B92D257777jA4dOhjJZNL829ChQ42hQ4cW/Kz9fX379jVisZgRi8WM1atXG7fffrsBwDjvvPPM95XavrfddpuhaVpOfx0+fLgBwPjoo48y2sN+fz/++GMDgHHXXXcV/S59+/bN+53Z8/jcc8+Zrx155JFG586djW3btpmvxeNxo1+/fkb37t3NtmT39Zprrsko8+GHHzYAGPX19UXrRBAEQRDlBnlKEQRBEIREPvjgA3zxxReYPXs23n77bZxwwgm44IILCnpltG7dGueddx4mTpyIeDyO559/HpdddpmjrHuMk046CQ888ABOPfVUHHPMMbj22msxY8YMaJqGe+65x3xfMplEPB43/yUSCcfXMPLIv+bNm4fTTz8dHTp0gK7riEQiuPjii5FIJPDdd9+Z77vhhhuwdu1avPrqq2Y9JkyYgFNOOaXkLHn56lWI4447LsOzp7GxEVOnTsVZZ52F2trajLapq6tDY2MjPvvsMwDAO++8g3322QcnnHBCSfVlfPrpp2hoaMgJut2jRw8cd9xxmDp1asbrmqbhtNNOy3jtoIMOypBTAsCHH36IE044Ae3atTPvyT333IMNGzZg7dq1nuq6cOFCRCIRRCIR7Lbbbnjsscfwq1/9Cn/9618z3ldK+3700Ufo27dvRsB6ABg5cmSL9XvnnXcAANdee62n75fNjh078Pnnn+Pcc89F69atzdd1XcdFF12ElStX4ttvv834DPPYYxx00EEAkHN/CIIgCKLcIaMUQRAEQUikf//+GDhwIA477DCccsopePXVV7HXXnsV3TCPGjUKX375JX7/+99j3bp1OYYKL/Tq1QuDBw82N/1AKoYTMy5EIhEcf/zxjstjm+vddtsNALB8+XIMGTIEq1atwhNPPIEZM2bgiy++MGMFNTQ0mJ8dMGAAhgwZYv7t7bffxrJlyxxLs9zUqxjZme82bNiAeDyOp556KqNdIpEI6urqAADr168HAKxbtw7du3cvub72a+erE5D6LuzvjNra2hyZY3V1dUY8rtmzZ2PEiBEAgL/+9a+YOXMmvvjiC9x1110AMu+JG/r06YMvvvgCc+bMwYIFC7B582a8+OKLOTHPSmnfDRs2oGvXrjnXzvdaNuvWrYOu647e64RNmzbBMIyC9wZAzv3JznLJgu57bXOCIAiCCCqUfY8gCIIgFCIUCqFv37549dVXsXbtWnTu3DnnPUcffTT23Xdf3HfffRg+fDh69Ojhy7UNw0AoZJ1XjR07NsMQ1KZNG8dlvfnmm9A0DccccwyAVPygHTt24PXXX0fPnj3N982fPz/v56+//nqcd955+PLLL/H0009jn332ycg46BUWyHrYsGEtvjfb+2zXXXc1vV8KGQ179+4NIJU9b+XKlaVV1gYzYtTX1+f8bfXq1RmZBp3yz3/+E5FIBG+//XaGAeuNN97wXE8AiEajjrI6ltK+HTp0wJo1a3L+nu+1bDp16oREIoE1a9bkNSS5Zdddd0UoFCp4bwB4uj8EQRAEUQmQpxRBEARBKEQikcDXX3+N6upqtG3btuD7fve73+G0007DzTff7Mt1ly5dipkzZ2akuu/VqxcGDhxo/tt3330dlfXcc8/hnXfewS9/+UvsscceACwDBPMIAVJGsGxJF+Oss87CHnvsgZtvvhkffPABrrnmGlcSxXx89dVX+J//+R/06tULv/jFL1x/vra2FsceeyzmzZuHgw46KKNt2D9mPDr55JPx3Xff4cMPPyxYnhvvmEGDBqGmpgYvvvhixusrV67Ehx9+6MqLjaFpGsLhMHRdN19raGjACy+84LosP3DTvsceeywWLlyIr776KqOMv//97y1e5+STTwYATJgwoej7qqurHd2bVq1a4YgjjsDrr7+e8f5kMokXX3wR3bt3xz777NNiOQRBEARRiZCnFEEQBEFIZO7cuaas6eeff8bEiRPxzTff4KabbiqaZe7CCy/0nK3rhBNOwDHHHIODDjoIbdu2xddff42HH34Ymqa5yrrW0NBgyv0aGhqwZMkSvPHGG3j77bcxdOhQ/PnPfzbfO3z4cFRVVeGXv/wlbr31VjQ2NmLChAlmFsFsdF3Htddei9tuuw2tWrVyLVFk7RqLxbB69WpMnToVL7zwAjp37oy33noLVVVVrspjPPHEExg8eDCGDBmCq6++Gr169cK2bdvwww8/4K233jKNUDfeeCNefvllnHHGGbj99ttx+OGHo6GhAdOnT8epp56KY489Fm3atEHPnj3x73//G8cffzzat2+Pjh075o2btcsuu+Duu+/GnXfeiYsvvhi//OUvsWHDBowbNw7RaBT33nuv6+9yyimn4A9/+ANGjhyJq666Chs2bMCjjz6aYTgUjZv2nThxIk455RQ88MAD6NKlC1566SV88803LV5jyJAhuOiii/DAAw/g559/xqmnnorq6mrMmzcPtbW1uO666wAABx54IP75z3/i5Zdfxp577oloNIoDDzwwb5kPPvgghg8fjmOPPRa//e1vUVVVhfHjx2PBggX4xz/+UbJBlSAIgiDKFTJKEQRBEIRETjrpJPP/7du3x957742JEyfikksu4XbNAw88EC+//DIeffRRNDQ0oHPnzjjuuONw9913u/LoWLJkCQYNGgQg5S3SpUsXHHLIIXj11Vdx9tlnZ0gB99tvP/zf//0ffve73+Hss89Ghw4dMHLkSIwZM8b0XMnm/PPPx2233YaLLrooJx5RS7B2ra6uRvv27XHggQfioYcewmWXXeZKhpjNAQccgC+//BL3338/fve732Ht2rXYZZddsPfee5txj4CU1PGTTz7B2LFj8Ze//AXjxo3DrrvuisMOOwxXXXWV+b5nn30Wt9xyC04//XQ0NTXhkksuwaRJk/Je+4477kDnzp3x5JNP4uWXX0ZNTQ2GDRuG//mf/8Hee+/t+rscd9xxmDhxIh566CGcdtpp2H333XHllVeic+fOGDVqlOvy/MBp+3bt2hXTp0/HDTfcgKuvvhq1tbU466yz8PTTT+OMM85o8TqTJk3CIYccgmeffRaTJk1CTU0NDjjgANx5553me8aNG4f6+npceeWV2LZtG3r27Illy5blLW/o0KH48MMPce+99+LSSy9FMplE//798eabb+LUU08tuV0IgiAIolzRDDdpaAiCIAiCIATx1FNP4frrr8eCBQvQt29f2dUhCIIgCIIgfIaMUgRBEARBKMW8efOwdOlS/PrXv8bRRx9dcuBtgiAIgiAIQk3IKEUQBEEQhFL06tULa9aswZAhQ/DCCy+ga9eusqtEEARBEARBcICMUgRBEARBEARBEARBEIRwQi2/hSAIgiAIgiAIgiAIgiD8hYxSBEEQBEEQBEEQBEEQhHDIKEUQBEEQBEEQBEEQBEEIJyy7AqJJJpNYvXo12rRpA03TZFeHIAiCIAiCIAiCIAhCGIZhYNu2bdhtt90QCsn1Vao4o9Tq1avRo0cP2dUgCIIgCIIgCIIgCIKQxooVK9C9e3epdag4o1SbNm0ApBq/bdu2kmvjnVgshvfffx8jRoxAJBKRXR2iAHSf1IXuTTCg+6QmdF+CAd2nYED3SS7U/sGA7pOa0H0JBvnu09atW9GjRw/TPiKTijNKMcle27ZtA2+Uqq2tRdu2bWkAUBi6T+pC9yYY0H1SE7ovwYDuUzCg+yQXav9gQPdJTei+BINi90mFkEYU6JwgCIIgCIIgCIIgCIIQDhmlCIIgCIIgCIIgCIIgCOGQUYogCIIgCIIgCIIgCIIQDhmlCIIgCIIgCIIgCIIgCOGQUYogCIIgCIIgCIIgCIIQDhmlCIIgCIIgCIIgCIIgCOGQUYogCIIgCIIgCIIgCIIQDhmlCIIgCIIgCIIgCIIgCOGQUYogCIIgCIIgCIIgCIIQDhmlCIIgCIIgCIIgCIIgCOGQUYogCIIgCIIgCIIgCIIQTljmxT/++GM88sgjmDt3Lurr6/Gvf/0LZ555ZtHPTJ8+HWPGjMHChQux22674dZbb8Xo0aPFVFgREkkDny/diLnrNXRYuhGH79kJc3/ahLXbGtG5TRSH924PPaTl/dzspRuxdlsjOraqBjRg/fYmdG4TxaE9dzXLsP8t+32FypZZvtNryS6/1LZyem9bKiMI5XtpR7f1n51+hnb9cQP0cLjFe+21fdx8n0qkpWdhtm2sG7RXZ9djG++2dzpuBGHstJfh5pmU2f488TouiaSlsWdA9zZK1MvPdYnXe+F1HvOj/rz7j9c5iPfYoyL5+qab94r4rjyuW6xML2O4quueUtaFTvp70NaFIsaGeCIuZE8axLGZcI5Uo9SOHTvQv39/XHbZZTjnnHNafP/SpUtRV1eHK6+8Ei+++CJmzpyJa665Bp06dXL0+XLg3QX1GPfWItRvaQSg4/nv5yCkAUnDek+3dlHce9oBOKlft5zPnb/jRSSMEG5InJ1RbkgDrg29Dl1L4ob4uQWvn6/s3Hrlkl1Hv8t3ei1Z5bu5ltvy85VXrIwglO+1Hd3XX8fz388teA03z1ax9nHyfSoR589Caqxz2v52eLa9m3EjCGMnKwOA42fyvYU/4/fvfCul/XnidVwSiZOxp2vbatR11VAnuV5ent1S59qW6uRmHvOj/rz6j9c5iPfYoyKF+uZdJ+/r+L28vyuP6xYrE8gd7+0Ead3jz7qwOEFaF4odG9zvSb2MPUEamwl3aIZhOHgE+aNpWoueUrfddhvefPNNLF682Hxt9OjR+Oqrr/Dpp586us7WrVvRrl07bNmyBW3bti212kJ5d0E9rn7xS7R0w5itd8KFh+Ckft0yPned/jpujryGx2Ln4imbYarQ6y2V7aZeTii38mOxGCZPnoy6ujpEIpGSr1Xs3vqBKuXnu092nH5OlfZp6ftUIl7ujZf259X2busfhLFNAwq+N9/Y9uAL7+C573Qp7c8Tr+OSSNyMPQYMPH3BwTj14O7S6uX32OzmXvjxnPlR/2J1zl4rOMWPdWGpqPRcFKOlvnnZPgnccdHJRddqvL8rj+sWK9PJ/Vdp3VPsOaF1YSYqjA1BKT8oY1ip5Ht+VLKLSPWUcsunn36KESNGZLx24okn4tlnn0UsFnM1kQeNRNLAuLcWOXrI2Hvu+tcCtI1GcNe/FpivMYPTzZHXzN+dGqSyy96ltsr8v1+DS7mVbyQT+HErMOenTdBCesnXKnZv/UCV8g2kJolxby3C8AO6ZrjVFnsWVKl/vs8V+j6ViJvxzI6X9ufR9l7qH4Sxrdh7s8tPxON4ZUlISvvzpKXxRYXv4mU98Pt3vsHJB+3OXcoqamx2ei+8jjX5rgeUVn+/+49f68JSUeW5KIaTvvnKkhCOX7oRejjsaW3Cu45eruvke7dEENY9tC7MRJWxISjlB2EMqwQC5Sm1zz774NJLL8Wdd95pvjZr1iwcffTRWL16Nbp1y7VuNjU1oampyfx969at6NGjB9avXy/dIuiGz5duxIUT5/hWHjNExQwdES3hyCBFEDJ48fKBOMIW88HvZ0E02d+nEpF1D/1q+6D3QVkEoe87vbcyv4vX/se7zio+16o+q9l1jsVimDJlCoYPH+74gFXF76bqM86jrfz+rjzGHlX6iF9tVeg5UeV7ekVWXyJyUXUM84N8z8/WrVvRsWNH8pTygqZlWi+ZTS37dcaDDz6IcePG5bz+/vvvo7a21v8KcmLueg2A7vpzNbqBhkRu2zyVOBs3hV9DREsgZuieDFJtI6m23xrjY1Euh/KjtlvWmPD3WoXubbmV//6Mz7FhsWU7d/osqFL/bLK/TyXidTyz46X9/Wr7UutfDmObl/KD0Ped3luZ38Vr/+NdZ1ljc7Hv5cdYk40f9S9U5ylTpjguw+91oR+o+ow7bSs3Y5vf35XH2ON3/1dl3ZP9nNC6MBMVx4aglK/qGOYn9udn586dEmuSSaCMUl27dsWaNWsyXlu7di3C4TA6dOiQ9zN33HEHxowZY/7OPKVGjBgh3SLohg5LN+L5791bvW8asS/+553vcl6/Tn8dzDsxoiVwnf66a8PU+IsOAwBu1vhyKP+Q7m1Mq/SXK7f5eq1C97bcyh8x5IiMUwunz4Iq9c8m+/tUIl7HMzte2t+vti+1/uUwtsXjcVz6/HxXnwtC33d6b2V+F6/9j3edZY3Nxb6XH2NNNn7UP7vOXjyl/F4X+oGqz7jTtnrylwMQDocdjZ1+f1ceY4/f/V/2uqfQc0LrwkxUHBuCUr6qY5gfFPKUUoVAGaUGDRqEt956K+O1999/HwMHDiw4iVdXV6O6ujrn9UgkEqgYVIP26oxu7aJYs6XRcWDCru2iuPToPnhu1vKMzzHp3sZka7QPbcc/48MyYkw5LXvQXp0BwFW9nFBO5ScTcQCp/ub2HrZUfr576weqlG9vR7u+u6V2VKX+hT6X/X0qkVKeBS/t73fbe61/OY1tsVgMu1QZ2NKsCW9/njgdX2R+F/f9z0A3AXUWPTY7uRd+zbv265VS/5bq7GZt6ue6sFRUeC6K4aRvtqsycGSfTohEIlLGAB5jj+x1J6+2yn5OaF2YiUpjQ1DKV30M8xP786OSLSQk8+Lbt2/H/PnzMX/+fADA0qVLMX/+fCxfvhxAysvp4osvNt8/evRo/PTTTxgzZgwWL16MiRMn4tlnn8Vvf/tbGdUXih7SzNStLT0q7O/3nnYAqsKhjM/Zg5q3D20HAKwyOuKx2Lm4OfIartNfd1y2HtJc1csJ5Va+HT+uVeze+oEq5TttR6/le8Vr+cW+TyVS7B4Ww0v782h7L/UPwtimFfh/ofLP7pVssfyg9f1i7abKd/GyHrjr5P2411nk2Oz0Xvj1nPlRf7/7j1/rwlJR5bkohpPn+uxeyZyxMxue35XH2OPku7REENY9tC7MRJWxISjlB2EMqwSkGqXmzJmDAQMGYMCAAQCAMWPGYMCAAbjnnnsAAPX19aaBCgB69+6NyZMnY9q0aTj44INx//3348knn8Q555wjpf6iOalfN0y48BB0bRfNeD37+enaLpqR1tL+OV1L5gQ1j2rN+FPybDwWOxe6lixah+yyi9WrWB39Lt/ptWSUb6fUtip2b52WEYTynbZjp9bVRT/npf7F3ue0/OziW/o+lQhru11qCp/SeG3/Yp/xC3bt1tXOHI6DMHZ2bRfFny88BH92+Ez272DgqQv6S2l/nngdl0RScOzJeWaqcfk+SZzYt4vQeu1Sm/lce3l2S5lr89WplHnMj/rz6D9+rAsLUcrYoyLFnuunLuiP/h2MnPe2iYZz3svzu/IYe1iZu+Z5Jtl4n/09i13b+dgjtl+wenVsXVW0HpWyLpQ1NgShfFqjq4ky2fdEsXXrVrRr106JKPNeSSQNfPrDWrw/43OMGHIEDt+zE+b+tAlrtzWic5soDu/dPq+lN5E0MHvpRqzd1oiOrapx9Et9AAAr+12Dzmf+3iyjY6tqQAPWb2/K+H+xsvOVb//coT135Va+02vJKD8Wi2Hy5Mmoq6vLcJH00lZO721LZaha/lnjZ+K/K7fg6qF98NsT93V0WvH9z9sw/I8foyYSwsRLD3dV/9lL1uH9GZ/jhKMPhx4Ot3iv3bTP/BWb8NC73+KwnrtizIh9i/a7Sue1OSvw29f+i327tsE9pxyQ0/7sPo0YckRBt+rs5+m+txfi25+344bj98b1x+/Nte0fee8b/OmjH3HM3h3x62P6BHrstJeR3aeLjW0hPWy+t1VExxUvzAUA/L/LD8PgvToFtu8nkgYGPjAFm3bGcMuJ+2D00L2U+y6JpIG975qMpAH8aeQhCAG4+u9fYo/2tXjonIMwoHsbvPfuOzlzEG/enL8K1/9zPvp0aoUHzjzQ8bqkWN9/fOp3+GLZJlx+dC/cdYr7E+1E0sDghz5E/ZZG3HPq/rjwyF6O5jE36yp7GUbSwMhnP0fnNtV44oIBRZ/RQmsFp8QTSex11zsAgD9feAiO269LyfUvNvZM/eZnTJy5DIfssSteHT1IueeiGImkgeMenYafNu7E7SfvhyuH7IlkIp63/f88/Qf87zvi5/JE0sAJf5iOpet34MohvXH7yfuXfN2pi37GqOfnoE00jL9cNDDju9i/540n7ONpXdgcS+CSSV+gW9so/nD+wVzayslz8t+Vm3H60zPRNhrGM1nfs1j9nc61XteFny5Zjyen/oBBfTrg+uP2FtqXhj7yIVZuasTv6vbHxUf18n1siCfimDpzdkl7Uqf7CD/G5p827sDt//c19u/aBvec1rdi1uj5nh+V7CKBiilFpNBDGo7o3R4bFhs4ond7RMIhDOqTP9B79ufyva/7LlHAYRleymfwLr/Ua/Eu38213Jafr7ygld+hVep0q3enVo4nB3YyF43oRa+Zr/7sGRrUp0PRTYCXZ2tRfSpw4G671pTcV8oddirSrV0UR+/dMefv9rGuUL/Ibv/2raoBbEefzq25LzTYsc5endvkrb8TVBo7vXzG/t6dzXHz9cN6BXuhp4c0hPWUQ/nendso+12S6T44qE8HfLVyMwCgTTSMQX06IBaLSa1T13ZR12OzHfvf/v5FynN+j/a1nu6FHtLME/KBvdqjqoV1TynrKgCY+9NGAEBNVfH5yQ/sGaiP6N2hxe/G8Dr2rN3eCACordKVfS4KoYc01FSlMpP1260d9JCGZCL/e8Oh1PMvei7XQxpqIqk69uzgfE1UDDbXVum5fcMwUuX37NjK8TyW3Xc+/XEDAKBVeuyRBXvKW1UXr4fbda3b92WX/+XyTQCAPXatFd6XqsPp/t69HZexIRaLYfO3/uxJ85Xv5m9Oyl+ztQEA0LFNNa3RFUKqfI9QhFadZNeAIBBKL6rdOG+yjU8o229cMmz9mKwoP1RvGBzuYXof4aovecXqg9wvFQjs97Ec+j/rQ6p+l+a4JbmvCocQSXf+hOQKx9PXZ5t6P2B9q5Sv1phur2jEfbp0t2hmfUWMQ9Y1RMyH0fQmtzFWwJqjOKy9Whq3/ehzXmF19GseS5pjWW55TtujGNa6R+7YY30XtSZlTWL78FhnBZmQwLGZcA4ZpSqZXkNSP9uIiTVBEMXQPCz+2ISiKTbR0oTnHD8Ww9mIbH+2YQiRVQpAZlyRcuj/bDxSNdJBhlFKD5keFbFE8fiQvImnrx/28bnwY9Pb0JwyotQIMEqZ45CAW2FvE03Ayj6a9jRqjAfVKJX62dLaQaahhV3SL4NYskh5hg+GHDYHyh4qrXWh3Hpko4KBk5YpKTSBYzPhHDJKVTJs5UJPJaEAaZWMqxN+9l5dsZGMLc6SqrpXKESCw6kmK0vEvpz1QTqBTKHbPaXKoP+z+5uQvdMqQFMiZRTQNCCia4joqfaPS277GPOU0v17LvQSjc2GYZhGlOoI/0mj1Pq6wb6M0wV6SjEjX9BImmuH4m2lS5zL2Zjjl9ej6SmVpzw2V5ZyuGLNu2p4SqkmKxU5HmSToMOzDNi9UHVer1QU28oRQknGAU0HwlUtv5cgOONFvqeqS7IqbuxBgIcEU2T7k3wvk3KT71mSF8kVKQDzlKrSQ9A0KwZWPCFZvsc8pXw8MfDiTWunOZE05wwRnlIi5Tqi5XssJlNjLJiHmk49R0RKMLMpJrfzu7zyku+lfqq2LpQp32NGa9XaRBasr6rqAV2pkFGqkvl5IWAkgM4HyK4JQVjeRR7ke6pNtLpEN+2gYXA41dRD7g2cXlH1VFYW9pNY2ZsTP2BfQdXFq2mUCqeWc0wuF5fsAc28JSK+Ptepn177VWOz1SYiYkrpHuY0r2QYpUTI99KeZsGNKZX62ZLniMh7mI019vhTnhP5Xiledroq8r1k6QY2HsjtS6Xf33LCy36D4A8ZpSoZI71AExGAgCBawIvrtymdUqwLW7FEaMZrCXYP/VwraQLle6rGNZOJeWJeBv3flO8p+l2a0528mhmlmHxPsqdULMGMtRwCnXu8F0y6Fw5piAjQfIucB+w2SCGeUpFgBzp3KruWOZb5LR1OFikv4cM8pop8j0dIAD+QuS607q/wSyuJKn2VyESxrRwhFNMoRaMUIR8vrt/kph18gi/fU/NUViYyA7r6TZDke4CV7U6VQOcRH2NKlSrfY/GPRHhJAXLGodR1BcSUSrdhQyyhrBdhMQyH43Y5yvfy3S8/5mFV1j0U1iEXVdfKsiD5npqQUaqSad6e+rn4Lbn1IAh4CwKZVNQlmblpS3ZWCAQ85XsiFn9s769aH5RJyOz/wX8AzAxYilqlmrLke2Ud6LxU+V5csFFKoEQkkWGU4n891oZJw/KKCxJOvWmsgMjcq5SDSPmeJUP3Xr7IebcY5kGRYidF5rwoYWx2Gti/UiinNUo5QUYpAmjYLLsGBOHpFDzJQfrlB16CtlcqPOV7IgwJhqILYJmUlXzPZ28Fv8mJKcUCncuW0KT1ZGGF5HuWp5SYpa9Q+Z5NniNCSmxvw4YASviceo6w7itjLvdbOpwsUp4Vh6l0+Z7sYd+SZsqtRzYy24c8ujOxxmbJFSEyIKMUQRBKQPK9yoSPfE98gGHFuqBULKOs5Ir4QGDke9mBzqXL99KeUj7ugkp9rlmmOBGZ9wCxch3RkqUqPWR+v6YAGqWsw4Ti7wuVoXwPyDWysWeqtJhSudeRgeryPRkGTj/ubzmhSl8lMiGjFEG7KUIJTNdvFzsOVTOf6RLdtIMGDwmmLnDBQfK9XCzJS7D7v2EY5gZH1e/SlBNTyjLcyPRUY5KusI8BxUMl9isWlFtcTClxzwGba0SNQ5qmZcSVChpO20tmQGTTKOXTte39MPv7mO1RwuOqSvBoKwGOWnOyyPEgG5LvZeIlXAjBHzJKEUC4RnYNCMKbfE/RzGequLEHAVM24ONsJPJ02wqYq1YflEm5eAran19Vpbgs+162fA8AYhK1CfGk/4HOSz3dtoxSguR7AmNKyfDYjJoZ+IKngXHqOSJXcpX506/y8pXpxzymioesqlI1ku+pQ6lJMwg+kFGqkjnwF6mfVbVy60EQ8BbE1pJ+cahQCVBmD+fwcCsv982g6rDT2KD3f/tYpGp8LCbfqw6nDAR2uZxMjwUW08rPmFJWv/L2+QbhnlKpnyKeA3YJkZ4QNQH2lHLqZa1LjCnlt3zP/h2yy/RDRq9OoPPUT9UOimTOi6q2iSxU6atEJmSUqmQ0NtsG75SLKD+8BIVV1SVZFTf2IMBc2f2UnbDuIKL9ExI2g6pj9X/JFSkRe/9RNcFYbqBzqx/KzIrGYlr5mX1PK3FcZR49ooxSusB5wAruLG4cqk57nDUG0SjlMBh2qX2uFMxA5z5tnO3fIXsz7jQbYTE0gfNuMVTNyiyzfcz7S+sUAOWVjKWcIKNUpWIYQLwB0HQgQvI9Qj5eXJtJvhd8DA5u5SKzHyZ9WMyXG5pA+SRP7NVX1eurOZ4yCDCjVMTmmSQz2DmfQOepn177FfPoERXoXKRERIbHZrA9pVI/W8y+J3EuZ93cr6HHmXzPe/mqyfdUm5JlBs3nsc4KMiTfUxMySlUq8SZg0b8BIwEcdL7s2hCEpwmbTSg+Hsb7QrnIl0SQ5HCCJ1K+Z9AJZA5epLgqkiHfU/S7sJhS1elGD4U0oZ6ChTDlez4GOi9Vvic6ppTde5L3XGDOhQLHIeZxFsTse07nHSXkez49x0Xle2n7dSnzmCqSKBnPghN0geuSbKy1slptIgtV+iqRCRmlKhXDtojQqBsQ8jE3Ui4mCRmSBSdoHr5LpcKcOfy8h0Llew5lIJWEJcWVXJESycxWJbEiRWiKZcr3ACuOU0yqUSot3/PxwShdvifWU8r+1XmPRTI8NoPtKeVSvidhLucq38vOvuenfE+2UUrRdaFMyRi796qpCmRB8j01IWtEpWKPI0VGKUIBQh5OwVXNfFYum3IRBF++l3lNQq5MwU/s06Sq3yU7+x5gxXGSKd9j8az8jCnlX/Y9sfI9gL93hIzsWlEzplTwJjrX8j0JX1GkfM+P/mOX78n0EldVvidL1m6/F3R4loJCbKgJWSMqlaTtZOvLF+TVgyDSeAkObgVv5FIlz5BrsHNMTyNfY8+IO902g+2rtgKWCHseZZ+Yl4q9/qqeqJqBznW7p1SqL6oQ6DziZ/a9Ejd1orPv2eVDvOcCGV7DrB0bmoPnKeW0vUrtc6XAxh+/vOySGZ6f2fK99DxWinxPoBG2GAkfvgsPzMQHgtvGfq9VaxNZiFwjEs5RbCtHCMN+BLytXl49CCKNl1NwVb1UtBJP9CsJHvdQ5CmYqqeyMhHpqcaTzJhSEitShKZ4rqdUJG2gUiOmFIdYcR69VkRn37Pv/3jPBYaEuZC1Y2M8WEYpN54jpXrnlYIZU8qna9sN69ljM/tTKfKukCbOCFsMGc+CE0KS4pPZpwGS76WQdS+I4pBRqlIxguduTZQ3XjK3KC/fo/muRXjITkRuJFQ1jMqkXPp/kAKd241SuukpJT/7np8n86Ua+63se2KWviGBniMy5HssplTQ5Hv2e9HSuC0rS5dhGOZayK9r85bv2SOByBwvZTwLTpAl30u6MMJWCuWyRik3yChVqWQYpeipJOTDTsFdyfc4SL/8wJTv0YzXImzB5Kf8TWT7m/VXrA/KRIXsb36QDEJMqbSnVHXY8v5hnlJxqZ5SyYy6+IFeouSiSbB8z27w4P0syJgLrZhSwfKUst+LlrPvyZnLMwxIPl07I3FDjqeUz/I9iXZKP4K288AcvwS3jX3uonVKCi/hQgj+kFGqUglXW/8nrylCAUqT73GoUAnIdPkPGpb8zf8sXSTfk0O5BDoPhKdUHvmeUoHOOcSK83ormEdPTZV4+R5vmYgMj03LUypYRik3niOy5nIeY4+9D2YbupgRqRzke6p6L8uStbvxDKwUaI2uJmSUqlSi7YCjrk/9PxmsBQVRnugeDAk8vGz8gFyDncPayM8TPOacIUS+l2TXVKsPyoS1RdDXe0GIKZXXKJVuf5meUuwE2k9PKTOmVInyPbtXGU8yA53zvZYhwWOzOqCBzu3dp6X2svoczxrlwmPssZeZ/Qj5sZYKKSLfk/EsOCEkcF1iJ9MIq1abyKJc1ijlBhmlKhnNjPQmtx4EAXsQWxeeUkn/vWz8gFyDncPuob8xpcRJLlSVCshEK5P+nyHfU/S7sJhS1RnZ99LyPYnZ91g8Kz83hqXKQplHjyhPKU2CfE/kMGR6SsWD5W2fcLFJlzWX85AO2x0nC8n3SnlcQ6rI9yQ8C06Q15coplQ2tEZXEzJKVSrJBJBoBkJhIBKVXRuC8BTEVl35XnlkHxNB0OV7hg+L+XKjXFzjgy7fi0ncGXLJvleifI95SkXD4pa+7FkoR/leNKCeUvZnuaXmEnX/suEu3yuQfa+U/kPyveKUOn55heR7uVCGbDUho1Slsvkn4LPxQDgKHH+P7NoQhKcgtgnF3bS9BuStJLjI90oMiOwGM8AwLfZM9BJlVqpgr7/E8ExFaYqnDAKZRin5nlIsnpVK8r0mwTGlAPuzwPc6MqTsNVWpe8v6YFCwe4601F4hgXOJHf7yvQKeUiXMw/aPylz7qCrf0yWtC90E9q8UymWNUm6QUapSYQ+iRl2AUAMvp0iWl4paEy3FlHIOH/le6qeI021VT2VlYnqqKWrIcUqgPKVsxp+ImclUAU8pheR7DYKz7wE2KSt3TynxkqVoOKieUtb/ncr3hMeU4iAdzpDvJbP/Vvo8rGmaEh4oqsr3LA9usW1D3ty50BpdTcgiUamw4OZklCIUwZN8T9HFB8n3nJPkYFi04pP5VmRBzAUfDaUm5SPfs/6v6rPclEe+x06BY1I9pZhRykdPqRI3Eo2mfE+cUcp8FjjvfqTI96pYTKmgGaVcyPfM0KvBl+8VK9Pwqf/IkqjZUfWgKCTpsEbV9pCJCsZTIhdaRlcqRnpUbNwMzHxCalUIArA2Um5OwdmeS1k3bTqGaZEEhwWTSMkFBTrPRZd0Iuw39udXVSkuC3RuN0oxyVxcqqdU6tp+xpQqpV8ZhmF5SlWJW/qKehaY0UvkXBhYTymbV1BLsQxNKbjgudw+3vh17WSRMk1PqRL7j6z2sqNqVmZZ86K5RlFsnSwT3WY8VfXAqRIho1SlYtgWq+u/k1cPgkhTTvI9kYG2g44fWX+yEempw/b9qvVBmZSLazyPuC5+UzTQudTse6lrR3w0SpVyut2cSJpzi0j5nqhngcc42hIsNldjLFg6XTeeI7Lmcv4xpfL/rdT+o4IHiml0VGyHK6tteIRICDqZQfklVoTIQLFHlhCGYTvZIisxoQBegtjKiKPhhFCZeIqIwOBwise8BUQ0Pw/5YdBhm4Gg93979VU9TWVGqWq7UcqD16nfsGv7Kd8rJWh4Y7NlOKkRGlMq9ZO7pxQztIj0lIqk7i2TRQYFN0G9ZQVE5jH22J+bQvK9Ur2LRM69hWDf08+Mvn4gKulBNn7d23LC/uwHfZ1STpBRqlKxe0oZwTrlIsoTL0FsWbBO1SZb002bjmBahEf2Ok2ghMDa4HC/VGAIKSDh8IMM+Z6i34XJ9zKNUiz7nry5PZa+tp9yslAJ4yqLe6SHNF8zAraEuRHl3H9kZAFl8r2gGaXcBPUWFRMsGx7S4WSRMhPmAZ8/MaWkGsQVle+VMn6VAoUYyCUjU6Sic3slQsvoSiW6i/X/ZLAWFER54kXmoKqXinU6LrceQYBHEE6h8j0KIpqDCsFu/SBQ8j3d8v5RQb7Hsu/5aQAqxeuIxT0S6SUFiJPvyciwxeR7DbGEsp6E+XAT1Fta9j3u8j0j79/KQb6narY5WQlAVFUUyMT+7Ado6Cp7yChVqezaEzjxwdT/yVOKUAAvQSCt2AFqzbZm0Haa7VqELSD9dF4QKbmQEWBYdUIKyMf8IEPuouh3yRdTihmCZLW/YRiWfM/PQOclPNfMU4pJzkThRZbuBRneEMxTKmnINYC6xY0nTUjSXM5fvpf/b6XOY7LkjnbcyDNFImtepDVKLva2oHW6OpBRqpLRWK5bMkoR8vFywmZ5qXCoUAlYniI02bUEW6D5Gf/BDE4rYGiTEWBYdWSdCPsNj7TsfpJIGqZHkt0oxRbcMUnZ9+K2TVfER11rKSnVmaeUyCDngDdZuhdkeGzasxg2BEjC58ZzhN0/0XM5D+lwskiZVjBsf+R7Mm34CUWTj8jyICZv7lzsTaHi3F6pkFGqUkkmU8aoUBjQI7JrQxBlJd+zNuVy6xEEykW+p1pQVZmUjXwvaTdKSaxIAZiXFJDtKZVq/7gk7xX7dXUfPaVKea5ZhjjxRikxz4KVMILvdexU6SFzc9cUIKOUm+Qaasj3/PKUKlymXxIvFQ4kSL6XiXVvFWsQiWTI98gvQxnIKFWprPgMeO8OYNdewNl/kV0bgvAUEJZNtqq5JZeLfEkE1j30r0wvUlCvsHusWlBVmZjBbgNulbI/vip+lwyjlK5OoHO7h1bYx7G5lH7FgnHLiylVfoHONU0z2zNInlJuEqTICtxdTGrnS5lZQ0PCJ4mXCoHOlZXvSZoXrXsr9LJKY3/2VZzbKxXqopUKMw1r1AUINfAm31MzgGNmEEWa8IrBw9tN5Om2oai3nkxUOC33g2KBgVWgKWEZAiI2jyQWxykuaWOYsHlK+RnovJTnmhmlxMeUSv3kvfGRJdFhnmfMEy0IuPEcsds1RI4BGV5NPj3HiSKeUm6CvxdDBS9ZZeV7IXHrEjt+3dtyguR7akIWiUqFZdwjoxShCF5OlFXVyocyJjx59QgC7MTW35hS6bKFyve4XyowqBBXxA8yN4YSK1IAe5Bz+/PDvJNkGaXsnlJ+OiswA48X40BDTFZMKTHxBWXFtqsxjVLB8ZRy01b2tYXIx4mHfM8oUmY5yfdUjfMoKz6ZqmEuZKJpmhKZIolMyCJRqTBPqXXfAB89KLcuBAG7fM/5Z1TNKmJ3GycJX3HcZEJyii5QPmnWX7E+KBMvUlwVyQg2rODClRmlqsOZS7lw2jspJkm+x2JKRXTNV2NzKdIgWTGldLPOfK8jay6sTnueBUm+x9YYTtpK1lyeOfb4X2b2RtyveViF0AVJDmsKP9BLGL9KwczMSTv+DMwwDwoeOFUq1EUrFXtkt1Vz5dWDINJ4OWELgnyPTmGKwyMoqUgJAcn3cimXE0geadn9pDmR3ygVYZ5SkgOdh33eBZXigdcgKaaUqGdBVsKFYHtKuZPviRzPeIw9xWJKmRIvn2JKyTyPUDWwtyapbWiNkh9R8f4I55BRqlKxG6WM4CwmiPKlXOV7NN8Vh8dmyordIE6+R45SFrqk2Bl+kymhkViRApjyPT2/p5Qs+V48veMN+5h5D7D6lZdNurSYUoI2PrK8Q6JBNko56Ap2byqRc7ks+V6pa6lSnlG/UHVdmNmXRMYnS19fsfaQDXv+ySilDmSUqlQyjFLku0jIx8pM4vwzqmY+sy+GVJT9qIRfWX/ssKKEyPdY1iuySpmYG3EVLTkuyJDQKPhd7DGl7Oimp5Qk+V6SeUr5+0xoJTzXTZI8pbzI0r3gxtDiJzUBDnTuzFNKzlyeOfb4X2aOfM/M3ljaNUp5Rv3CkrJKq0Je7G0rQwqq2DJZOiGS7ymHYo8sIYxWnaz/J4NzwkWUL16C2PKQfvkByfecE3T5HgURzaVc5HuZadnV+y6FjFIRydn3WCyrsM+7wlK8jmQFOtdEeUqZG0/RnlIBjCnlwpNGVpYu+6PLRb6XVaTf2fdIvpeLlrEuFHddWqPkh+R76kFGqUpl90OAc59L/Z8eSEIBvASxtQI4qjXZ2r1+gu4twhtzg+CrpxTzuhMg31PUW08musD250kxuYsKNBUwSrFYTtIDnfs8LlvSIPeflRboXJBEhHkYk3yvZdx4BdnbU+RczmPsKSYJNOWfJT6zugIbfVOupvK6UKSB00Vg/0rC9KhXcG6vVMgoVcmE0oszku8RCuDlhE3V2AGZwVHl1SMIWBsE/+V7ImNKKdYFpSLSU40n9sWqii7+TQViSjFPKVkSGlO+57unVOqnl02ELE8pUafxsryGWXsGy1PKm3xP5OPEQzps74PZZfol8VLBSzbpwugoEllB81X1HJNNSIH4Z0QmZJSqZDSmlwrOYoIoX6yNbPDle5lu2jThFSPJ4R6KlBAkFfXWk4kZQDTgFlnl5XuJQjGlmKeUJKMUk+/5HlPKu4FHVqBzs86iYkpJy76noNW2AG6kamrI93wq0x5KNqtMvw74VJLvqXdYKVu+J+6aQUCFvkpkQkapSmXB68DLFwG9hwKj3pddG4IwN7Ku5HsKB5m2AtzSjFcMHlmjRLa9rKxXKiNSPskTe/9R0ihlyvcyvX/CZkwpyYHO/c6+V4KBp1FWoHNBEhGm1BQ9FzIjXyDlew7aStM0y/NW4Fye4dXkU99JFPGU8k2+p8C6J+GTgc1vMoLmS+hLJN/LxEvIEIIvZJSqVIwkAHoQCXXwInNQVb4H2CVkcuuhOpb8zb97KFJCYPVB7pcKDOVyApkZg0ViRQrAjFLVBQKdS5fv+ZwKrhQpnKyYUl48gL0gyxuiJoAxpdy2lYzxrFj8J68Ui1PlV/8RKZ0vhKqeQfb6iJSMMSM+yfcyUaGvEpmQUapSYXGkNOoChBp4CWKr6uIDEJd1KejwuIfmaa1A+R4t+Cz0MonVoLx8L54yBBSW78kKdJ66bsRnT6lQCUHD5ceU4nsdQ5I3RDWLKdUcHKMU6z5O2yoUEj+XZ4w9Pj3GxSSBVhymEuV7AufeQphhHRRbGGYGOhd3XcubW9w1g0ApiTMIPpBFolJJphcQSz4C3v+d3LoQBLwFsfVrIcUDnVyDHWFmr+OQfY+3hMAwDNcbnEqAPY5B7/sZ8j0FvwuLKVWdHeg83RfjkmJKsVhWfj8TltzC/WdlxZTyIkv3QkKSN4SZfS8enJhSVlBvh0YpCeMZD+lwRvD0HE+p1E+/YkrJHPt5JE/xA02yfE+19pCNCn2VyISMUpWKPePej9OkVYMgGF48i4Ig36NTmOIEWb5nX8uQTcqC5HtisGJKZS7lWNa7mDT5XjKjHn5RihSuQVJMKVHZ92TL94LkKeVVvidyLpcn3yvVKJV7LdEEY10o3utOxfaQiQqZIolMyChVqdiNUpR9j1AAL0FsE5IkC05gruNBD/bMGx5BOE0vNe7Bha3yVZMKyESXIHfhgd2mo+JpamGjFDsBluO9wtrKb/meXoJ8r0lSTClREhFZCReY51lTPDjrSLdtJWo+sZMpHeZfppVFtrRrqJDkwpKySqtCQXQJ60IrsL+wSwaCclmnlBPURSsVuyHKCI7bNVG+eDlRNiSdDjtB1Al50LEkmP6VGRK8EQToFNKOeQKpoCHHDQkO3gp+0sSMUlm7r7Ai8j2/A51rJcgtTE+pKrFGqVLq7AZZse2C6SmV+ul0zJbhUWHvL36No8XKZPZrv+R7Mod+t/JMkWgS2ofke/lRoa8SmZBRqlJpsxsQjqb+T0YpQgG8LPxUziqight7EODhWi4qq4q9eBUNo7Iol8We/dlV8TFuKuQppUig8zCnmFJe7oUZUyosWr6X+ilKSix642nFlAqSUYoZLZy93zrkEDcIFJPaeaWYJNA3+V56KCL5Xn5CEg5sDIXbQyblcnhWTpBRqlLZZwRw0Rup/yeDs5ggyhfTrblM5Htevk8lwuMUT1QAywR5SuVFLxMvQftiVUUZLgt0nm2UYrK5uKTFNotlFfZbvuexXxmGYWXfqxK77NVLMKS5wUoYwfc62ZhGqVhwJrpE0t26wUpawq1KOfCQ7xlFyvRdvidxo2+FBJBWhYLImBst+R6tUezIkOUSxVHwkSWEobEjjeAsJojyxUsQW5Xle14Ct1cifi2G7YgKTEvyvfyI8g7hTSJjE6fed2kp0Lks+V4iwSfQuZnV0eW9aE4kzbFAdEwpTdDGR5ZEh8WUCpJ8z63niIy5PEM67Jd8r0CZhmH4nn1PpvOJynI1Ge0jKwmC6shIYEAUh4xSlUwovTgjoxShAF6C2PLI3OYX5bIx5w0PV3tRASztQyct+CxCZRJAVHX5XnNLMaUkBTpnHloRnx8K67l297nGZqsdxGffS/0UJt8TPBCxGF1BDHTutK1KCbDvFZHyPXvxpQbKVyF4tNJhHSS0D7uU6CQIqlMu65RygoxSlcrsvwL/73Sg37nAtZ/Lrg1BeAoIa7rhKzjZeskmWImYruU+3kPTo0KgfE9FCaksQhLkLjyw9x+Vs+9VZxlamGxOdqBz3edA56aXgct7weId6SENEcGaHnOTznss4pAwwgksRleQPKXctlVIwlye4CAdLiRH9lOGLiNmUjZmWAcF14Uy2oe1h4pGOpmEBK0TCeeQUapSiTcCsR1AKAxEamTXhiA8udLykH75Bcn3nMHDtVyUi7z93tKCz6JcgvxnxnVR77uwmFLVOZ5SagQ6j/gcU8qr1xEzmIj2kgLEjUWWlF2Op1RjPBmY592tfE9GJl0eMaXs5RgFxjatxLWUjOxy2agc1oHke+pA8j31UHArRwiB6U5KnYEIwie8BIBUOatISILLfxDhcQ+ZdwLvTRIt9vJTLm7xhSQuqlAophQzBsk6AWbyPb8DnYe8yvfSnlIs/pFIvGSV9YK07HtpT6lE0jA95FTHbcwhGXN55tjDQb6XzD+2lSzfU+AwTumwDhLmRtYe5M2dSbmsU8oJ6RaJ8ePHo3fv3ohGozj00EMxY8aMou9/6aWX0L9/f9TW1qJbt2647LLLsGHDBkG1LSNYxr2v/g5MvlVuXQgC3oLY8pB++YUKi7Mg4DYTkhNCHvqSF5icgxZ7mZSLfC8ZEPletlGK9ceYNKNUOtA5J/ke4E7+wjylRAc5B+xZWMVIiYUbpWzZDBsDElcq4fIwQYqnFIexp6B8z/Z6yfI9BQ7jeKwp/EKGZCyp8DpZJiTfUw+pRqmXX34ZN954I+666y7MmzcPQ4YMwcknn4zly5fnff8nn3yCiy++GKNGjcLChQvx6quv4osvvsAVV1whuOZlgD1C74L/k1cPgkjj5RScsqwEH3YP/byFpoSAc+NbdVev/8mE5HtiaErkD3QeMbPvyZLvpT2lfN4U2otzcz8aY6l2kGGUEiURkSVZqtJD5tjdGJC4Um69yuRIrvL/n0eZmTL00q4hau4tRhDkeyKnEx5rrHKA1ujqIdUo9Yc//AGjRo3CFVdcgf333x+PP/44evTogQkTJuR9/2effYZevXrh+uuvR+/evTF48GD8+te/xpw5cwTXvAywj4hGMBYSRHmje1jMsMlWcOxaR4QEnZAHHTMzjI8rSF3QYkPlQPsyMT2lFDTkuKFQtipVaIql5u5sT6mwzcAvY3PIZFxhnwdme7Y0N19LpnxPlJeN6TUseCeuaZoZq4sZ/1Qn6dKTRop3S1Z/8cPAX0gSaP9apc7Dujn2l1RMScjKROkEGXOjyp5jMiE1g3pI28o1Nzdj7ty5GDFiRMbrI0aMwKxZs/J+5qijjsLKlSsxefJkGIaBn3/+Ga+99hpOOeUUEVUuL+yGKCMYCwmivPESxFbp2AGCYokEHR6yE1EbQSseFtfLBI5yOYFMFti4qQILdJ5jlLIZg+ISKp5I8gp0bjdKufCUkhroPPWTu5RYYnxF5oHWEAvGAadbzxE5gc4zr+WHQcxepr08u+Har+x7Mr1kVQ7rIEPeqHLsVZmIivdHOCcs68Lr169HIpFAly5dMl7v0qUL1qxZk/czRx11FF566SWcf/75aGxsRDwex+mnn46nnnqq4HWamprQ1NRk/r5161YAQCwWQywW8+GbyIHV3et30Fp1hd6qM7Qda2EYScQD3BYqU+p9qiQSiTiA1OLaaXuxzY+RSLhuY973hk3/sVic7n8R2IIgEc/fTl7uk9WXDK5t35wuW9O0irvHxe6LkT7oSHh4LlUibouRk0zy7UteaE4bAUJIZtTNSPd/AGhoagYgdg5qSreb5vPzl4hb36upuRm6wyXsjsZUG1TpIQn3MDW+xePFn4VS56NEItXmhiH+mYumjaLbG5oQi0WFXtsLMfZc2/pnsfaXMZfHsuJzNTXHYIRL8yOwG6LitrG5yfadEvEYkqUYL9LzeayF/u4VJ89JMr0uTCo4/0jpS2w+MJLcrhnEvY6WHpsraY2e7z6p9N2lGaUY2R4OhmEU9HpYtGgRrr/+etxzzz048cQTUV9fj1tuuQWjR4/Gs88+m/czDz74IMaNG5fz+vvvv4/a2trSv4BkpkyZ4vGTu6K2560Yvui3SMSaMXnyZF/rRWTi/T5VDttjABuS3v7PZEfeJxs36gA0fPnlXDQt9XbawevebN+Wqttnn8/G5m/pJCYfhgEYRuqef/ThVLSOFH6vm/u0qQkAwojFE1zHtp8bUtdJxmMVO4bmuy+L12gAdKxaXY/Jk1eJr5RPfPdTCMyhvKlZvXly647UGPPFZ7NQ/7X1eir+eeq5mjL1Q9SGxc5BS5el2u3HH77D5MZvfSs3Zvte7777PqIOV7Bf/Jzqj1s3rhN+D1etSLXFN99+i8k7vmnx/V7v0/KVqet89803mLx1sacyvBJvSvXDaTNmYmU7oZf2xMLVqf6wpn41Jk9emfG3fO2/Y7v4uXxBfaqOjMnvvIuqEh39mtL3CQB++GEJJsd/AABsbQaAMDQYeOedd0q6xurVqX64aPFiTN66qKSyilHsOdm8NfU953wxG1u/U2vt1bgzVbeZs2ZhzQIx11y0KtWXVq9ahcmTV3C9VpD2Ohs3pvrql/PmI7RynuzqCMV+n3bu3CmxJplIM0p17NgRuq7neEWtXbs2x3uK8eCDD+Loo4/GLbfcAgA46KCD0KpVKwwZMgQPPPAAunXrlvOZO+64A2PGjDF/37p1K3r06IERI0agbdu2Pn4jscRiMUyZMgXDhw9HJFJkJ1eMLSuARYAeCqGurs7fChIAfLpPFcLmnTHcNecjAMBJJ53kKB7JX3/6DNixFYcfNhBD9+nk6nq8781ffvoUq3Zuw8DDDsMxe3f0vfxyIJE0gM9Sk+Pw4Sdg19qqnPd4uU9rtjZi7JcfQ9NCqKs70dc62/lh7XZg/ixUV1ehru5YbtdRkWL3ZfPsFXht6WJ07tIVdXUHy6mgD3z93nfA6mUAgFA4zLUveeHe+R8BsRiOG3oM9urc2nw9mTRw8+ep5+qYoUMxZ+Z0oXPQtP/7GlhXj74H7Ie6wb19K7c5nsRvP/8AAHDC8OFoW+Ps+6z99CdgybfYo/tuqKs7yLf6OOGzNxdh1tqV2GuvfVB3XJ+C7yt1Ppryyn+B9WtwwAEHoO6onqVU2TXPLPsUa+u34eCBhwdirlv1yVLgp+/Ro/vuqKs7EEDx9n9mmfi5fM3MZcCy78zfR5w4ArVVpW3ZfjfvQyDtNdOrd2/UnbwvAODnrY3A3I8RCpU+X87410LMXrcK++yzL+qG7llSWflw8pw8+cNMoGEHBh15BI7o3d73OpTCE9/PxNrGHTj8iCOF1e2n6UuA5T9gjz16oK6uL5drBHGv8+q6ufhuywYc1L8/6g7eTXZ1hJDvPjEFmQpIM0pVVVXh0EMPxZQpU3DWWWeZr0+ZMgVnnHFG3s/s3LkT4XBmlXU9dXRQSL9cXV2N6urqnNcjkUhgHpxilPQ9IqkNoGYky6ItVKZc+htP7I+pHo4g4sBVnT31pbQvr3ujp4MHhEI63ftC2LKDVUeqiraTm/tUXZWSPiQNg2vb6+n5KKRpFXuP892Xqkh6ng54u9i9tg0Dyn0XFlOqVbQ6p26allbShFL3QuQclDBS7Vbt8zVDurXO08Nhx2WzpHCtqp1/xi/C6TUqQiFH1/Z8n9J9tSosfr6pSRtLYkn1npF8aFrqnoT13LbK1/7sgEzkXK6FMtc/ejiCSKS0LVvGNkmz+qMeThmqdB/Ga7Zu0xz2d8/XKfKcmOtCF2OEKMLpOHuhPH2PF5oWSl+b/zWDtNdhz7VWgWt0+31S6btLzVk1ZswY/O1vf8PEiROxePFi3HTTTVi+fDlGjx4NIOXldPHFF5vvP+200/D6669jwoQJWLJkCWbOnInrr78ehx9+OHbbrTKsnL4x7SHgmaHA4VcBY/i52BKEU7wEsVU5+5mZZUXFCMmKYG+bkI+zkT3QNs+Aq7IyXqmOGeQ/4H3fZjNV8jlujucPdA4AkfQDFU+IT2QST8d0Cfv8XNiLc3M/WJbCqIRA5yzjFe9ngc2ZMsaiwGXfc5lcQ5Mwl2c/tn5cOyO4eZ6g534so6y2Kr0sr7jNrigSc20isH2sZDLirhkErHuh3txeqUiNKXX++edjw4YNuO+++1BfX49+/fph8uTJ6Nkz5XpcX1+P5cuXm++/9NJLsW3bNjz99NO4+eabscsuu+C4447DQw89JOsrBJemrcDO9UCkFmilvrs1Uf7YJ0ynRimVs59R9r2WsTcNj+x77Bq8bJZJWuzlRZOQrYoHmSnUJVYkD8mkYWbWy2eUCusamhNATMKCO5bOBx/2OfuelnFw4fxzLCucjOx7ojI8sU2ujEy00Uiq/wUm+555mODs/TLm8uxr+XG4kplNNHds82MOVmHdo3JWZhlzo8zMnCqjQl8lMpEe6Pyaa67BNddck/dvkyZNynntuuuuw3XXXce5VhWAwVYwUp3lCMLEPmE6PRVkJ0AqLj5kpJEOGva28XPBZPecSxgGQuDTP9hGkBZ7mbD2TwS869s3ggnFnuNmmytCXqNUesWdkHAT2Pgd8dP9MY0e0pBIGq426cyDp1qCUcrutckT1j9leA1Xm55SwTBKJVx6SukS5vLs/u1H/7EXmc9A5YdnkYy2ykblwyIWKlXkfKKy55hMTDWDYnN7JUMWiUolmV48fPIH4O0xYn1JCSIPIQ+n4H4upvyGySjIM7gw9sWAn/tXu62d5+LYrQykUmD3kqd0UgSJAp4FKtBkk0pV5UkKweJlxCXM7bG0wcxvTynA2mi62UjI9JQy5Xuc+48hcSPO2jUwnlIuPUdEGRbtcJHvZUj2csv2U74n1SilsBGG9SWRc2PS8O/+lhMynmuiOGSUqlQM24w059nM3wlCAvb1g9MJm+R7wcY+7PCU7/HCiuPC7xpBpFy8BO2LVYNzfDK3NCUsA0Akj/GHeUrFJHhKxRP8NoWah41EoxlTSvyDasr3uMeUSv2UYSBn7RqUmFJuDXiiJJh2eMv3jAyDe+qnP/I9+Rt9leVq5vgl8FFRuT1kUi6HZ+UELaUrlWwjlBGMEy6ifLFvYBzL9xQONM2+j4oBklXBvkj2U3aSId/j2P6mpx4t9jIolyD/PCQ0fmEPcp5PvhwxPaUkGKXSO65IHg+uUjHlQS6+V6NMTylR8j2JcyFr16aAeEq5bSsZc7nfY49hGAXle+xavsj30o+8zODRKnsws/MDofI9hRUFMimXdUo5QUapSiXbCEWeUoRkvASxVXnxYblpS66IwtgXZn7eQntZfOV7qZ8q9j+ZqHBa7gfZi1WVPL+YUaq6gOGHSedkLLiZIczv7HuANw9U5sEjI/ueKK9BmXF0ohUi3xP5+GcbLUo1YmQPAxnyPR/7jgpesip7MEuR7/kozywnymWdUk4o+MgSQmjbHeiwt/U7GaUIBWAnOeUg31MhtoLq2GMd+Bms3n4iyHPBQYu9/Ohl4haf3XdUepZZoPN8Qc4B6xmIScjNzuR7PDylvMTqazDlezKMUqmf/GNKpX7K8IaIBizQuVvPoJCguGB2csaeEieyYnJAPxN2qBBLU+XDIhntw65FHt2ZuN1vEPwho1SlMvQWYPQn1u/JYCwmiPLGbRBb0w1fwcnWdNOmY5iCsMWw34uljKD5HNs/QW7xedHKxC0+u++olA/E9JQqYJRime9kyPeYIYzHc+FFciEzplRIkPTLClYtzyjVEJCYUm4De4ckzOU5Y0+JG+fsuudL4uBPTKn81xOJyutCKX1JYUWBTDQF+iqRCRmlKpmQ7dSQPKUIBXAbxFblyZbkey3D6/7Z98I8T7cNhU9kZVIubvHZfUcpT6l4cU8pJt+Ly/CUYvI9jtn33Jxuy8y+J+pZkCnfqwmYp1QQ5Hu5Y09p5WXX3V6en31HhjwtG5nPQkvIkDeq3B4yKZd1SjlBRqlKxp43nYxShAK4DWKrcuwA01tEoY2savBKVaxpmnUKxrH9ZXonqIwZ7DbgfT8nDotC36dlo5Q8Tyn2XHAJdO5B/tIkNaZU6ifvTbrMpAtW9r2gGKXctVVIwlzut3S4mIHdNNL5YLWQ0VbZqHxYpEuQgqqcEEgmugQDIVGcsOwKEJJ49w7g28nAMbcCh1wERNvJrhFBuI6/obJWvlw25jwx5XucZD6JrIxDfmNlteF3jSBSLvHUsjdWKp3dNLUQU4oFGWfxnUTC5Hs8Ap17kYaanlJVEoxSguR7rHgZBvLgeUq58xwRFRfMTk6ShRL7T/ZYZi/PT7mbCt4n7PuoKKs350aBc4nKMbZkElIgUySRCRmlKpXtPwOblgG17YFd9pBdG4IA4H5BY3naqDfZqrA4Ux2e8suQBiTAdyOh8omsTEISFt48yE3Lrs7DzLx/qgpl32NGqaQB0b2TGcLCHFxYvWXfS8eUCpN8jwfBy77nbt0gYy7PHXtKLC9rLLY/P4aPfUeUZ2AxeHlg+4EMA6ef97eccBsuhOAPne9WKiywuSZ+kUYQhXB7qqzyiZiZZYVmvILw3Eh5CYjsFpUDqsqkXNzis41qSsn3WvCUYtI5OTGl0p5SHGJKsb7l9FYYhiE10LlVX86eUhLnQiv7XjCs0AmXHrq6hLmcv3wv9/++yPcEeQYWQ2YmypaQMTeSfC8/ugJSUyITMkpVKuzY5KMHgPd/BzRsllodggDcn7JZniqcKlQCMgJaBg0rJhi/LF0i5Hsq9j+ZyDgN5kGO5EWh72PFlMp/sKTbPKVEw64Z4WCUchurrzmRNDfdUQnyPRGx7QC5Eh1m7GtoDoanlFvPEU3CeJbdX0o18lSUfE/hBDgyvHNIvpcfFbz6iEzIKFWpMKNU4xZg1lNA0za59SEIeJfvqTjZWhtzufVQGZ6LJRGGEVrs5adc3OKzF6sqrV1No1QB+R4zCEkxSiWY1w4H+Z7LWH12751KkO/JGIpYrK6meDCMUkGU75U69hQLdM5DvifTgE/yvUxIvpefcol9WU64jinV1NSE2bNnY9myZdi5cyc6deqEAQMGoHfv3jzqR/AiW2BuBGMxQZQ3XuV7Krolu80kWIlwjSklQEbA09MryMiQu/AgJ/ueQt+nOW0AqC4Y6FyefI9noHO34yqT7ukhjYvnVkuIyrYlU8rOjH1B8ZQKhHyvSAwoL2R/PK98z4d5WPbYb9iSm6iZAEd8+6jsOSYT3VwjSq4IYeLYKDVr1iw89dRTeOONN9Dc3IxddtkFNTU12LhxI5qamrDnnnviqquuwujRo9GmTRuedSb8IMcoRU8lIR+3p0gqy/foFKZlLNmA/2WLON0m+V5+VDgt94OcDFgKfR8WU6qgUUqipxRrtwiHtJRun2sryHlISkIM81ngfB9kJl1gnlKN8SQMw1Ay8YidQMr3Srx2sbHMT6OFbC9Z+3VVNMLI8Lojj+78kHxPPRytGM444wyce+652H333fHee+9h27Zt2LBhA1auXImdO3fi+++/x+9+9ztMnToV++yzD6ZMmcK73kSptOkKtO9j/R70NElEWeA2iC3J94INz40UOwXjueCgxV5+zCD/Ae/72ZtQldauVkyplrPvicQwDPOaPAKdh1x6HrGMcDUS4kkB4g4nZM6FzFMqkTQQSyj0kBTAbVvpUgwJ2WOP34HOjZz/++Flp0s+kLBfV8V52e345Qd+3t9yQsa9IIrjyFNqxIgRePXVV1FVVZX373vuuSf23HNPXHLJJVi4cCFWr17tayUJDpz2ROrn//YEGjeTpxShBG6D2KrslixKthFkeEpOWJE8AwzLzHilMiIyH4og+9lV6fu0aJQys++JrbPdCMZDvufW84jFlKqWEE8KECcRseZCvtfJR7TK6oON8UTBPqkK7JFwum6QkbQku3+X2n9yMonayk/66LEse6Nv/14cQtqVjLkuESoFJY/ufFjrFMkVIUwcGaWuvfZaxwX27dsXffv29VwhQjBaetSmmFKEArgJYmuPHaDiZKu5jH1SifAMSGq1v/9lM9wGzK0UysUt3u+4Ln7SlHAW6DwmeMVtN4KFFZDvsThHsjylRD0L5lwoYTKs0kPQtFQdGpsTaBuNCK+DG9zKrs11iUhDQk4MKL89pXL/78c8JmLeLYb9a6p4WCkiK3A2tE7JT7mEGSgnXAc6Z8yZMweLFy+GpmnYb7/9MHDgQD/rRYgilF6okacUoQBugtiqHzsg9ZN3KvAgw1P+pgs43eYZEyvIhFx6PKpKMcmLbFqW76VeF+3dFbftRvl4Srl7rhvTAeGjETluE6Lke9ZYJH4w0jQN0bCOhlgiI9uhqrj1cJUxnvk99hSTA/or35M79isv35PQPm4D+1cKItaIhDtcG6VWrlyJX/7yl5g5cyZ22WUXAMDmzZtx1FFH4R//+Ad69Ojhdx0JHrxxLbB6HjDkZmDPY4Fde8muEUG4OgXPWHwoONnqZRJXhyc8Yx2IOAVTOcuPTGQEc+VBMe8C2TS1YJRiz5TomFJ2Tykugc7TRTrd1DUyT6mIJPmeuQnlex3ZSRdqqtJGqbj6XvduPUfkBKfOGntKle8VkSL7Kt+T7CWbyFgXSqlCUWR457gN7F8pUDIi9XD9yF5++eWIxWJYvHgxNm7ciI0bN2Lx4sUwDAOjRo3iUUeCB5uWAmsXpgKed94PiERl14ggXGW5yTwR41Uj71hu2jThFYIthrnK9zg2P7nF54dtBoLe9/2W0PhJS55SsuR7MdvumWdWTad9y/KUkiTfE/QsyMy+B6SyGwKWXFJl3HroyjC0+C0dzh3Lcv/vxzwm+0DCLvpQ2VOK5Hvykd1XiVxce0rNmDEDs2bNwr777mu+tu++++Kpp57C0Ucf7WvlCI6wkVuTs1AjiHyY3kVO5Hu2xYeKbsnlEuyZJ6xpeHgaWQGGOcr3TE8vbpcIJHqZ9P1ABDov0PnMQOeSPKUiusZlE2RuJBza2hqaU2+UZpQSLN+TNRdG0zG7GmMBMEol3Y3bIQFzSTZS5Ht+GKUktJUd+/dU0YNZRvskOK6zgowuIVYcURzXS+k99tgDsVgs5/V4PI7dd9/dl0oRAkimFw6z/wJ89D/AllVy60MQKEG+p+Bka7lpy62HyvBMYy7idJtnTKwgI8JLTQTZi1WFHKVMo1R1IU8pSZtDdr0wJ+2M21h9zEgi2yjF+z7wTBrhhGg6u2FDEIxSQZTvlTj4ZPe/RB6jlB+PrOzg0fbvpeK0LFW+R4dnGZB8Tz1cd9GHH34Y1113HebMmWN29Dlz5uCGG27Ao48+6nsFCU4wT6llM4DpDwFbV8utD0HA3alyUvXFR4jkey3BcyMVEhDTy+BoVAsyVjy1YPd9peV7iZZiSqVej/EOZpQFkwuGdT7PhO5yXGVGkhpJgc5FGTRMr1NJnlI1pqdUAAKdu/Qccdvn/CBn7CmxWbOrbi/Pz8Mhq61KLsoT9jWFinI1GbFGeR7+BRmK+6oeruV7l156KXbu3IkjjjgC4XDq4/F4HOFwGJdffjkuv/xy870bN270r6aEvxiJ4r8ThATcBLHNkO8pONmSfK9leEpORLS/mfFKQfmoTMzT4ID3/RzvAoW+j+Upld8DiBmF4oJzs8dNTyk+z4RmPtfO3t8k2VNKlERE9saTZTcMhHzPpecIa1Khkqsink1+lGc3sLNnyY++o0le97DhTsU1IWCXH4vvS2SUyqRc1inlhGuj1OOPP86hGoRwjGTx3wlCAm6C2JJ8L/jwDM4rVr7H7RKBpFwCiKqcfc9poPO4NE8pvvI9p15rlqeUHKOUKImI9Ox7kQDFlHJpwFNBvlfqPFZMDuhn35Et35NtnG0JN8l8/ILCDORHVLw/wjmujVKXXHIJj3oQoqntCLTpBmyrT/2eVH8hQZQ/IRen4OrHDqAJryV4bqTMvsTTKEUnkHkxg7kGvO/nSF4U+j5NiRYCnYfkBDpnp/IRTtYRt9JQJierlh7onO91ZHtDsPYNQkwpt22lS5jLc8ee0sorln2PGbz88FiW0VZ2ZMdWawldwLokG7eB/SsFa40ouSKEiWOj1PLly/O+3q5dO7Rr1863ChGCuOj11M8/HQmsW0yeUoQSuDllsxs0VIwdECqTuDo84Sl/E7EZVP1UVhYyUqjzIHvjoJKbf0ueUqZ8z6nOzSdYDCt+nlLuxtUGU74nZ0dmyvc4Pws8vU6dYHlKqb+WdOs5IsP7x2/pcI6nlK08NkT4sY6SneTClO8p6r4ckhBzy21g/0pBtlcfkYtjo1SvXr0KduhOnTrh1ltvxZgxY3yrGCEILb1iophShAK4ke/JXoS3BE14LcPTrTwkYDNI8r38kHyPP03x1Jxd0CglyVOKGcF4x5RyGiqrseLke3JjSgXBU8qwHWg5QUaWLr+z72Ub1Em+JwdTvidwXCb5Xn4oGZF6ODZKzZs3L+/rmzdvxuzZs/H73/8etbW1GD16tG+VIwTAdm7kKUUogCn7cSLfU1w65UaKWKm43Ry4wZQRcFz8qb4AlkW5BPlXWb7n3FNKsFGKBTrnlX3P5aa3UXKg85BLI5pXLK9TvtcpBDP6NQXAKOXWQ1d3sS7xi+zuXerQI0y+F+I/7xaD5Hu5JM37K+ySgaBc1inlhGOjVP/+/Qv+bejQoejWrRseffRRMkoFhVcuAbauBo66HujQB+iwl+waEYQ3+Z6iE62MNNJBI8HRqCNCRpDkKD8MMvbmMAwjsLKBYhmrZGMapQrGlGLZ9yQZpTgNzG7le0xOJstTSlSMHdmew9EAxZTyKt8TOZdnGy38lu8lMuR7/sm7ZHvJJn00sPHAUgOIuybJ9/Iju68Sufi2ajjqqKOwZMkSv4ojeFP/FbByNrDLHsDuhwJRigtGyMdNEFvZi/CWkJFlJWjwdCt3GxDZCyTfy499QxDkBZ/K8r3mtNtGdUFPKSbfE+uqyeR7EU6eUlasPmfvb5QcU0qUnEn2ZjwaoOx7hkvPERnxIX2X7xXJ5seeJd0Po5TkWJqqS9Wk9CUWZ0vRNpEFe/7p4FgdfJulN23ahF122cWv4gjeMLmeJuf0kCDy4eYUnJ3uqTrR6iTfaxE/ZQPZmJtBjpaEhOKnsrKwn8gG2TU+R76n0HdpSb7Hst+Jlu+xQOe8nglWrNN+1SBbvufSiOaVhOkNwfc6hbA8pdSf8BIuPUdkSPGz+wtP+R6PmFKyxn3VJfUy2kf1NpGFRvI95fDFKNXc3IyHH34YRx55pB/FESJgM9zCfwGfPA6s/0FqdQgCcBfEVvXYAW6CtlcqlmzA/7JFyPcMWuzlxb65CbKnYMKUoqmXSZMZparD+Y0tlqeU2DqbbcY5+57TcVWdmFL87oNhGNI9h2sC5CnF1hcqy/eSWWNPqTGIipXnp9FChjzNjhVrVM71W0KGZMxPo2M5QfI99XAcU+rss8/O+/qWLVuwYMEChMNhzJgxw7eKEZxh2fbmTATiDUD73kBHiitFyMVNEFvTTVvRmZbkey3DVb4nIJaL6oZRWdi9ZILc/dn9Desa4klDmcVrMmmYxqbC2fdYTCnB8r2kavI9uTGlRMj37EXL8hxm8shAGKWYh6tLTykZ8j1r7PFHvsfKyyff82MtJaOt7Mg2zraEjFijqq+VZaELyNBMuMOxUapdu/wxh3r06IFzzz0Xv/rVr9C2bVvfKkZwhsn3QuHM3wlCIm4WNG4XlqIxM/bQfFcQdnrLRb4nYMGRoFgNebFvCERmGfIb1ncioRAakVTGzb/ZpiNSLfueJd/j6ynl9F5I95TyydOlGPayyVOqZdx6jph9TuCjxPo3G3tK9bTLLi9foHNf5XuSxv0ExzWFH7DHU6h8T/FM1bKQbUAlcnFslHruued41oMQDTNC6ekukFR/IUGUP24kV6pnFKEJr2V4upWLaH9TvqfoAlgW9kcyyP3fDACsqyXFbYrbjFIFs++lXo8JNkqZgc45x5Ry2q9YTCl5nlLOJelesbeFJikbbRCz7zmPKcU+J+5ZMrLGnlJtGNljmb08P2XoIdMTqOSiPKG69zLJ99TBTbgQQgyOjVJEmVHdFog3Anp16ndFFttEZcP2V05OkdSPHZD6qVJwZNVwuzlwg4jgtDxjYgUZu+dYkPu/KXlJG3hU8fpqthmlCsnk2OuivbuYrDDMSb7H+paTW2EYhjLZ93gaNO2bKnnyPeYppf4Oz62HrpnJVUJwajb2lGoQM4qUx0O+Jy/QeWY9VENEWIFsEnR4lhczGZEi8zrhMdD5Nddcg/Xr1+f8nwgQ180Bbl8OdN4/9TvJ9wgFcBPE1jxJVHSilZ0aOQiY2eu4GKVSP/nGlEr9JPleJvYNQYBtUpbkxSdvBb9oiqcMLVXhUEGDri4rplTaCswr0LnmYiPRnEia9yxaJddTiufGxz7GydqMBzGmlNOlgybRkOCXcTm7vCRn+Z6sdY8Z1kHRdaGMWKNuA/tXCjISGBDF8bRqePHFF7F169ac/xMBhPl6G+ovJIjyx41rs+ppbimzR8tY8jf/yxaR/VD1PiiLcpHvZRu+VVm8mpn3ihh+Iiz7nmj5XlaWL79xs+m1e+1EC2Qp5I2IeSBDvidpKIoGKqZU6qdz+Z74uTx37CmtvGRWedzke5Kz7yUV916W05fUVhXIQkSGZsIdnrYC9oWZKos0wiOh9EKNPKUIBTCDwrqR70mKodESpps2zXgF4RmA0+pLvhdtYhqlaLWXgaZpZSFfNQOdpw08qgU6LxTkHLDkczHBnlIshlWY08DsZpPODCR6SOOWDbAlRBg0M+R7ksaimgDJ99wGwzazdEmQ77Gxxy/5Xr7y/JS86S7WcDxQ3XtZhhQ0QYdneZHdV4lcKKZUpfLSeUC8CTjq+tS/jvvIrhFBuDoFVz12gAw37aCR4HgPxcj36ASyECFNQ9IwAn0Kmcjy+lHluzBPqaJGqZAcQ1oibSHhZQQy5XsOvpcZT6qIzJE3ZjYyjvdBDflecAKdu/UckSLfyxp7SpV/5o5lNvmej0YL2ese1b2XZcgbVV8ry4Lke+pBRqlKZekMIN4AnP4ksGsv2bUhCADug9gC6k60JN9rGZ5u5UI8FGixV5BQSAOSRqCNsqzqYZ+8FfzCmVEqHVNKsHzP9JTiFeicea04uBdm5j1J8aQAMRKRTKMUv+sUg3lKJZIGYomk6ZGjIm7HbV2ifI+NPX7J96yxzP435jlW2jVSZchd9yiffU9CrFHDvL+KNookQoodNhEe5XtEGcDkepq8xRpBZOMmiK3q2fd0CYuPoMFT/ubGo8IrbrM4VRIiPER4Y0lo1JLimjGlHMn3RMeUSgc65yTfC7mQRTMpWbWkeFKAmHkgYduIy/IIq7ZlN1TdW8qtZ1DIhSHUL/wee7LLs4/LfsroQxK8yuxkx85SDRFZgbNRfa0sC9mZIolcyFOqUmFGqSXTgHgjsMcgoGs/qVUiCJLvVRYJjllhRAYYVrQLSkV2wFs/SGSdMKuydm1yEFPKCnQuOvse70Dnzu9FQ7N8TykRsdUMBebC6nAImpaqS2MsgbbRiLS6tITbBBsyDC3Zca9Kle/lO0AxDAOaprkO/F4M6dn3OMap9AMZkjE/7285IbuvErmUfJRFnTygsGx78/8OTP4t8NNMufUhCLgLAql+7AA6hWkJnjGZdAELDp5GtaCju/B6VBHDMMzNfoTFZ1Lku5jyvSJ6G3scLJFDkJl9j5N8y42BoDGejikVkScKEGEcNw0YEschTdPMDIeNzWoHO3fbXjLm8mTW2FPqpbPLs7/mp3xP9rpH9TiPIQnzInl050eX7NVH5FLyEEQBwgIK85Si7HuEQriJv6F65jPVvCtUhOdiScTpthmrgYxSOQTdU9D+3DIpnCrrHTeBzgHBRqkE30DnpizUiVGqmQU6l+gp5ZOnSzFU8dhkHmnMGKgqbj1HZMSHZPc07JN8L5FVHmAZjnjI92QNlVZWZjXnZJl9SdEmkYaIeH+EOzzJ9xYtWoTdd9/d/P9uu+3ma6UIzthnCz3tYk1GKUIBvMn3OFaoBCizR8vwdCsXGWBY9mZQRdimIKj93z4GyUjjXYwm0yhV2NiSsfkUWO0Y51N5q1+1/F5mHFFBvsfzOVBBvgekshwClmxSVdxu0uVIrrKlw6VdO1+wa1amv/I9NWJKyX4WCsHOCmTI91RtE1mQfE89PBmlevTokff/REAwkoBenfoZShulkmovIojKwJV8T/HYASICbQcdrvK99OKPZ/snaLFXEFO+F9DzDvtClcVnEpzIriCO5HuSjFKWp5T8QOcNzfIDnQuV70k+oYkyTynFA5279dA1vd1EyveSLDC5T/K9rPIAy5iZ9NHjNyRg3i0Gz4y+fiBD3mgG9le1USSh2mET4WP2vXg8juXLl/tVHMGTkA7cvRa4Zz1Q2yH1GnlKEQrgZgGvvHyPXINbxM/FcDaWjIC/bEb2ZlBFtIDHa0japsSwYl5fzWkPoKLZ92TJ91hMKW6BzlM/Hcn3Yip4SvHfhKrisclkkqpn33PrOSJHcpX6GfbJUyqRVV7qNeYp5Z8hR7p8LyCxRkXOi6ob6mRB8j318M0otXDhQvTu3duv4ghRmL6kai8iiMrAzYStvHxPgpt20LA2UxyMUgJietFirzC6hDTqfpLPU0qV79LsIPueHtJMI4VYTym+gc51D/K9aJF24o19bOA1F7AxTrZx3IwpFVP7kNPtgZYuRXKV5SlV4kRmZJVnvwYzwPtxwOeX3NArqkvVZMQaNccHRdtEFrL7KpGLvJmaUAONzbZqLyKIysDNKbgKGYeKISPLStDguZky+xJP+Z7iQVVlYsmsJFfEI/aFKpPCqSJFdCLfA+xZA7lXySSevuG8PKXceOCxQOcyPaUyY/jwuYYqmWhZlkPl5XsuDxM0CXN5TqDzUuV7eQKds2W/n/1Hc7GG40G+2FkqYcYxEinfS/I7/AsyMu4FURzHMaUOOeSQon9vaGgouTKEIJp3Aq9dljJIHXMLsN+pQIe9ZNeKIFwFsTUUWYgXIuibchFYccH8L1uMfC/zWoSF7IC3pWJ/blU7UWVGqepIcaNUWNfQnBCdfS938+snbozNjel2ikbkGaXsG8FE0uCyWVYlu1ZNJCAxpbzK9wTO5exafo09iazyAMtwlPCx/9jle4ZhCDeEWAYYoZd1jGhZu339I3t8UA0ZslyiOI6NUosWLcIFF1xQUKJXX1+P7777zreKERxJxoDv3k39/7z/B4Sr5NaHINK4ib/BFlKqLj6CvikXAc8TfhGeajyNakHHDHgb0P6fId8L+SOh8YumhDNPKbYBFesplZYJhTjJ91xsJFgWOJlGKfvYwGsuMD02JU+G1ZFgxJRy2166hLnclO+F/JEOm55SebLvsaL9MJjaPdeTBsDJNl0Q1Q+KzAQggrqSfS2tqveYLEjNoB6OjVL9+vXDEUccgauvvjrv3+fPn4+//vWvvlWM4Ig9055GCk5CHdykaFUljkYhQgGPqSOChI+xLLIRcQqmimxGRUR4qvHEvlDVfZLQ+IUp32shVpKMrIGx9EPNzVPKRcYk5rETbcGjjCd6HiOA3xiKbMQtTyl13YO9eI7ISB3Pxh9LOlyiUcqWcTCkpcYy9pqf8q6QltnfdYjtk24zK4pGdKxRe7ch+V4mFPdVPRwbpQYPHoxvv/224N/btGmDY445xpdKEZyxP4D1XwHrvgG6HADsNkBenQgC7jK3BEa+R/NdQXjKTkRsJFQ/lZVJ0Pu/PaOZDE+JYjg1SlmZu7hXyYTJ93htCjUXzzXz2KmR6iklMqYUn/KdEoSYUvZ74HTcFp2lyzAMcw3k1zPMPq9pGkKahqRhmK/52X/s59wyxktVnoVCiJbvJT0YYSuFoK9RyhHHRqnHH3+86N/79OmDjz76qNT6ECKwBzVf8Brw2Xhg8E1klCKkw07BHcn3FI8dYMWhoBmvEDwNi7oLjwqvWFmcuF0isIgINM8Tu/eJDE+JYqjsKcXud4RX9j0XGwnmsSM3ppT1f+7yPdnZ9wIQU8o+HjnPvid2Lrd3E5bFslRvDruxJjXfGvzlexIc5uzGNxUx5XuC2sY+5qjqPSYLN+FCCDHQUroSMdILBi1E2fcIpSgn+Z5O8r0WSXA0Sok43Sb5XmGCHlPNnt3TlIwp8l2aHGbfk5F+PMY5+56bftWogKdU5iadz41QxWMzGgCjlBfPEdFGabt02Df5nmEfz5BRJk/5nmgStu+pIqJl7V48AysF1Q6bCDJKVSbMAKXpZJQilMLNKbjqBgHRLv9BhOdmSoRRkJ0Eq9oHZcIMIkFd79nle6q5+ZvZ91qS7+liT+UBAdn3XBgIVYgpJUK+xza4sg9oogEIdG7vNk7bKyTYuGvv2/7J9yzDU3aYhKSPhpyQZPme6X2t6O5WdKzRTCMsrVPsBH2NUo4o+tgSXDGNUjZPKcpbTyiAmyC2qmc+I9fglrHke/6XLUI+ydPTK+hoAe//dkmLeaKqyHdpTjiU74WYfE9c/zQDnXPaFVqn2y2/tyEmP/ueSPme7GEoGoBA5wkPm3TRc3mGfC/kl3wv9TNkM0qx/mj9raRLmOWb15Qh3/PR64sHovuSfc5Sda0sC1qjqwcZpSqRtrsD92wC7lwFhNKLNfKUIhTATRBbVSQLhdAFu2kHEZ6xUER4qlkeCvyuEVSC7hpvTxuvmnzPcaBzCVkDWbtx85RyYWxuVMIoxd+oqcpcyDzSVPaUsj/DTpuL3T9Rc7l9kxxh3o6lGqWS1lxlxvszjVL+Ha7Il++lfqov3xNzPZLvFcbNfoMQg+NA50QZoWnpp5FiShFqUV7yvdRPOoQpDFf5noCYRqoHVZVJ0F3jgyHfK25sYdIfkYHO45wDnbuT76XaSWZMKQA52c78xjSOSx6HghDo3L7Uddpeop//DPle+jnyS75nN7Ib2UYpHw6H7EVIle8pOiWLjjWaId9TtVEkEfQ1SjlC57uVjmmUUncRQVQOboLYmnEQFJ1o9ZA/J5zlTJKjp5EITx17MGwik6DL9+yJFHTFvktTwlmg87CE7HtMvsdrXHaT1VEFTynAnSHNCwmbAVUmQQh0XpJ8T0Jw6rBPfcc8ALKNZ+w1P+V7mqaZ/VDG2sdPAxsPNNF9SfEwFzIR/VwTLePrVuC4447D/fffj507dzr+zPjx49G7d29Eo1EceuihmDFjRtH3NzU14a677kLPnj1RXV2NPn36YOLEiaVWvbLYWg+8ehnw5nVA37OA8yYBAy6SXSuCcCffUySORiFEZ1kJIkmbRMpvrPhkvhdtonpQVZkEXb6X4VkgWL7TEo7lezI8pdIXi3CLKeXca6VBgUDngDtDmhdUke/VBCCmlCf5Hju7FWxIAGxGqRL7TsJmnMg+MPB7HhYtUbOTUDz5iCU/FnM9VcYGFSH5nnr4Kt/r2bMnPvzwQ/ztb3/DTz/91OL7X375Zdx4440YP348jj76aDzzzDM4+eSTsWjRIuyxxx55P/OLX/wCP//8M5599lnstddeWLt2LeLxuJ9fo/xp2gosfB2oaQ+c/hTQeX/ZNSIIADbvIgcLsITiky3vjUg5wFP+JuIUzPJQULMPykSEfJInSSPPJk6R79IcTxlbWgx07pP0xw1MvscrppTTWH2GYZgeOyrI9wB+m3QrXpDccag6CDGl8hhnWkK0p6R9zNTNZ7i0axt5jOxWoHN/vYt0TUMChpS1j33cVhHR82JCcc8xmei2cdkwDFrHKYCvRqnnnnsOALB9+3ZH7//DH/6AUaNG4YorrgAAPP7443jvvfcwYcIEPPjggznvf/fddzF9+nQsWbIE7du3BwD06tXLn8pXEsn0gkGj431CLdws3lVJg10I0WmkgwhbMPHYv4rw1GGnnSTfy0W1OExusQc61xV7lp1m39NleEqlH4oIJ6OUU2lQcyJp3q9qyUYpnbNRU5WNeBBiSnnxHBGRNMOOXY5pejuW6FljzxSrZ3kRJ3yWeMn0QFHFQFsI0W1D8r3CZAbl57MOJdzBxSrRunXrFt/T3NyMuXPnYsSIERmvjxgxArNmzcr7mTfffBMDBw7Eww8/jN133x377LMPfvvb36KhocGXelcMLNJjSAfWfw8seB1YOUdunQgC7gwJ9kDEKuImPlalYnA8xRMhIVA92L5Mgu4ab9g2r6rJ95pizmJKWZm7uFfJhMn3dMnyPbuETLanFO9nQZWEC0GIKeVlzBYtReYx9iQzysxcmxgeDHXFkCnfU+VZKITowxq/7205ITtTJJGLJ0+pqVOnYurUqVi7di2SWcJYp/Gd1q9fj0QigS5dumS83qVLF6xZsybvZ5YsWYJPPvkE0WgU//rXv7B+/Xpcc8012LhxY8HrNjU1oampyfx969atAIBYLIZYLOaorirC6u7pO8SaEQFgQENy0VvQPxyH5IHnI9Glv7+VJEq7TxWIkTaYxhPJFtusmS18DcNT+/K+N4lESlacTHqrXyUQTx//JpOF77fX+8T6Uiye4HePk6z+8Yq7xy3dF7aZao4Fs22a03UOaYCRZH2p5XFJBCymVAjF62Olfhc3B7FA50jyee7Yc51oYY7YtrMRQLoNknHEYvI2ZWzz09xceN1Zynxk76sy+2dES23sGmL8xtxSaWpOt1Uos62KtX8yrS4QNZebddRg7rHiReZIJyQSqe9gGEloSN2n5vQ+iM1jhk/PLLNHNxXp715p6TmJp9ddMNQYq7Mxkqn6JUq8n05pijUDSI1BPK8XxL0OW6MDQFNTMyD58EIE+e6TSvfMtVFq3LhxuO+++zBw4EB069atZGt09ueL6TqTySQ0TcNLL72Edu3aAUhJAM8991z86U9/Qk1NTc5nHnzwQYwbNy7n9ffffx+1tbUl1V0FpkyZ4voz7XYuxTAAjU3N+PHb79APwKqVK/Dl5Ml+V49I4+U+VSILf9YA6KhfswaTW+iP36xKvXf1qpWYPHm552vyujcbGgEgjFg83uJ3qVTq60MAQli8cAEmr/+66Hvd3qdv6lP9Y9Xq1Zg8eaX3ShZh6zYdgIYvPv8cm77hcgnlKXRfNmxI3dt58+ZDXzlPbKV8YNk2AAijsbEB33/3LQAdy1eswOTJLcfL5M3OplS/+/STj/F9tPD71v2cugdJQ9wcFEuk6vbxtI+wS7X/5f93feq5XrtuXdFxdX16/I1oBt555x3/K+KCeCzVJtM+/hjftbDs9HKf5m9ItcnmTZukzjWbmwAgjIYmdec81i+SiUTeOuZrf9Fz+cZ0OyKZxIKv/wtAx88/ry3p2st+So0FP3z/LRobQgA0zJw1C6vbABs2pvrnvC+/RHxZ6R4jyXiqvI+mTUPn3G2ZLxR6Tr5dnvqeK5Yvx+TJy/hcvATW7ASAMJqamoX0pZ8bUtdLxGNCrhekvU5TAmBmkHfefQ9V5W+TMrHfJzfJ6Xjj2ij15z//GZMmTcJFF5WWra1jx47QdT3HK2rt2rU53lOMbt26YffddzcNUgCw//77wzAMrFy5EnvvvXfOZ+644w6MGTPG/H3r1q3o0aMHRowYgbZt25b0HWQSi8UwZcoUDB8+HJFIxNVntdVfAt8C0dpW2P+AvsAqYPfduqFrXR2n2lYupdynSmTH3FV4eclCdOrcGXV1hxR977JpS4DlP6DnHj1QV9fX9bV435vVmxtw37wZ0EI66upO9L38cuDfG+cBm9bhoAMPRN3A7nnf4/U+bfx8OV5f9g26du2Gujo+XqBPfP8J0LATgwYNwmG9duVyDVVp6b68tm4uvtuyAQf174+6g3eTUMPSmLd8M/64YDZa1dZi//174M3l32H33XdHXd2BsquGmz+fAsDA8OOPQ7d2ha1SU3d8jXkb6pEwIGQOMgwDN3yaWuyeOPx4dGjNwSr19Ro8//1/0b5DB9TVHVbwbd+u2QbM+xStaqpQV3es//Vwwf1fT8P27c0YPHgI9uvaJu97SlrTLViD5777Lzp2aF+0TXizpSGGe7/8CEloGH7iSWagfZX4acNO3D/vE1RFIhnzcrH2Fz2Xr9i0E/jyE4TDOgb0PxAv/bAAHTp2Ql3doZ7LnP76AmDdauy3735YsGMV1jftxBFHDsLAnrvi2RWfAdu34rDDBuK4fTuVXP9753+EhoYYhhwzFH06tSq5PDstPSffTPkeWLUUvXv1Ql3dfr5e2w+WrNuBB7+aiXBW/+PFD2u3A/NnIVrNdxwM4l6nMZbArbOnAgCGjxiBVtW+htlWknz3iSnIVMD1HWhubsZRRx1V8oWrqqpw6KGHYsqUKTjrrLPM16dMmYIzzjgj72eOPvpovPrqq9i+fbsZt+q7775DKBRC9+75NzTV1dWors5dGEUikcA8OMXw9D30lDlY00LQ9dRnQzAQKoP2UJVy6W+8iYRTfdOA1nJ7pQP1h3W9pLbldW+qq9Iu/4ZB974Qaa/YSCTcYhu5vU/hcGp6c9SXPGIGUq5quf7lSqH7wrJGQQsFsm1C6XkyrIfcjUucSSYNM8Ndq2hV0fpUpeUICUPMHBSzRWOOVhevm1ciEWfPdTwdMrXGwdjCGxZ0OeRgrvJ0n0J6+jpyn7XWtjC1cYRQq+Bzr6Wf65CGvG2Vr/2rqtJSfEFzua6H03XUzP6OAvV1DJtrw7oZwzEUYv0x9XtV2J9nJeSiv3ul4HOS1g5GwvyuXQpVVak6JZMl3k+HhDL6Ev/rBWmvk7Ql+wr51PeDgv0+qfS9XR9jXHHFFfj73//uy8XHjBmDv/3tb5g4cSIWL16Mm266CcuXL8fo0aMBpLycLr74YvP9I0eORIcOHXDZZZdh0aJF+Pjjj3HLLbfg8ssvzyvdIwqw2wDgjpXA6E/MxYwZ/JwgJOImCKTqQaat4Khy66Ey9gxnfiMk+57iQVVlIjPYrR+wvqlpamUSbLYZflrKKscCnQvLGma7UJiTl4z5XLfwpViw7WhEvreO2X84LbOshBF8yndKdThkBnVXNdi5l+Qaop9/c14MWUHJEyVe3J6VLjsbpH2s8wPRgeHtqJ5tTnTbWAmBFG0QidjXnbQFVgPXnlKNjY34y1/+gg8++AAHHXRQjoXtD3/4g+Oyzj//fGzYsAH33Xcf6uvr0a9fP0yePBk9e/YEANTX12P5citWTOvWrTFlyhRcd911GDhwIDp06IBf/OIXeOCBB9x+jcompAPVaRdy9lDSE0kogJWq2Hn2PVUXH5pPi8lyhuc91M2NBL/252lUCzqhrI1P0MjMVpX6vwrfpSluzdUtZd9j42nCENM/7Z5SYU4Ds9Ospg1po0iNAoFCeGdiVWUc0jQN0bCOhlgCjc1qrilZF9VdtJVfhiGn5M+U50+Zmq1M1h3Z33SfnlnR7WVH/cNKsfNiwjRGCrlcoLCPASrM7YQHo9R///tfHHzwwQCABQsWZPzNiyX2mmuuwTXXXJP3b5MmTcp5bb/99gtUIDXlYe6LZJQiFMBN6uykhxNPkdgXeMUSOFQyhs+LYTsiTrfZqbubDU6lIPO03A/s95b1z1LTsvtBs80oxTyhChFOu84kBFU7brsQr3hC1qau+PuamKdUWAGjVLopeD0LdiOGbGqq0kapuJqeUl48R+zTk4i53Bx7QpppTCh17Ema45m1ZmIGi6TPRk2ZXrLms6DoupDVS5S9zlBobFANe5MEdZ1Sbrg2Sn300Uc86kGIZN23wMwngXa7AweeB5zxJ6BdD9m1IghXJ8oqLcTzEcqY8FKLQSITSzbgf+O4MXB6xTp95naJwKKS5M0LCXPzavVPXvIrNzD5XlU41OJzY8r3BNU7ZrsQrz1hyOEmvZI8pVTyGo6GUzdIVfmel7ayrzFEzOUJWx398ri2H+JlHxgkbWOdH8g8kEgERL4n6oBDdc8xmWiaBk1LGe7IKKUGro+ypkyZgoaGBh51IUSxrR6Y/yKw+G2g497AgAuBPYfKrhVB2OR7Lb9X9dgB9g0jSfjyw1W+F/JnMV+MBC34CuJGiqsi+SQ0Krj4M0+pageeSCyukyjzAHvWIrrGzZvEqYGnMZZuJxU8pTgbaO3xgmQTTRsBG5oVNUox+Z6bmFIhsXM5q6NdaleyfC9PmZZ8z1+P32xPLJEYis/Juk9GRqeYaxSS7+VFV+jAifDgKXXOOeegqakJhx56KIYOHYphw4bh6KOPNrPhEQEgmV4saDRKEWrh5oQtSPI9OoXJj9+LYTsiJAR2mQWRiQhPNZ5kBAb2SULjB01pWVRV2IFRyoWR3w+YfC/McQdkxasp/j5mFFHDUyr1k9dGVKWEC0wu2RhXc5fnxXMk0+tZgFEqQzrsz3UTtjJz5Hs+S95kesmqflCkCW4b1Y10skm1ixHYdUq54XrlsGnTJkybNg2nn3465s2bh/POOw/t27fHkUceidtvv51HHQm/MUXGIWDrauC794AVX8itE0GgfOV7NN/lh+dmyordwF++RzapXExPqYD2fbsXn+iNRDGYp5Qzo5TYmFIs0HmYo77JaXwvFtMo6qCdeCNKvqdCbLsa1T2lPHiOZMaH9LtGueQfe0q7sGErs5B8z6+1lMwYfKqvC7NjjfLGDGKvaHvIhne8P8IdrmdrXdcxaNAg3H777Xj33Xcxa9YsjBw5EnPnzsUjjzzCo46E37Cg5loIWPYJ8PdfAB9RBkNCPk6D2AJBiB1AmT1agqd8j7d3gr1sFTwUVMPciKtgyfGA3XtAZjapbFwZpXTn46kfxJPMU4rf8+DUA69RKU8pvl6bXgwtvIhGUpVoUjzQuTtPKbFzeb5MeaV6OxbL6Of3PKwJmHsLYXBcU/iBvV4i2sdao3C/VCDx6/ki/MG1fG/x4sWYPn06pk2bhunTpyORSGDw4MF47LHHMHQoxSUKBIZNvkfZ9wiFcBrE1v4eVU+AMoOjyt/MqgjPWCgi5Humh4KqK2CJBF2+Zxm9/ZPQ+IFplHIQU8oMdC7KKMXkexzzjzs1EDL5WDSigFGKc4ydpELGcSbfU9dTKvXTjVFKdJauhG1e1H3ylDLHszxlsg2539n3pMj3bN9TRbSMdSH/61Gg8+Lw9mIl3OHaKNW3b1906tQJN954I+6++2707duXR70InpieUrrNKEUPJCEfL/I9FRbi+ciQ75HNNy88Xe1FLDasdMvcLhFYdIkbEz/IlLvwN3A6pSktkauOtGz40QXL9+Lp3W2E4wNhSYOKv48ZRZQwSnE20Kok0WGBzpXNvufBw9reriLm8mJSO69kSgIzX/P7cEU3x0uS72UjOtYouwQdnOVHZqZIIhfXRqnrr78eH3/8McaOHYs33ngDw4YNw7BhwzBkyBAKdh4U7PI9ZpRKqrmAICoLp0FsAVvgTkUnW3u9SL6XH57B6k35Hse2t3vTEJkE/QQyb/Y9BSxsXjylxMWUSo/JHGNKOX2umVEk6sB4xxunhjSv8JRBu8X0lIqpeRLjJRC2LPleKKTZYiOWVqbdOJEd74/1H7+mMU3A3FsIy8Am/NKOEB00348QA4ZhIB6PI5EovE+MxWIIh8NobGws+j7V2K2NjjYRA7HmJjQ2ujaJBIZIJAJdl39A0xKu78Djjz8OANi8eTNmzJiB6dOn45577sHXX3+Ngw8+GJ999pnfdST8Zq/hwM3fAaEw8NPM1GvkykEoQMjFCZvqsQMy3bTlb2ZVhGdcMBESAtUzQMrEDCCqgCHHC/bNq0oGNpUDnccTzFOK347QaeDnBmaUCstfiGucjZoqSXRqqlL3XlVPKcNmbHaKLPlexthTYt+xGyeyy0yUkXwvqfhBUWZYB/7XK9Vg3dzcjPr6euzcubPo+wzDQNeuXbFixQpl1Qv5uPWo9kgYQNOmNVi6VVFLpg9omobu3bujurpadlWK4tksmEwmEY/H0dzcjKamJsRiMSxbtszHqhHciERT/wAglF6wkVGKUAC2l3GyeA9CkOmQllp4BHVjzhsvGwSnmKfBHNteJQ8F1bCSFgSz75tG75BaLv6WUaplY0tYcEwpNiZzzb7nMDBtY9pTR41A56mfvPqPaVRQYCBiRkBVjVJeYg6lDDni5nLR8j0zPqdf8j0Bc28h1A/rYPO6E9A+pUgzk8kkli5dCl3Xsdtuu6GqqqpguyaTSWzfvh2tW7dGSIWMCw5JrN2ORDKJPdq3MqXH5YZhGFi3bh1WrlyJXr16ya5OUVwbpW644QZMmzYNCxcuRPv27XHMMcfgqquuwrBhw9CvXz8edSR4YsaUUnMBQVQWXmJKqSrfA1J1SyaMwMbV4Y0XKYVTRATaVimWi2rIPC33gwxvBZ8kNH7QnHAu32NZ8ITJ98zse/wDnbeYfU8l+R5nTzuVjOM1qseU8thWIU1D0hAzl2d4aYb8Me6bxgnNku+xMS7hc/+RacQ3wzoo8CzkIyPWqAgpKIvW4mGN0tzcjGQyiR49eqC2traF6yTR3NyMaDQaKKOUHmlGMpFEdbQa0aryle916tQJy5YtQzwel12Vori+A6tWrcKVV15JRqggs2ou8NU/gU77pqR8dY8CrTvLrhVBuAoorNJCvBCphYChhIeFivC8hyLle6qeysqE3VMZwW79IH8KdfnfpSm92a92It/T5cj3eHpKOTU2M6NIjRKBzvmORQZH475bWGD5BkWNUl69c0MC5/K8Y0+JYga7B1H2Osvv7I2axAMJy8NV/rOQj6DJ9wAEyshE5Eczn3n5a5hiuDZKvfbaazzqQYhk/ffA7L8AfY4HDrsCOPxK2TUiCABWcEonp4Kqxw4AbEF5VXCxUBBzg8BhAclbQmAYBmXfK0Io6zQ+aNhlD+bJvwLfxfSUcmCUipgeXmI6aNz0lOIo33PotcaMItUKGKV4e20qJd+LME8pNUNCeJHvpd4PICFWcmWXDpe6mbQbJ7I9mcwg6D6tpbI9sURSimeQCOz9Tqh8T9H2kA1rFfkzOwEAnsyfP/74I6677jqccMIJGD58OK6//nr8+OOPfteN4AXLtKeR9ZtQC6dBbFPvSf1U2Silu/D8qkR4Zq/jvRG0rydVlpDKIujyPXvqeKXkey6y75mbQ2GeUiymlAD5Xgs3QyVPKd6bdJW8hplcUlVPqVLke4CYuZz1bd2e+bNUoxQrM5Rbpt8yeplesokAGGFEtk8Q1slKILCrapqGN954Q9wFA4TrlcN7772HAw44ALNnz8ZBBx2Efv364fPPP0ffvn0xZcoUHnUk/IYFNddCQMNmYOkMYOVcqVUiCMB5EFtArYV4IVSS/agIz3soKo4LoO6prEzYRlx1d/FC5JO7qPAcu8m+FxEt30sP3BGegc5ZVscW5XupukQVMErxNmgYCm3EayKqx5RK/XTbVrznEzv5xx5/ygzlKdPumeUHMg8kVM/KDDj39vQDv++tFxJJA5/+uAH/nr8Kn/64QagH3axZs6DrOk466aT8b2AGwqyXe/Xqhccff5xn1Yg8uJbv3X777bjpppvwv//7vzmv33bbbRg+fLhvlSM4wYKah3RgzX+B/3ca0Gk/4NrP5daLqHjcBTr3N2MMD/wKUlqumLIBDveQt3eLfWGlch+UBdvzBV6+p2lKyXCbXMj3WGwnYYHOE2xM5rcDchqvRiVPKWss4iTfUyi2XVR5o5Q3ryBzPBNilLJ7aaZe80u+p+Up029vGpmZV83vovCczGKNimgfnt7oTnh3QT3GvbUI9Vsazde6tYvi3tMOwEn9unG//sSJE3Hdddfhb3/7G5YvX4499tgj4+8a1O0nlYjrlcPixYsxatSonNcvv/xyLFq0yJdKEZyxe0qZ2ffU1P8TlYUbyZXqsQOA4Ad75g3PBRPvDED2YhVe/0oj8PI92wmzSjJc5inlKNB5evcp6h4kmKcUxwfCrXxPhex7vI2aKkl0ahSPKWU3zrghJNDz0y61Y2NPqX0nkU++l37N7/icfhnSvCDbCOMEkTEKvQb294N3F9Tj6he/zDBIAcCaLY24+sUv8e6Ceq7X37FjB1555RVcffXVOPXUUzFp0qSMv7/55ps458ShOGyvrthj9644++yzAQDDhg3DTz/9hJtuugmappl7jLFjx+Lggw/OKOPxxx9Hr169zN+/+OILDB8+HB07dkS7du0wdOhQfPnllzy/Zlnherbu1KkT5s+fn/P6/Pnz0bkzZXALBGZMKQ3Q9MzXCEIiVuyNlt/rdxwEHliLP8kVURSvGwQnZC+8/cZ+yqlyH5SFSLkLD+wZqTSJJ//ZuJHvyfKU4pl9z0m/MgzDjGmkhKcUZ6OmZcTgU74bqtNGQFU9pezGGTfoAudyu3zPr0x2duOEKPmelEDnQZDvCZwbvQb2L4RhGNjZHM/7r6E5Yf5/W2MM9765MG+oJvba2DcXYVtjrGB59n9eDJwvv/wy9t13X+y777648MIL8dxzz5nl/Oc//8HZZ5+NYSeMwMvvTMfbk9/FwIEDAQCvv/46unfvjvvuuw/19fWor3duPNu2bRsuueQSzJgxA5999hn23ntv1NXVYdu2ba7rX4m4lu9deeWVuOqqq7BkyRIcddRR0DQNn3zyCR566CHcfPPNPOpI+A17uDWdPKUIpbAW7y1PQGYcDQUW4oXgLdsIOmZ8Dx7yPd4bQTJKFYW3pxpv7LFndIWeY1dGKcEB2uPpHTvPQOdOZFSxhGF+ZxWy7/GOSeZVksYDZgRUNdC5V88RN0lYSsUuHfZr7LH3kex4f7zke3JiSqV+qiypF9k+fhvpGmIJHHDPeyWXYwBYs7URB45939H7F913Imqr3Jksnn32WVx44YUAgJNOOgnbt2/H1KlTccIJJ+D3v/89LrjgAlx/611ojCWwZ8dWGHR4yijVvn176LqONm3aoGvXrq6uedxxx2X8/swzz2DXXXfF9OnTceqpp7oqqxJxbZS6++670aZNGzz22GO44447AAC77bYbxo4di+uvv973ChIc6H8+sPcJQKQW2Lwi9RoZpQgFcLORtZ8mqkrQN+a84bmZ4r0RtA+ZCq9/pSFyE8eDfCnUVfgqzQnn2ffMQOeCpvd4elAO85TvOTC02Q0ianhKpX7y8rRTaS6Mlqt8T+Bcbvdc8kvqlbCNZ/Z4f/Zy/c6+J2PsT9g8XFWFd2ZgOzLlezL59ttvMXv2bLz++usAgHA4jPPPPx8TJ07ECSecgPnz5+PKK6803+/XnVi7di3uuecefPjhh/j555+RSCSwc+dOLF++3KcrlDeujVKapuGmm27CTTfdZLqjtWnTxveKERyJtkv9A4Ctq1I/yShFKIAZGNzBAiwYsQNY/BPJFVEUnq72TIpA8j05uJHiqoi1MbTJ9xQIkOUqphST73GtkYVllOLnKaU78KZtShulQhrfTIBO4e0ZkVBIvqd69j3P8r2QuLncfljjV98xjROhzDLthhG/sjdabUXyvXyIbB+/w1zURHQsuu/EnNeTySS2bd2GNm3bIBQKYfbSjbj0uS9aLG/SZYfh8N7tHV3XDc8++yzi8Th233138zXDMBCJRLBp0ybU1NQAgKsw56FQKGfeicViGb9feumlWLduHR5//HH07NkT1dXVGDRoEJqbm13Vv1JxbZQCgPXr12PZsmXQNC0jwBcRQEi+RyiEG8mVlX2PZ41KQ6VU8irCN9A5341ghnxP5RWwJIIe5J8Z0+xyFxWe4yYv8j1RnlLpRuNpCHISNNweT0oFjwnem1CDo8epW1TPvufVc0TkXG4fe/zK4Gufa+0xjezlaj6tpfyKg+UFu/RRVYIs39M0La+MLplMIl6lo7YqjFAohCF7d0K3dlGs2dKY1wtJA9C1XRRD9u7ku9QyHo/j+eefx2OPPYYRI0Zk/O2cc87BSy+9hIMOOghTp07F4LpzAeTuOaqqqpBIZI5hnTp1wpo1a2AYhtnHs2Nsz5gxA+PHj0ddXR0AYMWKFVi/fr2P3668cWWUWrhwIa6++mrMnDkz4/WhQ4diwoQJ2HfffX2tHMGJpTOAHz4AdhsA9DwKOGEcUE3eboR83ASADIJbMnMYUGEzqyI872F23Ay/CcKJrEyCHk9NWfmeK6NUWr5XRoHOncj3mHQsqoB0D+Av11Ex+148aSCWSJoSUlXwKhkXOZfnH3v8iill+y5JI2NM881TSuJhnEpS1kKInBt5xu0shh7ScO9pB+DqF7+Ehkx5HKvJvacdwKVeb7/9NjZt2oRRo0ahXbt2GX8799xz8eyzz+KPf/wjjj/+eOzatQeOP+VM7KiPYMZHH+DWW28FAPTq1Qsff/wxLrjgAlRXV6Njx44YNmwY1q1bh4cffhjnnnsu3n33Xbzzzjto27atWf5ee+2FF154AQMHDsTWrVtxyy23mF5ZRMs4ni3WrFmDoUOHYt26dfjDH/6AyZMn4z//+Q8eeeQR1NfXY8iQIVi7di3PuhJ+sfILYObjwPdTgNadgcE3AoeNkl0rgnAUxJYRhNgB5ClVHL4xpVI/ucVxsZ1mE7kEPfOklUghN4W6TEyjlN6ywUV09r14+qHgKd+zP2+FNurMU0oVoxR3+Z5CnlIs+x6gprdUwuNhgsi53O755rt8LyujH4+EHTIP44JwWOTE29MvkhLDXJzUrxsmXHgIuraLZrzetV0UEy48BCf168blus8++yxOOOGEHIMUkPKUmj9/Ptq2bYtXX30VU9+bjF+cdAxOqzsRn3/+ufm+++67D8uWLUOfPn3QqVMnAMD++++P8ePH409/+hP69++P2bNn47e//W1G+RMnTsSmTZswYMAAXHTRRbj++uvRuXNnLt+zHHHsKfXHP/4RPXv2xMyZMxGNWh3spJNOwtVXX43Bgwfjj3/8Ix588EEuFSV8hEn1FFjAEIQdJ6fgjCC4aeucNyNBx0pX7H/Z5sKbU+PbYw4RuZSLfE/L2BjK/y5NCeeeUsxLRVj2PRGBzm1FJ5JGXq+sRtMopYaXjjj5HpfiXVEdDkHTUkaQhlgCbaIR2VXKwKtXmUjJlSnf89Egbo+lxdYlCcPIKNevpRTvubcYSdv3VBXemYHteA3s7xcn9euG4Qd0xeylG7F2WyM6t4ni8N7tud6ft956q+DfDjnkEHO8POSQQ3DQ4BHY2RxHzw6t0K7GGquOPPJIfPXVVzmfHz16NEaPHp3x2p133mn+f8CAAfjii8xYWueee27G70FdE4nA8Yw9ZcoU3HbbbRkGKUZNTQ1uueUWvPde6WkiCQGYRqkQEGsAVs0FVs+TWyeCgM2I42AxE4QTMU3giVgQ4SrfExRcWOX+J5OQbeMTRPLKXRT4Lm4CnZvGEGhCFsJxU77H0VPK9sAVerZV85TiLd+zjPvyByNN0xANp9q9ScEMfF6NFkK9W/LI94DSNrN244T9wMD+dfwyFFhGL1+Kc4VKUtZCiJwbvQb29xM9pGFQnw444+DdMahPB6UMhmZNFJjbCRdGqSVLluCQQw4p+PeBAwdiyZIlvlSK4AwzSoV0YMtK4K/HAc+fIbdOBAF3qYTNxYdCE1w2KgVIVhErWD3PQOe8vBNSP1X21JOJSM8CHhg2T0yVvktzPGVwceQpZXNBjAnYIYoJdG43SuX/Tk22QOcqwNtArtpGnHmoNSgo3/PqOSJbvpe6tvcy7X1Es30Xu6HLN/meRC/ZIHgwizzkCELsVamwviq3FkQax0apbdu2ZQTzyqZNmzbYvn27L5UiOGP3lDKz79EjScjHTdYWnvGI/EKkm3YQSXjcIDiBf3Bh9fufTNwYmFXE6ptqyfeaXcj37NK2uIAUfDEBp/L2ogvdD9U8pXj3H9W8hmsUzsBXqnxPxBBg93yzG1dK8dKyHwCx5zORzCzTr/4jc7wMggez1ZfEed3RMiU/1Cxq4Sr73rZt2/LK9wBg69atpJMMCsn0QiHDKKWemzVRedg3M8mkUfS0KxmAxQczspF8LxfDMIRk3+O1F+dpUCsHeMfR4Y09a5FI6U5LWIHO3RmlRNQ9kfbG4plxzYnniGrZ9+zZznigWhwd1u4NzQoapbzK90Li5nK74cyJEdZZmbmSQLt8T9P8SxoTshm9RBMEzyBT3iigfdg6hTy6iyN/ZicAF0YpwzCwzz77FP27ylmwCBump5RuGaWS6i0eiMojewEWKnKOEQz5XuqnCh4WqsEjFbUd/vI9tTaCqqEp5F3kBfsmjt1jFb6Km5hSYcHyvZiZfU+MfK+QgYAZQ1QJdM5b/mkZFtQYi5hRqjGu3mGnd/le5ud5YiVxyZxfSrm0PQub3cDGw+NXppdsEDyYeXtx2wmCkU4JFJjbCRdGqY8++ohnPQiRHHk1cOC5QM2uljGKPKUIBXASxNb6u/qLD5LvFcYe5JPHPeQdt0G1OC6qYcVTk1wRj2Rs4hQysDXFncv39JBmZkKLC7gRLNA5T0Nt5iY9/3dqjKsVU4p3YGO7EUMFzJhSKnpKeYwFKNIwbV/bZBhhS/KUQk6ZSYNPFmOrrSTI9xSTsuZDZKxRcx5TuUEkwgz58md2AnBhlBo6dCjPehAiad059Q8Atq5O/TTUWzwQlYeTILaMIMQOIPleYez3V+Pg0GBfePPw5GX3VBXvBNUwT8sD2vftnpgqZdFsdmGUAlJeS7GEIUa+lxQh37P+X1C+16xaTKnUT16bdNWCO9dUpbPvxdVbV3o9zBI5l9s937SM/u6HfE/L8GSyy/f8wmor/8p0imEbt1XFXJsIlO8p3BxSoWZRCzV8mwl5UEwpQiHcxE8IQvYz3bb4IzKxL8h4yvcAPqfbVuBY/8suB4Iu37MbvVWR7yWThunx5CSmFGBJ6WICdojsGmGOLjt2I3AhAwGTjTHjiGx4xyNiY6kqBvJoWP2YUiGX47ZISRrrJ3ooc24sxcCfsH1v3TY22z1C/UKmfC/B4fv4jci5kTy6nRLMdUq54Wk5feCBB2LFihU5/ycCwvcfANMfBpZ+DFS1BobenvpHEJJxk/7Yig2h7mSrUip51bAvyLgEOnfhdecFitVQHD3gfT9fWnbZBrZmm2HJsadU2ngVFxBTihnMIm53/C5pSR5kxpRy2Ea84R9TSq1gxtGq8su+J3I8yzf2lHpt+3xlN4rYs/L5BWsrGfI91TJR5kNkrFGKfekM2QdORApPM/ayZcsQi8Vy/k8EhO/fBz76PbBkOlDdGjj2DmDYbbJrRRCOgtiafw/A4kOVzayKZMj3ONxDuySQRyyXIJzIyoR3TC/eJDM2can/84oJ5JSmuAejVHqAjAvQijBPKd4bIMsTI//fmTEkqoqnlCj5niJDkekpFVPPAz9heBu3Rc7l/OV79phS7Fqei87BlO9JGC+DcFgksi9ZYQa4XyqQlNouY8eOxcEHH2z+fumll+LMM88srVAPLFu2DJqmYf78+cKv7SdqHCMRYjGz79HtJ9TCvqhuaQFvyvdUWYnnIegbc55kyPc43ENR8j3OTiGBJegGWfvm1Tr5l3P6z2i2G6UcyvdYfCcRgc7ZBoinfA9oedPbwIxSYUWMUrzle4ptxGuqUn1ORU8pw6MBT2TGNLt8T7PHgCpFvmebr0xPnaTB5XBFpoe41XZqPAv5MD3VBNhsVRsbRHHppZemjboaIpEI9txzT/z2t7/Fjh078r7fr676xBNPYNKkSY7eWy6GJD9xHOicKCNYUPOQnsq+t/77lKGq0360wyKkYl9ItOgpFYBA02bWpaBqmDgiUr7Ho/2DkP1RJkHv+/bNa7aERlaWMybfqwqHHI97bEwVIt9L8A90DtikVIViSsUUiynFeZNuxQtSYyxixsBGBQOde20rnbNh0Y6RNbeENC0jKLmX8grJ93jIu+xGL9FYYR2EX9oxbP4Q4UnGQ57pmI8eTO0zh96a+7fpD6f2n8fewe3yJ510Ep577jnEYjHMmDEDV1xxBXbs2IEJEyaY79GAtNqrxpdrtmvXzpdyKhWyQFQidk+p2E5g/BHAhEFAokluvYiKR8va/BVD6mTrEFUCJKtIplHK//L9kj0Uwmtq8Uoh6PHU2Cl2KKRlbGBlen4xT6lqF0YfS77Hv96xdKOFhcn38n8nlvUtGlFjiWsPLM0D1eR7zBjYqGKgc4+eI+z9Ih7/7Dqy8cdr/7F/TNc0c11il+/52Xdkesma87IqD0MerL4kwCglU74X0lOhYqY/nPn69IdTr4f4HhpUV1eja9eu6NGjB0aOHIlf/epXeOONN0zJ3cSJEzH40H44rE8XJJMGtmzZgquuugqdO3dG27Ztcdxxx+Grr77KKPN///d/0aVLF7Rp0wajRo1CY2Njxt+z5XvJZBIPPfQQ9tprL1RXV2OPPfbA73//ewBA7969AQADBgyApmkYNmyY+bnnnnsO+++/P6LRKPbbbz+MHz8+4zqzZ8/GgAEDEI1GMXDgQMybN8/HlpMHeUpVInajlF3Cl1RvAUFUHiEttbBwKt9TeO0R+AxkPEnYTjR5eLv5FSC2EFIXewGAdxwd3tjle26ygvKEGaWcxpMCgEj6WF5E9j3mKcVbvteSwZMFOq+JqOIplfrJq++oFkcnGmGBztWLKRUI+V6Op1T6dY8TWSLjAChTDsjD41yTeCARBA9mkQc23OR7zVkyuGQy5eTQrAN6BIhELQ+pj34PJJqBwTcBn/wR+PgR4JhbgEHXArEGIFJTuFwAqGrlS5VramrMGNg//PADXnnlFfx50kvYmR6nTjnlFLRv3x6TJ09Gu3bt8Mwzz+D444/Hd999h/bt2+OVV17Bvffeiz/96U8YMmQIXnjhBTz55JPYc889C17zjjvuwF//+lf88Y9/xODBg1FfX49vvvkGQMqwdPjhh+ODDz5A3759UVVVBQD461//invvvRdPP/00BgwYgHnz5uHKK69Eq1atcMkll2DHjh049dRTcdxxx+HFF1/E0qVLccMNN/jSRrIho1QlkrQbpWyLNkO9BQRReeghDcmE0aJrcxACTZe6mCxneG+k7CelPGQEXgPmVgq84+jwxvLEzDJwSpwmmQeQG6NUOC3JF3EfmDdWmHMYgJY8R5hsrFoRoxTvwwnl5HsRFuhcvYPOIMj3sj3fSvXSykgqEsr0ZOKRuZE5csoY+1XzGsxHSGD7cMvM+T+7ZfwaArAL+2XvEcCvXk39f+itKc+ojx9J/WOw33sOBi77j/X64wcCOzdkXmvslpKrO3v2bPz973/H8ccfDwBobm7GCy+8gEa9FTbtbMYnH0/D119/jbVr16K6uhoA8Oijj+KNN97Aa6+9hquuugqPP/44Lr/8clxxxRUAgAceeAAffPBBjrcUY9u2bXjiiSfw9NNP45JLLgEA9OnTB4MHDwYAdOrUCQDQoUMHdO3a1fzc/fffj8ceewxnn302gJRH1aJFi/DMM8/gkksuwUsvvYREIoGJEyeitrYWffv2xcqVK3H11VeX3E6yUcO3mRBLIU8pMkoRCuD0lC0IJ2J6iYvJcsYMSMrp/vH2bglCoH2ZBF++Zwt0rph8z41RShco34unvbH4e0qlfhYyNqvmKWUZNPiUr9pGnMkmVQx0Hgj5XlawbjZHeo1BlJFUxJZ9L2Hw6Tsi5WnZBOOwUpwHvRJjgx6Rctm3334brVu3RjQaxaBBg3DMMcfgqaeeAgD07NnTNAoBwFfzv8T27dvRoUMHtG7d2vy3dOlS/PjjjwCAxYsXY9CgQRnXyP7dzuLFi9HU1GQawpywbt06rFixAqNGjcqoxwMPPJBRj/79+6O2ttZRPYKEJ0+pnj17IhKJ5PyfCAhDbwEGXg602z1T00tGKUIBWgpiyzAXlwqb1km+VxjeAUlZOm3D4GMYseqv7uJXJuy0PKjyPR5p2UvFNEq5iCklVL6XFBToPFTc4MlkY1FFjFK8paymgVyRsahGYU8pr54jYg0JqZ9sbilVOpidVMQuJ7XWUf71HZkHEqpJWfMhMtaolSXY5/a4c3XmdZJJbN22DW3btEEo2wg16NqUV5RelZLxHXNLSsoH5GaBv/Fr36p47LHHYsKECYhEIthtt90ybBWtWqUkgaxVkokkunXrhmnTpuWUs8suu3i6fk2N++DpybQF+a9//SuOOOKIjL/pempcDeqaygmejFILFizI+38iILTfM/UPyBwVyShFKIDT+BtB8JQy5XtlPIl4RcTiMaRpSNgkCn5incj6XnRZoJV4ui8ba/OqkHwv4d5TKpw2EInIvscMX7y9B1sy9jMPHVU8pbjL9xQzkDNjYJOCMaW8eo6InMtz5HumEaN0o5SmZZbHYx0Vkjj2B2FdaM6NAqx27CzC9/bIjvOUTAKRROp1+0kxk+4de5cl5fvo9ykDVb6sfD7FjwJShqe99tqr+JvSzXJg/wFYs2YNwuEwevXqlfet+++/Pz777DNcfPHF5mufffZZwaL33ntv1NTUYOrUqabkzw6LIZVIWMb7Ll26YPfdd8eSJUvwq1/9Km+5BxxwAF544QU0NDSYhq9i9QgSFFOq0tE0pJ5Kg4xShBI4PWULwuKjpRP9SiaRJVHgQUgDEiD5ngzM5zig04r9hNnuVaGEp5SrmFIiN0BpTyneMaVaiNXHjFLKZN+rMPleEDyl3BrwhAanLiTf89h/MuR7IZt8L2nYZMoeK5sHmUkurJhhwi/tGN6JD+x4DezvC8wAxQxSQGbwc/vvkjnm2OMwaNAgnHnmmXjooYew7777YvXq1Zg8eTLOPPNMDBw4EDfccAMuueQSDBw4EIMHD8ZLL72EhQsXFgx0Ho1Gcdttt+HWW29FVVUVjj76aKxbtw4LFy7EqFGj0LlzZ9TU1ODdd99F9+7dEY1G0a5dO4wdOxbXX3892rZti5NPPhlNTU2YM2cONm3ahDFjxmDkyJG46667MGrUKPzud7/DsmXL8OijjwpuMT64MkoZhoEPPvgAs2bNwpo1a6BpGrp06YKjjz4axx9/vDKnNEQLfDMZ2Pgj0Hso0O0g4KjrUsapcFR2zQjCcYDkIHiqWBtzskplw1u+B7D2N7hsyHlkLSondM7eIbwx84Fkyfdken4xo1S1B6NUTMAYFBOUfa9YrD7DMExjSKXI97KNGLKpVjimFDPsuG0r84BJSHDq1E9LvlfaWJor37MMbFzkexKTXARCvidwbpSaBCGZyDRIMdjvCmR815irlKZh8uTJuOuuu3D55Zdj3bp16Nq1K4455hh06dIFAHD++efjxx9/xG233YbGxkacc845uPrqq/Hee+8VLP/uu+9GOBzGPffcg9WrV6Nbt24YPXo0ACAcDuPJJ5/Efffdh3vuuQdDhgzBtGnTcMUVV6C2thaPPPIIbr31VrRq1QoHHnggbrzxRgBA69at8dZbb2H06NEYMGAADjjgADz00EM455xzuLaVCBwbpVatWoVTTz0VX3/9Nfr164cuXbrAMAzMmjUL999/P/r3748333wTu+++O8/6En7w1T+AxW8CpzyWMkqNuF92jQjCxOkCPgieKi1liapkkgLuH8/gtHZ5F5GLyNNgHthjz2TGJ5NvlKoKOze2MANRXEhMqdQ1IpwfimKb9FjCipOjjlGK7zzALe27R1TOvufVc6TUuE5uyM2+V9q1M41SmWssnvI9GWdxVtZUNZ6FfDhN5uMHUseGY+8o/DfOHlKTJk0q+LexY8di7NixqV9YsxhAm7Zt8OSTT+LJJ58s+Nk777wTd955Z8ZrDz30UMHrhkIh3HXXXbjrrrvylnfFFVfklfaNHDkSI0eOLFiPI488EvPnz894rRxiTTk2Sl1zzTVo3749VqxYgW7dumX8rb6+HhdeeCGuvfZavPHGG37XkfAbe/Y9glCMcpLvWYtJufVQERH3j6dhRLWNoGqIXHjzIHtjqGsa4oYhNZNmc8J9oPNwWsciJvse2xBylu+xlOp5bobdEKKKfM+e7YwHIrxO3cDke40Kx5RSWr6XFYzd8tLyVl7C1j80TcvwZOIp35NhwE8o9izko2LkewHAapaALlTKDMdGqalTp2LmzJk5BikA6NatGx599FEMGTLE18oRnMg2Sm1ennKjbNddWupOgmC4le+pvfgg+V4hRMRB4SkjCIJRVCYi5S48yJa18JSCOsWTfI95SokwSqV3zWHOOyBLvpf7nZrSRqmQ5s54xxPem1AR8fncEDWNUup5SgVCvseCU2eMPd77T7akLa98z8d5TNbYb9gODVSel0W2T4LWKY4I5iql/HA8Y9fU1GDjxo0F/75p0yZP6Q8JCZhGqbRr+/hBwJMHA1tWSKsSQTCcLuADId8LeFwdniR5ZYWxwfN02wqE7X/Z5UC5yPfMjVwo83UZlBLoXIh8L+0KFOFsDLICNef+zR5PSpV4b1YKeD59R7WNeI3CRqlgyff8GXtyPa+s13kYLWR5ydqbR1fkWciHWK+7zGsSmVCrqIXjlcMFF1yASy65BK+99hq2bNlivr5lyxa89tpruOyyy4rqHwmFyPaUYj8DunkgyotiQWztBMFTheR7hRFx/3huBmmxVxwrnprkingkO5ECz/hkTmmKpzb5Ksr3DMMwr8E70HmxWH1MMlajSDwpgH8KeNXmQiabjCcNxAQYQ93gta10gYaEhJF/7PFqlMr2KreXxyMGky7QgGfHLudV5VnIh8hYo0GIsSUVW0wpQj6O5XuPPfYY4vE4fvWrXyEej6OqqgoA0NzcjHA4jFGjRuGRRx7hVlHCR1jGg2yjlAKZEAjCXMC3MGEHI3YAeUoVQoh8L102j4xpViwOhTugREKcN+K8yfbEVOH7ePKUMgOd8623vV14y/eKeeGplnkP4O8ZkW3EkI297RtjCe6ec25gj4HbcVvkXF5MbudHeaYnU5JPzCFZCV7s11M5ZK65LhEiBVVrbFCVYK5Syg/HRqmqqipMmDABDz30EObOnYs1a9YAALp27YpDDz0Ubdu25VZJwmeYp1QovXAwPaXUOtEiKhMnrur22AFKu2kHPK4OT0SkKrYvvv3Gku+p2/9k4jSLpqpY3gVsY5h6XaaBuSlRgnyP8xhkLz8sSL6X77luNI1S6uxKTbkUp3tgGh0UGYuqwyEzW2VDLIE2UXVilXo9DAlxvod2sufGUo0Y2THHdNvBH3Nk81PqynPeLYb9ekqvCwV63XoN7G8nqHO4E9TtJf5i+NAPRODYKMVo27Ytjj32WB51IUQx/D6gYSPQab/U78w4RUYpQgGKBbFl2P+ksqcKyfcKI0L+pnM83bbq73vRZYHMtOB+kJOWXQE5YmmeUnznd7tMi7+nVOHnWkVPKY2zl41q8j1N0xAN62iIJdCkWAY+tq5wK2eSkX3PL/lednZG+4EBH/mefE8pVZ6FfIj0umP91cv9jURSxuSdO3eWcczo9H5Dci1409zcDADQdXXmxXw4Mkr985//xAUXXOCowBUrVmD58uU4+uijS6oYwZFuB2X+bnpKkXyPkE+xILaMwMQOcChFrEREpCrm6d1C8r3iBL3vZ3tiqiDFNY1SCsaUsssDuRulinjTsux7KsWU4i7fU1CiE42E0BBLKBfsPNsD0ikix7NC8j2vl84+ALIHIuci35PkVZoh31PoWciGZ1iBbEqR7+m6jl122QVr164FANTW1hZ8bpLJJJqbm9HY2IhQgLK/xGNNMOLNiDcZaGxUuNOUQDKZxLp161BbW1seRqkJEyZg7NixuOyyy3D66adj//33z/j7li1bMHPmTLz44ov44IMP8Oyzz3KpLMEJjTylCHVwkuUm40RM4fmPd9alICNUvseh+VXzTlCNkJk/I5h934pZp55RqtqFNC3CPKUEyvd4B9UNmqeUXmL2tJZQLfsekDIKbkLMvB+q4NVDV6QcOUe+Fyotnl22N5RuK4+HfE+Wl2yGfE8lC20WQZLvde3aFQBMw1QhDMNAQ0MDampqlJeI2dnaGMPWhjh2VOvYubFKdnW4EQqFsMceeyh/bxwZpaZPn463334bTz31FO688060atUKXbp0QTQaxaZNm7BmzRp06tQJl112GRYsWIDOnTvzrjdRCovfAravBfY6Hti1F3DwSKBpK1DTXnbNCMJcTBSL3WBffKi0EM+GVS2owZ55IkS+V+JivhiqBRdWDTNuSUD7fvZGTmRw2kI0J9x7SrH685bvxdODckTXuC98i8eUSr2oklGKt0EzO2aQCrD2b1RMvpc028rd50o1DLkhV76X+bpf5WXI9/w0SglsKzuBke8JbB/mwOr1/mqahm7duqFz586IxWIF3xeLxfDxxx/jmGOOMWV/QeDFz5bhuZmrUXdgN9w8orfs6nCjqqoKoVCo6D1UAccxpU499VSceuqp2LBhAz755BMsW7YMDQ0N6NixIwYMGIABAwYEymWvopn5JLByNnD+Symj1PF3y64RQZg4OWWzLz5UWohnIzKNdNAwOCyGs+F5ul1KrIZKgKeXmgiyY4ZZXo+SKgSbp5SrQOdi5XthAevAYvIXFQOdFzOi+UF2zCAVYEYp9TylSpPviYkplfrJ5sZSxx7W70w5oC0+npWww2Nl86CCfE/laVlk+xg+3V9d14tKv3RdRzweRzQaDZRRqskIY9W2BLY0A9FoVHZ1Kh7Xgc47dOiAM844g0ddCFFkZ98jCIVwEhQ2MLEDSL5XkISAjRTPjYQVi0PhDigRFbLVlUJ2zDCV5HteAp3HEnzrzQKd844nBdjlL4XleyrGlOIVQ0aE16lbmFFQtZhSQZDvZUvDtRK9TrPLC9nK4yFDFylPs2NfU6gsU5ITNF/d9pBJ0BOylBuujVJEGcCMUizA+c6NQDIORHcBwuWrqSWCAXOrL7aAJ/le8BGxkeLpJm8FzPW96LLAiQxXZSwPArYxTL0u81lu8mCUigiSirDymRGMJ8UyIaop30v95GXQ4JFBrVRqqph8TzWjVHDke9nZ8vyW7yUNI8eLyg9kyfdUjK2WD5FzYyJJRqlimPH+ArpOKTfU8W8mxMGy7DGj1LMjgEf3BlbNkVcngkhT7BSckSHfU3iyJfleYazYHiTfK0eCfgKZndFML2IIEYWVfc+5wUVngc45x5Rinlhht7t9DxSL78WMIMwoogK8N+nZRgcViIbVNkq595QS9/xnxwjTS/TSzA6cbi+PR2xEWV6yZrspvCYEnCXz8QsVvShVQgUPaMKCjFKVSLanFPtJ2fcIBXASfyMw8j2a8AoiYiNF8j15WN4swez7hdOyS/SUSniQ76WDicS4Z99LBzoXYBnRi/QtM6aUizbiDW+DRrbUVAWiaaNgQ7NiRimPnkGlGobcUGjs8dp/sg0T9nh/BgcvO90cK30r0hEqxlbLh8jDSsOjZ2ClEPTDs3KDumklwmaKbKNUUq3FA1GZFAtiywhO7IDUz6BuzHnCFgE87x/PWC4k3ytO0Pt+blyX1OtSs+95ke8J9pTSRcj3imx6mRGkuqLke+w66gxGpqdUXK3DzoRnT6nUTzHeLZlzS6meNUbWAVCGfI/DPKxxnHeLERT5nsgDG2udonabyMLJfoMQBxmlKpFklnyPBTwnTylCAZx4JLA/qe6mHXRvEZ6ISGPOMs7waP/sDElEJkE/gcyWtaggxW2Op+buKhfH3sxTSlRMqYiA7HvFAj8zI4hSgc5DfDfpKgYzrqlK9QPVPKWyDTROcZKAxS9y5Hslyj9z5Hu2mEbZMmU/kC7fU0nHmgfTyCgkPlnqp0pjg0pQMiK1cB3oPJFIYNKkSZg6dSrWrl2LZJbG5sMPP3RV3vjx4/HII4+gvr4effv2xeOPP44hQ4a0+LmZM2di6NCh6NevH+bPn+/qmhXPKY8CjVuBLv1Sv7PBioxShAJY8TcKvycowRutLDeSK6IgXjcHbjANCRwWfypuBFUiVMRwEATMU/dQtoRGoqdUeiCpjjg3/LANGnf5Hsu+J8BTSi+y6WVGELUCnbcsSS8Fy+jAp3wvWJ5Sahmlsg00TtEdrEv8orB02Ft5wuV7kpJcBE2+J8I7x2tg/0oh6OuUcsO1UeqGG27ApEmTcMopp6Bfv34luQS+/PLLuPHGGzF+/HgcffTReOaZZ3DyySdj0aJF2GOPPQp+bsuWLbj44otx/PHH4+eff/Z8/Yql1+DM3ymmFKEQTk7ZgrL4EJlGOmiIkO9pHL1bkgpuBFXCvscxDCNw8oFC8j2pRikz0LkX+R7fejOjV1jAA1Fsk94UZ4HO1XkweXuOqChbMrPvKeYp5dVzRORcnh1vMWjyPVleskHxCirVyOgGa62sdpvIIuge3eWGa6PUP//5T7zyyiuoq6sr+eJ/+MMfMGrUKFxxxRUAgMcffxzvvfceJkyYgAcffLDg5379619j5MiR0HUdb7zxRsn1qHg0ku8R6uDEI8GU7ynupk3yvcKwU0Ke8jeem8GgLIBlYW+XpGF5twQFlbPvVbsKdJ42SvFy00kj0lOqWMwa01MqrI6nFO8g2Sp6bTJPtcaYWuvKQMj3su5nyfK9AuVlyvf8jCmV+il63WN5BanzHORDaHwyj4H9KwU6OFYL10apqqoq7LXXXiVfuLm5GXPnzsXtt9+e8fqIESMwa9asgp977rnn8OOPP+LFF1/EAw880OJ1mpqa0NTUZP6+detWAEAsFkMsFvNYe/mwunv5Dto3bwGxBhh9jgdqOyC013BoHfdFoqYTEOA2UZFS7lOlwqbOWCxesN2amlOva5r3thVxb4z0iiCWSFIfyCIWiwMANBhF26aU+8QWHM1F+pJXYvFU/WEUr3+50tJ9SSbi5v8bm5pdBedWAeYJZyQTiMVi5rjULHHtwIxSGlyMJ+nDplic7xjU1Jy633oJY7JTNKTuTSye+1w3pMeVSEid5zKZjuOZSBauUynjHDM6JBP+j3NeYQrTHU1qrbWZcZY914wW298QN5cn0nVMsjoarL8nPF3bmmtT3y+ZSPdHw0A8/X/Nx3mMrXsSHNqq2H1qZuvCAn9XhhLvpxsSBfq73wR1r2MIfK5VIN99Uul7uzZK3XzzzXjiiSfw9NNPl+QOuH79eiQSCXTp0iXj9S5dumDNmjV5P/P999/j9ttvx4wZMxAOO6v6gw8+iHHjxuW8/v7776O2ttZ9xRVjypQprj8zfOEtqG1ej+n73IvNrfoA6AvofYEvVwBY4XsdCW/3qVLZsD4EIIR5X32FyOr5ed+ztgEAwkjG45g8eXJJ1+N5b75brQHQsXLFSkyevJzbdYLIvHWpttm4Yb2je+jlPm3aqAPQMPfLL5H8yd+TsO+Wp/rpiuU/YfLkpb6WHSQK3ZfGOMCWGO+8+y5chEFSgp0Nqb4za+ZMrGgNbNua+n32F3Ow8wc5p6qNsVQdZk6fhoXVzj6zcGPqOduwaXPJY2Ux5m1IXWfrZr7XAYC1P6eevf9+vQDt1n2d8bf1m1JtNH/uHOyQdJ+y+XErAISxbdv2FtvG7ThnGIBhpJ6zDz+cijYRj5X0mR9+TvWHn1auxuTJK2VXx2Tz5lT/mDMnf/8o1P4i5/JN6T785dy5aFpiYP26dH//73/R6uevXJe3aFOq7tu3bcXkyZOxagcAhNHQ0IiFixYB0FG/ehUmT/Zn/f/tltT1tmzdxm0syHef2PeKNTdxH4NK4YeV6Wfjp+WYPHkZ12ttSc9bX8yejS3f8h8Pg7bXWbA2dS/Wrl2rdJ/xG/t92rlzp8SaZOLaKPXJJ5/go48+wjvvvIO+ffsiEsmcAV9//XVX5WUbtgrFnkgkEhg5ciTGjRuHffbZx3H5d9xxB8aMGWP+vnXrVvTo0QMjRoxA27ZtXdVVJWKxGKZMmYLhw4fn3IOWCP94B9AMHDV4CNDtYD4VJACUdp8qldc3fIlvtqzHgQcehLpDds/7nh/X7QDmz0R1VRXq6o71dB0R9+bnWT/h3z99i2677Y66ugO5XCOoNM5bBfywEJ07d0Jd3aEF31fKffrHmi/w47ZNOPjgAag7sGupVc7gmynfA6uWonfvXqir28/XsoNAS/dlZ3Mct32RSnwyYsSJZoyZoPD7BdOB5iYMGTIYB3Rri+dWfo6ftm/BoYcciuP37yy8PsmkgRs+TS0kTxxxAjq0qnL0uapFa/C3b/+LVm3aoK7uKG71i39VD3z3Nbp06oC6uoHcrgMA7237Cl9t/BkHHNAXdUdmxh99ePHHQEMjhg05Cv27t+NaD6fM/WkTnlz4BWpqW6GubnDe93gd55JJAzd+luoXI4afgF1rnfUL3jTNW41XlixAuw7Fx3fRTFgyC9i5HUcecTiO7tPBfL2l9hc5lz+z7FNgxzYccfhhOGbvjnh783ws2LQWB/Trh7rDerguL/rtOuCbedh1l3aoqzsS367Zhof/+ykiVdXYZ9+ewE/fo0eP7qir6+dL/Tss3Yjxi+agVevWqKs72pcyGcXu08LVW4H/foaamijq6ob6el0/+Wn6Ekxe8QO69+iBurq+XK/15A8zgYYdGHTkETiid3tu1wnqXic2fzVe+nEBOnRUa5ziRb77xBRkKuDaKLXLLrvgrLPOKvnCHTt2hK7rOV5Ra9euzfGeAoBt27Zhzpw5mDdvHn7zm98AAJLJJAzDQDgcxvvvv4/jjjsu53PV1dWors49UoxEIoF6cArh6XukXUcjkSogEgFijUAyBoSjgB78NlGRculvImCBcrVQqGCbhfTUBjcU0kpuV573Jpyup6GVXs9yQwul2kYvcp/teLlPut5yX/KKkU4QEdb1ir63he5LNSzXqFA4jEjE9XJDKix8S3VV6vvpLIB3SM79boxZAaNbRasc1yFalXpfMgm+9WbPQ5h/++jpcTXfc81iGLWucd5GvGH1MNDyPXA7zsVs6eCqI+p859Y1KeNYc9xQpk4AwFqrKhzOW69C7S9yLjfSYuFIuo66uSby9myFQmy9lHpeqqqs/qiF2Dzm3xwZSStZkuA35uS7T2xdqCu+3gqn490ZENCX0vNYlaA9SND2Omxd4mRsLifs90ml7+16lfjcc8/5cuGqqioceuihmDJlSoaRa8qUKTjjjDNy3t+2bVt8/XWmm/b48ePx4Ycf4rXXXkPv3r19qVdFYKQXtyzr3kvnAstmAOdOBPqdI69eBAFnGdNUDOyaD50CnReExezhGZTUSdB8r/BIpV1O2B/NIPb/7DFGNzMmyfkuTXHL+OAmPhcLdB7jHKGdxeqJCHge2CXyBX5mxruaiDqeeaUGqi6G/dnSFJLIRtN63YaYmtn33IYfERucOnNusQcm90Iiqzw2piWShpVF1s/seyFx2eXsmEHbFZ+TRWZ8y87kSGRi7jfUysdQsXg+uly3bh2+/fZbaJqGffbZB506dXJdxpgxY3DRRRdh4MCBGDRoEP7yl79g+fLlGD16NICU9G7VqlV4/vnnEQqF0K9fpmtp586dEY1Gc14nWoBl2WNZ99hKJoAbB6L8YNnOiy3gszNjqYq5kKV8sznwSEWdjbX49r9s1gcVt4tKw55VMYj9v1Ba9nwZ30TQbDdK6S6MUulsePEE33rH0uWLyL5nGQgzXzcMwzSCRBUySvHM8GTfTPHMZOoWK/ueYkYpj4chpRqG3MDGHi1r7PFqEMvOOGg3sJlZZH1cTNmNXiIJSkZc3tk47ZiZF1VfLEuC3QtZ8zqRiWuj1I4dO3Ddddfh+eefRzI9G+q6josvvhhPPfWUq+Dh559/PjZs2ID77rsP9fX16NevHyZPnoyePXsCAOrr67F8OQUH9h3TKBXK/JlUa/FAVCYhBx4JRkAWHyLTSAcNESd4PE+3g7IAloW9XQJok8rxIBB5up2P5rRltSoccmXIZZ5Scc5HwfF0/cIuDGZeKTSuxhLWJlstoxS/vmNvA5XGItMoFVdrXel13hE5l2d7aZbaf7IPgEI2oy6PeVikV5mdbOObqpRqZHQDG/ZVGhtUgueBAeEe16uHMWPGYPr06XjrrbewefNmbN68Gf/+978xffp03Hzzza4rcM0112DZsmVoamrC3Llzccwxx5h/mzRpEqZNm1bws2PHjsX8+fNdX7PiSWbJ99J6c9NYRRAScbIAY5O56tIpS74nuSIKIuIeOjFwesWsPy328hJ8+V7qpynfC/HrS05gnlLVLo0+kfT749zle2lPKZHyvax7YZeKRRVK9xjieBqfId9TaChi8smGZrXWld7leyIlV6mfvsn3suYqu5yUi3yvgCcjb0i+l0tQDHWycBIuhBCHa0+p//u//8Nrr72GYcOGma/V1dWhpqYGv/jFLzBhwgQ/60fw4PSngEQz0CadjcqU76m1eCAqk5BtwVSIoEinSL5XmKR5Dzkapcy+5H/ZFKuhOJqmIaSlFntB7P/ZRlNTvifpuzCjlJt4UoBVf97yPcsoxd8YZBkIM19vShulQpo7iSNvQmaEBM7yPYUGI+Yp1aSYfC87vpJTWHcSKd/Llg6XLN9j4oh88j0f52GeMdSKERTvZZFS0IThv9GxnJDVV4n8uDZK7dy5M292vM6dO2Pnzp2+VIrgzAGnZ/5uGqXUWjwQlYkT1+/sk0RV4RloO+iY95BrTCl2LX4eCqqfysokpGkZG58gkR3XRbp8z6NRSrR8LyIgppQVnDa/p1Q0onM1drtF59h3VJXvmZ5SihmlvHqOyJDvZcvtvMv38ssBM+V7/vUdkfI0O0ZAvJeFBs0PiKFOFiTfUwvXR0mDBg3Cvffei8bGRvO1hoYGjBs3DoMGDfK1coQgNJLvEepQKIitHSMgpz+yN7IqI8LTiKfkihZ7LcMMdkE0ymbH4pCdSbM5kdrcuzVKmfI9QYHORRwUmMkwsu5FYyx101TKvAdYxgXe2fdUso8z+WQ8aSDGw1XVI17HbZ6GxWzY2GPK7Uo0iCUKjGUJw7CkfT46FsoKW5DIOkhQFZHzImUJLk5IUl8l8uPaU+qJJ57ASSedhO7du6N///7QNA3z589HNBrFe++9x6OOhN8sejP1c68TgKpaYI8jgHAVsEtPufUiCNgW8EUm7MDI95jLfwA35bzhcUKbDdfNYEAyQMrEjP0TwBVftnxPthS3KW1wcStLM7Pvca43u8cRAbK5Qsb+RgUz7wF8PSPsG3GVvMPs96AxlhDSL5zgVc4kci7P8WwqUTpYTA7II2mMLA/xoBwU8cwKnE1QMlXLQlamSCI/ro1S/fr1w/fff48XX3wR33zzDQzDwAUXXIBf/epXqKmp4VFHwm9euxxIxoCbFqWMUkffILtGBGHiSr4XkMUHGaVy4ZGKOhsRWa9IvlcYWQFv/UA1+V5TosSYUpwrHku7d4gJdN6SfE8NAwijUAwsP1A1E211OARNS9WvMZZEm6jsGqXIjq/kFJFzeTKrjqWOPdneMnZvdOZB6adBU1b2vaAkwBEpGfMa2L9SkNVXify4NkoBQE1NDa688kq/60KIgsn0QmqdJhIE4GwBHzj5njrqBWUQcYKnc1xwBOVUVialyk5kYeQJACzbwOw1plTEFsjVMAxumxO2uQ0L9ZTKlu+p6inFX76n2gGNpmmIhnU0xBLmfVEBrwdaIufybLldqdkbWXnZMapSf0v90c/HtpDRmDdB8V6WYeBU3VAnCyfhQghxODJKvfnmmzj55JMRiUTw5ptvFn3v6aefXvTvhAKwgOaabRYyjNQ/AZlzCKIYTiRXgYkdwDEVeNARYVjkufgLygJYJmbGuoD1f3t12aJVthTXNEq5lu9Z748lDFSFeRmlRHpKpX4GRb7HM/CzylL2aCSknFHKai9vRikRY1n23FiqZ022fM8+58aT/s/DsrxKg+IVZPUl/teidUpxnIQLIcThyCh15plnYs2aNejcuTPOPPPMgu/TNA2JhDqTD5EH+4PHjFL/dyXw9SvAif8DDLpWTr0IIk05Zd9j+0HK7JGLeRrM8R5qHBfHImJiBZ2Q6fUYrP5vX6DmeEpJ0u+Vmn0P4Bs3g21uwwKy7xUKFKxqoHOeQfJVle8BqfuwCTGlMvB5TbAhUnKVHXw8ZPN29EJOfDzbEMJHvifHq5S1j+rrwpDAdSF5dBeH5Htq4cgolbT5qyZJhxJskrbFATNKsZ+UfY9QAHMBX2QBluRwuscDnoG2g46Y7HupnzzaP0GLvRbRzf4vuSIuycholhXXRcTpdj6a041YHXZncLEbpWLJJGrAx2DDNrdCA50HJKYUT88RlTfizGONGQtVIOmxvUo1DLkhmeXNVWr/KVQeYMWC81P+GeI47xbDELCm8AORwbXNwP6qN4oknOw3CHG4nrmff/55NDU15bze3NyM559/3pdKERyxG56yjVJJdU6ziMrFyQJMhEHDD2QHR1YZkfI9HieSQemDMtEknZiXir26fkloSoV5SlW79ZSyGYniHC1qYgOdp36SfC83IL9KsPuglqdU6qfr7HsC5/Js77fS5XvZ5eV6T/r52MpKcBE0+Z6IeTEohjpZ8PSmJ9zj2ih12WWXYcuWLTmvb9u2DZdddpkvlSI4YpCnFKE2ThbwIjK3+QHJ9wrjNTW3G3guOLIzGhG5BNU13n6CbaVlD2agcz2kQUOqznGOLmvM4CXieSi0qWtQ1ChlD6br91ygsjyHeaypFFPKqxFPinwva+wpWb7HYkrlke/5uZaSJt9TNOh/NiINnCqPDyoQ1DVKueI6+16h7C0rV65Eu3btfKkUwZFQBDjjTykDVKQm/RoZpQh1MCU/RSaJRNDkezTh5SBiscRVvucxYG4lYbnGS66IS4rK9yR9FybfcxvoHEgtvBOGFfeJB+x5ECLfC1hMKfsYlzQs44AfqJxdy5LvqWeU8izfE5gxjXWbkuV7OYHTbfK99Ljia6BzNu8KXveYXkFqqXdzYEOkCMlYUNbKsiD5nlo4NkoNGDAAmqZB0zQcf/zxCIetjyYSCSxduhQnnXQSl0oSPqKHgQEXZr5GnlKEQljBkQu/xwjIiRirX9A25SKwNgf8rsFXvpf6qeJmUBVknZiXin19yr6DLvm7NHn0lAJSRpCEwVm+x7LviQh0nr5EtrG5UdWYUiG7UcqADv/aSGUZcY2SRqnUT8/yPQFzefbcUurYk+1Zbl838ZbvFXJk4EFQko+IkrXb1z0qjg8qQCE21MKxUYpl3Zs/fz5OPPFEtG7d2vxbVVUVevXqhXPOOcf3ChICIKMUoRBOslxZsQNE1Mg7Qd2Ui0BEsHqeCw6K1dAy7MQ6aP0/mVe+l/pdlhS3KZ7a2Hs1SgFW3CceMC+siAA3Bb3Ac82MH+p5Sln/TyQN+Fk9dktV3IibMaWaVTJKeZt3RBqls+fGUiVG2YYn+1ePcQiUbzd6GYa4dVpC4WfBTqHxy2/s5dPhWX5oja4Wjo1S9957LwCgV69euOCCC1BdXc2tUgRH4s3AkmkpQ9Rex6dmi84HAHufCLTvI7t2BGGdgheT7wXkRIz06oUREZTUyphG8j0ZBHXBl8xzwmxl0pRRI+8xpYDCnkV+EuewuS2E5U2bFVMqbfyoVs4olblJ9xOVvUNM+V5cjQNPwzBsQcTdfVbkXJ7t/VaqZ012UpGU6iXVF1mcOT/nsYxA6oaBkI+egcVQ2WvQjqjDGvt4T+uU/AT14KxccR1T6oADDsD8+fNxxBFHZLz++eefQ9d1DBw40LfKERxo2gb8/bzU/+/ZlDJKHX5l6h9BKICTzC1BCTJtxT6RXBEFsVKZ87sGz42EKbGgxV5Bguoaz4yYmmYt5mXL90yj1P9v78zjpCjOPv7rOfbgVJFbQVRAUaMoHkgAUVHBI0iI94GvmpdovI9oTF6NOVDjTWKiSdRo1BgNRpLgQVQQ8UARI4IKcgnKIecux+7O9NT7x0z1MdM92zPTVV01+3w/Hz67zMxW19RdTz2/p8roMJanlNBA5/Lke4aPkY0bP1TzlHLOU2EbyFXeiKsW6NxLlhsUWbd0McYK5XZWoPPy0rQ8iByNJG4YSDNmBzoPsf0YjiFK5niZkWgYrwRZ8j2vwxXCja5rlGql5NXN5ZdfjlWrVhW8/tVXX+Hyyy8PJVOEQJwSPdpMEQoS5KYZ20tFSpbKJogUsa2Sf3orApFBLK3NoFrha5RChoeOCJiHwTFqr8cwPKVExpTiacsIdO4nf+GeUqrdvucc4sJuP5Y0S8FdJzcO7lTEKOW6VbPE8pIVEJl5GM4qvfnPy3DJ0+aSXlHyPZnxNGV4X4eBdZmP4LJxjjWqG+qiwr7ARK81SrVS8uph0aJFOPTQQwteHzx4MBYtWhRKpgiBsNziwIipv6Mn2iRBNn+6XHMb9UZWZWQsIEWebqssm1EF3eV7zrqVdbrtB799r7aCmFJpgTtEvrlNyJDv+VxgwONu1deoZSl2yfdCrgKV50JuHGxOqSHfq8RzRNZcXkw6HJZ8L5tm9qcIGbr7tkmJnlIKew06EXkBi5NKPAPbCrRGV4uSZ+7a2lqsW7eu4PU1a9a4buQjFIWviJz+ta/dDvyiO/Cf2yLJEkE4CeJOq/I12E5IvucPl7GIlL8Jle9pElQ1SoJIcVXEyxMzHnFf5p5SFRmlBHpK8TKTKt/ziSlVl1DLU8p121nInUHlCxfqa9QKdO7lhRQUWfI9Z/sITb7nYZTiaaZEyPcEegYWQ5t1YQQGTlqmeKPrGqVaKXl1M3r0aNx8883YunWr9dqWLVvw4x//GKNHjw41c4QAMg5PKedr6SbATEWTJ4JwEMRN3r6dRkqWyoZcg/2RsZkSKbnQJdh+lASR4qqIJd9zNE5rIxHRdwlFvicw73xzm5Bx+56PgbAp5ylVV6OWUaqtyve4AZXXS9Q4DT6lGi7iksYyMfI9d3rO33ksuDAPh5xlK1W+p8nlI7LmRedcRbEvvZHVr4lglOzadM8992DEiBHo27cvBg8eDAD46KOP0L17dzz55JOhZ5AIGctTyrFo4waqjBoLB6JtYwQ4RdIldkCli8lqJuMRfDVsRJ5uq+yhoAq6usZ7yfeiliJy+V45RqlqC3TuVxeqeko5bzsLu/2oLN9TzVOqEs8RWXO5l3yv0rHHS9aWL98Ls/1EJ98rfL6KyPLOIfle6wTZbxDyKNko1bt3b3z88cd46qmn8N///hf19fW46KKLcPbZZyOZTIrIIxEmXvI9/nvYwQ4Iogz8gtg6sdy0FZ9o6WYPf2R4Gom8MS3/hiSiEH4Kqdt6z0u+F7UUt9m6fa90g4sM+R73wpIR6Dzm4wHZlItdVK+YpxRg33YWtucIU3gu5MZBfiti1DiXuKWWl6y53BWM3fKUynlzlPlsr1vpLPlerkGGOY85k4pEvqdeV3DBh0ip8cloneKJrmuUaqWsIFDt27fH97///bDzQsig3W7AmF+7r4yK5RZwTI3TLKJtE+RUUJebz+zFJM14+cgISirSU0fECXO1wT3VdHON59n1ku9F9V2aK5Dv8U2QSPleWsAtXn749Wse6Lwuqd7EkB0nWPjyPVZoQFUFbhxsUsRTyhWvqUyjlOi53Mu7pdJ5zMuz3JbviYgpZXsGylz76HL5iCGrLWkS5iJKaI2uFmXN3E8++SS+/e1vo1evXli5ciUA4L777sOLL74YauYIAdR1Bo78PnD4JfZr5ClFKEQg+Z4mBgH7FIYmvHy84vaEje1REX7aloeCevtfZdBVvud1WxX3rIiqL1cUUyr3U+Tte3xzm5RwUmDH6nO/rqp8D7APUNqSfI8bB1WJKVWRfI8vkwX3f2f6fG6sdB2R8ZirLKOUoLVUFAGkdfFetg5eBW+5VB4bVIHke2pR8urhd7/7Ha699lqMGTMGmzdvhmlmJ5tdd90V999/f9j5I2RAMaUIhQgSeNDUZLKN2rtCZURcRZ2PyFMw20NB7TYYJSLlkyIxPbz4ZJ1u+9GS29jXlGEFjceyeRYp37MCnUvQzngZCBljlkxMRfmeqI2olzRLFeqSisWUcniOlDpux43W1yVh4JbvZX9W6nHqdYhnXX5ghi/fA+SVlxNTE88gWfOiNY+pXiAREncYT+nwOHpKXt1MmTIFf/jDH3DLLbcgkbDVf0OGDMGCBQtCzRwhgOZtwIq3gFXv26/t0hfYazjQZd/o8kUQOYKcsOkSZFrWNdI6ort8zwrUTkYpX3SNqeZVt1F/F+UDnecKLSFhUPY63U6ZzNqUKukpJWgjKmMcLRdulFLHUyr7s5wxW9Zc7kyfP7PSsUe2fC/7LP5seQOml4erisgqG5LvtY47KH+EGSEAlBFTavny5date05qa2uxffv2UDJFCGTzCuDxk4H23YAblmRfO/jM7D+CUIAghoSMJidA9tXlNNvlY0sKxHtKiSh+XYLtR4murvFesUnikuQ7fnD5Xm0FRimRXgum5SklUb7n+DpOw0ddjXqaWstrVpB8T0WPzXrLU0qN0BCVxBySJUX2mhetwNhl9l/TY64qCHReBfI9U8KNvmEg64CDVWCEbSvk3xQZB5VVlJQ8c/fr1w8fffRRwesvvfQSBg0aFEaeCJHwYOYx9U4SCQKwFxRF5XuaeKlYC1k6gimAe6MIle8FaEvlorKHgioEkeKqiNfGMOqg7ZUYpfjXSAnMe0qip5RXjB0eTNswypM4iibmkecwMDWQ7zWn1PCUsuRdZTQP64BJcP/3mleMCr3svDzL+bRre0qFLN+LYOzXZU6W1Za8jJGEG+dYoNs6pRop2VPqhhtuwOWXX46mpiYwxjB37lw888wzmDx5Mv74xz+KyCMRJjyYuaHeoo0ggGCnSLosPqKW/KiM9vI9hT0UVCGK0/IwsOvWfi3qvlxJoPO4tQGVEOhcgkHIywOvKZWLJ5WMK9knRbUflaXslqeUIkapSjxHZPX/YlK7suV7Hh5EhYHOy0vbD5Lv+SPb607x4ogUZ1vRbZ1SjZRslLrooouQTqdx4403YseOHTjnnHPQu3dvPPDAAzjrrLNE5JEIEy+j1AePAq/9HNj/VOC0B6PJF0Hk4BN2sRNl5uHJoCLW7W802xUgQ/4mRb6neBuMEl3le3bAXA8JTVTyvQpiStlBjcXknTFmbW5l9IeYh9caN3xw7xzV8MpzGKhsHOe376UzDCkzI8VgWYxK5Huy4wDFQxx7TI/vnd9PRcn3ZBrxvb6nisiKT2YZ6WiN4ku+fI+IlpKMUul0Gk899RROPfVUXHrppdiwYQMymQy6desmKn9E2GQ8jFLpFmDnJqBlWzR5IggHQW5MMyVIv8JA1omYjsi4rliofI+CiLaKrvI9L6O3fXua/O+SyTDrdruybt/jRilBeXfWb1LG7Xuxwk1dU84oVa+sUSr7M+y5QGWJjtNA2JQyIzdKed2qGRRZ8SG9PIgrDZLvLQl0fyZsY3IU8TRlrCnCQJp8L7dOVnFsUAWXfI/W6ZFT0gyRSCTwgx/8AM3NzQCA3XffnQxSuuHlKcV/z6jhYk20bUqR76k+2cYjOC3UBRnB6mXI9+gU0h+S74VDi0N2p6J8z2nskhPoPPsz4+EpVZtUMzSBHQcr3HRtb4hw0w2D2kTM6kNcXhkllXiOyJbveUntMmUWIW9zruDpeWunsJdSURzI2d7L0h5ZFvLle7RG8cMl34t+iGrzlNx1jzzySMyfP19EXggZ8F7nDHTOOyX1SEIBvILY5qNyHA0nlQYorWZMCZ5GIo2ClUhB2gqVnvBHhZd8L0qvx+Z0ZUYp0YHOUw5jl4xA517tSn1PKVHyPXXHIcMwrMD8TQrEleJFX85hlqyxzHvsad17PEiaXnGqOGF7SlVqSCuHjEfZqYg8A6ceRroocY4Fuq1TqpGSY0pddtlluO6667B69WocdthhaN++vev9b33rW6FljhDALnsCx/8MqOtsv8YNVGSUIhSAzxFFb9/T5ATIjo+VNaSpnl+ZyLiuWORGguR7rcPLRje3eObhiRllfLgWp1GqAvmeKWiH6Byr5Rql7NeaFI8pJSomkeo30dYn42hKZZQwSnkZZ4Iiay73OnALEmezGEHke+JiSsmX76m+zrLCCgiPT5Z7nuLlESXOotFtnVKNlGyUOvPMMwEAV155pfWaYRjWIG2a0U88RBE67wF8+2r3a1y+R0YpQgGCLGasE0/FLQLO/GWYvTkk5Mj3RAan1SV+RZREfWNduRSV70UwTVpBzuOxijbUogKdpxzpSgl07hH42Xn7nop4xcEKA9Vvos0aCVNKyPcqKSt3QGRxc7nX2iZWYdvxlO/lFQLJ9+RRqZExKCp7UaqCYRgwjGwfIU+p6CnZKLV8+XIR+SCihGJKEQphB4H0/4wuXirODaSZYcob0WQiRb4nMNC2Ljf9RImsgK5hYwWP9ojrEsVpKveUKke6B9gb6JQgo1Q6N1gn44YULwWvgwv79j01d6SiPEes29oUnVu4kXCnAp5SfE1RTlk5D09EzuXFpHblzmOB5Hthe0pFcMmFLvK9eIX1GRRrjaLmkKgMccNAmrFIDpwINyUbpfr27SsiH4QsmrYCG5cCNe2BrgOzr7XvCvQ6FOiyb7R5IwgEO2HT5QTIuW6lUxg3MuV7Iope5QDDqiDrGvWw8RpfZJ1ue8GNUrUVGqXSglbd3AMrIakzeHmtaSPfCz2mFE9fzbmwNlcfKsj3Klk3yJrLvW/fy/4MU76Xb1ML22M5Ci9Z1fsCx5BUNkyTdXLUZMuHabdOqUYCGaWmTZuGMWPGIJlMYtq0aUU/e9ppp4WSMUIQq94Hnvou0ONbwKTZ2dcGjsn+IwgFCBIcXJebz5ynqTTfuZHhaSRDvqf6DZBRoq18z8OLr1IJTSVU7imVzXRaUOZ5ujLiSQGteUqpaZSKC/K0U12+V5/zXFPCU8qKRVn637pu6RI4BnjdLFxpDKJiaVr/FyTfk2nENz2+p4o4y1pkfDIKMRAMXQ/PqpFARqlx48Zh7dq16NatG8aNG+f7OYoppQEsVz8GHe8TamIv3v0/I0P6FQbOxQAFUXQjYzMlVL5XQdDctoKu8r1i17LLlKNwWnLrqnKNUnZMKVGeUtl0E5KC5ukYU0qU16YdR0fNcahOQU+pcsrK+Tci53Ivb59K49l5GSfyDRWhBzqPQL6ny63MrraUYcLGTV3WyVETJGQIIYdARqmMo6YyVGt6w4OZx9RcuBEE33AUO2HTxS3ZmT06hXEj4xRPpHxPdQ8FFdD1BLKYfC+K79KctgOdl4Ml3xMc6DwhKcJw8dv31DxwE9UXMoobx+uVMkplf5Yz58iay+0LQOzXKh17vDzECuR7wm7fCzXZoli3zSk+KTv7qsjy0SXMRdREcVMk4Y2aszchDm6UcnpKff4ycO8BwN8uiCZPBOGglNv3VJ9snW7kdLmlGxkBekUuNrxuNCLcxCPYmISBl3yP13MU69aK5Xu5P0sJk+/lAp1L6gteHnjc6KGqp5Qor03VZcS2p1T0E2AlF6TImsutedHxvHiF85jpMdcWBDoPue/GrQMh+fI95deFrluZxZUPrVGCEeWBE+GmpEDnmUwGjz/+OKZOnYoVK1bAMAz069cPEyZMwPnnn6/sSQ3hgN+wZzgWbukmoGE1sK1PNHkiCAe2TMb/M7osPki+508l8T2CwhcbIsredo1Xuw1Gia4nkF5Gb8MQY1QIQnNIt++ZogKd802vLPmexyZiZ0t2bVOrqFFKtHxP1X1nnUK371WybpA1lxcbe8oderwuFckvg7CnMUPg3OuH6n2BIytoPoUYCIYdL1KvdUo1EniFwxjDaaedhksuuQRfffUVDjroIBxwwAFYuXIlJk6ciNNPP11kPomw8PKU4r+TKwehALEAJ2z8PUlqkbKJSToR05GMhFM8kRICW2ZBCz4/rNg/mrlKeckeKvVWqISWCuV7vImmBMn3uCwwKen2PctA6IwplSsjVQOdi9r4qC7R4XJKFeR7ldz4Kl++5xh7Kmw7xdLkVIN8TxfPIGdZy5HviXtGNaDrhSzVSGBPqccffxxvvvkmXnvtNYwaNcr13uuvv45x48bhiSeewAUXkARMabxiSvHfWfSLBoLg+5piHgk6nQDFjOxkp9vGXDQZCZ5GIgNt04KvdWIexgMd8AqIHKWLf+W372V/Vkugc8tA6Pg6qsv3LK/NkMciU/E4OvUqeUplyj9IMAxDylzuefOn4X6vVLwCXudPu6HL9yK45EKXdaHL605kW1L8EgRViPISE8JN4BXOM888gx//+McFBikAOPbYY3HTTTfhqaeeCjVzhAC67geMuBH41pn2a+QpRShENcWUAugUxg8Z8j2RgbZ1aoNRoWvb92qblUpoKqElZ3mordQoJSjzPFZVQpKnlJc3reqBzkX1BdWN49xzrVmFmFIVlpWM8Swq+V7Y7ScKI77qfYHjzJ/ImFvcaK+6kS5qKKaUOgSevT/++GOcdNJJvu+PGTMG//3vf0PJFCGQ7oOAY28BDj3ffo3HlyKjFKEAQWJv2CdAMnJUGaRX94Z7z4gM0CtFvkcLPl/4Yk9msNswsLxPnPK9CPtxeJ5SYvLOY1XJ8pTyilejuqeUKPmn6jfR1tfkPKVaoveUqkS+5/w7oXGAvKTDFQbJL5YmJ2zDRRRGfF08g0i+pxYib2kmSiPwCmfTpk3o3r277/vdu3fH5s2bQ8kUIRnuKZWJftFAENzQVEzyI0P6FRaiZBu6Y20QBK6YREkIGGOODU6oSVcVsQo3U1FRVL4XwXfhRqnaRHkGF573tKBA5zxWVUL27XuOqthpeUqpaZQS5bWpunyPe/c1paNfX1Yi38v+nTsdEdjxnxzPrdC472WcyC+CsA+HRN02WQxdPIOc7U+KfE/x8oiaKNoq4U3gmFKmaSKR8P94PB5HOp0OJVOEQHZuBhrXAbUdgc69s6/VdsjK+nbdK9KsEQTgPGFrXb6n+uIDoFMYP2Sc4onaCDrXLjoYRqNCV/ke89zERS/fKzfQOXdgEh3oPCHJddVbvqd4oPM2Kt9TyVMqLPmeyLncy/Ot0rZTTBKY/4ywiMJLVvW+4ITHJxMq36MQA4EQGeaBKI3ARinGGCZOnIja2lrP95ubm0PLFCGQT/8FTPshMOAk4Jxns6/1OQq4/L1o80UQObyC2OZjnwDJyFFlRHlrl8qYErzdRJW9Mz1VPRRUgJ9A6irfc27copThNlco3xPtKcXTlecplf3pPNnmRg9VY0qJ9NoE1PWGqMt59/HbEaPEuvG1zLKSMZd7SYcrvTCCtzmn52d+GYQdDi4KI75OnkHxmIGMyeTI99QcEpXBy/OWiIbARqkLL7yw1c/QzXsawG/YM2iUItQkWKDzytzwZeIV/4SoPL5HEGKCFhvOzbAGTTAyrLav2WrPa3MTpQxX9ZhSsj2lvOLVNOfkYdwzRzWEyfesoPxqDkS8PpqU8pQqr6xkzOWeUjt+F1GF8j3DI03r/6F7SlVmSCsHnTyDsv2VCS0fGQd/1YCMWHFEMAIbpR577DGR+SBkwYOZk1GKUJQgi3ddYgcAtmFEN28R0cgIFC7qVhVncrTg80d7+Z4rrkt0MlxucKnYKCWoIrinVFKShdZqV16eUmXG3RKNOPmeO33V4J5rKsSUqvTGVxlzedXI9yo0pJWDjBt9w0JGjEIZB3/VgCGhLohgkGWireFllPr6I+A3RwBPjo8kSwThJIgrrVZu2ppuzEVjB50V9wxRJ2DO9FS/6SdKdJWu8rZpeG4MI/SUKtMTKWZk85w2BQc6l6Snzm9XjDFLHqaqp5Qo+Z7qN9FyI6EaMaWyP8sds2XM5V6B6y2vozIfHK18T954aXp8T1WJSzjk0ElRECW0RleHwJ5SRJWQ8TBKpZuBDZ8DZks0eSIIB16n4PnoFNDSqHBBWa3IOOG321K46Tpd7jWwi0aGKE810XjFnrHke1EapRT1lOJjW0JS8BLbmzb7M2UyKw/qekplf4ZuIFdcolPH5XsqeEpVWFYy5vJiN+WV23Y85Xt5RSBMvicxlJhOnkEy5I22fE/YI6oCku+pg6JnK4QwuKdUzLFw4wYqFn0gSoIIsgCzDBoazLb8BJsmPDdWgF6BdShqseEcKnXw1ouKIDdpqojXxtAO2i4/P/z2vVpFY0qlcvmT5SnFx32+oXMaPOpq1FzWipbvqSpltwKdp6JfX1Ys35NgZM94zIuVjj2eMfLy5l1Rt+/JHPt18gySceObTka6KKHb99RBzdmbEIeXfM8ySlGHJKLH2nAUWb3rFMBRlLeO7pgSvN1iHrd0hYHzdFOHNhgVcasvR5yREvHa3ETp8Vipp5T42/fkekrZ0pecUSonDTOM8iWOohHlGWFLlkJNNjRUCnReqbzLlmCGlqUCvGItVizf8zjEy5+3wj5cESVXLYZOnkEyysf0aEtEIfEAew5CDiTfa2v0PBgY+sPsT44VkTD6RQNBBAkorJN8j1yDveGLMZEn/OK8E0i+FwTeP3UL8u8lLY1SisiNUpV6SqWE3b6XC3Quy1MqT77HvXDqk3FlPYZEBX72CoytEioFOq/Uc0TGXO51iUulnhzFJIHWM0I2anrdkCkanTyDZFwCotM6OUqivMSEcENGqbbGXsOy/5yQfI9QiCCbP/6WDgEtYyTf88Qrbk/YxPI8KsLCudhTdROsArrK97xO3FWQ71UaU0rUSXC6Qg+UUsn3WtuZyt28l1QznhRQubeLH6rL9+pzdZIyGdJmBokIXboq3aTLkPlw75a4x9hT7nO9PMvz+2o1yPd08gySMTeqfjOnKuga+7IaUdThl5CKkVvIkVGKUIAgMgev27FUhTylvPGSKYQN3/+ELZnhp9m02CuOrvI9r3hnoowKQWi2bt8rz+jCv0ZKUEXwWFVJSQYHZ70wxtCUM0rVa2CUCrv52EYMNccip6GQ35AYFZUaLSo1DgXBy/Ot0rbj5UGUv3YSJt+LIqaUml3BRVxQaAEnXrcuEoUECRlCyIGMUm2NnVuALauAnZvt1xK1wC59gE69I8sWQXBisdYXYDotPmS4aetIpUFng2CdRgq6hp2MUsXRXb4XpoSmElS/fS+Vs9ImJA3IzsdkmO0pVZtUd0krqi8wxedCp+R0Z8RxpSr1HJEjucr+FCPfK5Qj5z8jLETNvcXQyTNIhmRMxhqrGqA1ujqoO4MTYpj7B+D+A4H/3Ga/tnt/4OoFwPffiCxbBMHJD2LrhSXf02C2tVyDacZzwb2NRJ7ixQUt/OxA2OGmW23o6iVYTL4XRTeu2CjlOJUXYSDknlKypFnOgM1mRhNPKUGn8ZbXpqJWKcMw7LhSqWiNUpXe+CpjLvcKXO+cx8rpv9Z45pGm9f+Q2088go2+Tp5BUuKTaRTmIkqC7DkIOdCSuq3hdfseQSgEnz+L3r5nnQCpP9mKunVJd2R4G4kqe5LvBcMu/4gzUiLW5tVTQhOFfC+7mS/3ZjlnfBoR3lJ8rJbnKWU/J+OQ7+kQU0qUfE/lsYgbC6M2Stmy//L+XsZcXky+B5TXfrw8iPLXTtUQU0onz6CYoNACTjIZ9ccGFeDFQ2v06CHLRFuD37BHRilCUYLc2pKp8MRTJlEGSFYZGd5GoiRXGQ+jBVGIrgFEvSQ0URqlKg107hwm0wIshDxWVULy7XsAN0pln1+nsHwvLqj96CBlr7OMUtHGlApLvidWcpV7ljOeXcxthC0VLw+xwkDnJSdblCjGS508g0RdwuJEJyNdlJB8Tx3UncEJMVieUo4TxYavgUeOAR49KZIsEYQT54LCz00+4yGvUZX8m6KI7EJMRvwHS3IV8l7IpMVeIOzy16vtmx6buCAenKLg8r3aCmNKAXb8pzCRHeg833NED/le9mfo8e00kCzxetkZsadUpWUlIyCy1015zuyW82zTw3Dp/N0wwvc6t8sq1GSLopNnUNwQXz6qX4KgCrquU6qRyI1SDz30EPr164e6ujocdthhmD17tu9np06ditGjR6Nr167o1KkThg4dildeeUVibqsAL/memQK+ng98/VEkWSIIJ/mn4F7oFdAy+1M3bxGROItChnwv7LK3JBYKbwRVQMa11yLw8j6R4SXhR1iBzgFBnlLSA527PUfsQOfqGqWCeACXg5dXn2rUKiLfq9RzRMZcXmzsAcobfzKWbNFbEihiDib5XnFkXJzhdesiUUiUl5gQbiI1Sj377LO4+uqrccstt2D+/PkYPnw4xowZgy+//NLz82+++SZGjx6N6dOnY968eRg1ahROPfVUzJ8/X3LONSbjId+L5RZyTLN7u4mqxMg7Bfcio5FRgOR7hTgnf5GneKIWxpZMgBZ7RdHVLd5rMR/FFeccyyhVpidSzLAX3mkBnlKmZG8d18FFxpbvqewp1Zble/U5WWXknlIayPe8LnFxeY+XJd8rTDPm4QUaJjLkafnoJKuXEujcI8A9UYiu65RqJNKmeu+99+Liiy/GJZdcgv333x/3338/9txzT/zud7/z/Pz999+PG2+8EYcffjj69++PX/3qV+jfvz/++c9/Ss65xjDrqhb7NW6gIqMUoQBBFmBet2OpCsn3CnEGlBQZ3i4WsxcbYS6OTY+TZ6KQuCDJkmjs26qcgYHd78mEx5SqrSBmEvdiEuEpJVu+554jbGOHyjGlxBnI1Zfv1SnmKVWu0UKKfM/jEhdndssJxuwVDN/PEyssIpHvecTjUhVRoQWc6HAJggqQfE8dElE9uKWlBfPmzcNNN93kev2EE07A22+/HSiNTCaDxsZG7Lbbbr6faW5uRnNzs/X/hoYGAEAqlUIqlSoj52rA817qdzB6Hgrj0IlgPQ8F43+bNpEEwJiJtMZloiLl1lNbxkynrd+bW1oQ9xim+OSRMc2yy1ZW3RjI5jWVTlM7yNHi2JyY6TSKFUsl9eRsSy0tqdAWqy25vMSMttu3g9RLJrfiTmcyWpVT2sy1T0e+M7nXMoxJ/S6ZDEMqZ/QxWOnlyD+fiBlImQw7m1uQSoW79GvJ3Q5oQH49t7S0YEdz9pm1cUPZdsaN4um095xV7jiXzu36Mwr3sdpEdtzd3tQSaR5TaT7vFJZVkPKXMZenPfJoOiw7LS0ppEp0COTGONO0880cG3Ah81jukDtthltWxerJzM03lawLZdOSFrcXtdqShDlL670OaztrdK96Uuk7R2aU2rBhA0zTRPfu3V2vd+/eHWvXrg2Uxj333IPt27fjjDPO8P3M5MmT8bOf/azg9VdffRXt2rUrLdMKMmPGjBL/IgbgWGAZgGXTAQA1qQaMQXbBO3369JBzSADl1FPbJavEyA5NL7/yKuo8FmANjXEABt6fOxdbPq/sdEN03WzdksvrB/PQspxOYgCg2QR4Hf/n1VdRE2CRXU497Ujbz/n3Sy8hrMvBVm3LptvS3NTmx8xi9fLJNwaAONavX69VOS1bHgMQw9KlSzE9tQQAsLUFABIwM3LnSed4OOu1/6Cu3FVbxgRg4PU3ZqJbfUiZy/H12mx5fbrwE0z/ZkG4ifsQQxwZGHj1P6/h89XZ569asRzTpy+V8vxS+XJlNo+Lv7DblBeljnNr1jjKfoOcsi+VzRuyeZz30QK0X/dxZPn4fFV2PFq9ahWmT1/p+Zli5S9jLv90dTaPX69ejenTs6FMsvajbMd/5dUZ6JAsLc1UOpvvWTPfwK612deWrcrWCQBkMmboY9qqL3PtffEXmN60ONS0Ae962rY9+z3ffedtrP0k9EeGyrbcGnbue++jcbGYtrQ4VwervlyJ6dOXC3lGPjrudb5Zny2njxcsQIf10Y1PMnHW044dOyLMiZvIjFKcfPkDYyyQJOKZZ57BbbfdhhdffBHdunXz/dzNN9+Ma6+91vp/Q0MD9txzT5xwwgno1KlT+RmPmFQqhRkzZmD06NFIJkucofLZsRHIDeBjx4zRI0qgJoRaT22ElnQG17/3HwDA8cePRqf6wnJ7YMlbwM4dGDr0SByxl7+nZDFk1c2TX8/F8sYtOGTwYIw5sIew5+hEY1MamPs6AGDMSScWDVBcST01NqVw8/tvAABOOPGksm8vy+fj1VuBBe+hXX09xo4dEUqauhGkXlIffY2nvvgEu3XpirFjD5Ocw/KZ+89PgbWrMHDAvhh77L4AgG8am/F/82aBwcDYsWOl5aWxKQW8l23DJ48tvQ3zeqqtqcHOnSkM+/YI9O/eIdQ8Pv/NPGDzRgw++GCMHdwr1LT9uH7uDGRMhlHHHouPX1sKrPsKB+0/AGNH7i3l+aXy8cufY+aalei3994Ye+KAgvfLHede3DQf2PwNvnXQQRg7ZI8wsxwaM5s+wUcbv8beA/bD2OH9IsvHkte+AFYvw159+2Ls2P1d7wUpfxlz+bI3lgKrlqJPnz4YO3YQgOy+6Jp3s5vI4447Dl061JaU5nXvzQAYw3HHHYseneoAAEvfWIqXV2cNuDXJJMaOPTHEbwHM+/dnmL32S+y9zz4YO7p/aOkWq6c7F70JNDfh28OG4Vt7dA7tmSL445fvYvX2Bhw6ZAhGDewq5BmfzlgCfLUc/frthbFj9xPyDI7Oe51/b/0ICzavx/4HHIixR+wZdXaE4lVPXEGmApEZpXbffXfE4/ECr6j169cXeE/l8+yzz+Liiy/Gc889h+OPP77oZ2tra1FbWziAJ5NJ7TqOFyV/j+ZGIN0CJOuBmpynWE0t0G53wIhlY0LEI7dVVh3V0t5kYMRsV/V4IuFZbgxZw2lNCOUqum7iufhtsXic2kCOuK2qQ01NDZIBNtrl1FNNxjawJxIJJEMKhByLZ9OJxYw2X6fF6iWZzM0lBvQqp9zBTCJujz81NdlxibFsW5IVT8xsssfD9nU1ZT83mXMTZLFY6HXBw1TV1niP1yLIlgNDPJ5Acy4D7epqlG1nidyYYRjFx4ySx7lce0j6zJUq0K4mOw6kMtGOA0ZuLk7E/ftAsfKXMZf75dEwsmNPrIx65vK9Wsd3S8btuTDWSpssB97eIWC8AbzrifsbhbEuFE2Mt6WYwHWhwduSvLWnjnudRJzXhZi2qiLOelLpO0cWFbKmpgaHHXZYgavfjBkzcPTRR/v+3TPPPIOJEyfi6aefxsknnyw6m9XHjFuBX+8NvP2g/Vr9rsCNS4EblpBBiogcZ8BWv4CidqBz9b364hKCo+qGM6CkyAC9zoC2YZa/DsGFVSCmaZB/u37t15xtSebX4UHOa+KxigxhfOFdDYHOAbs+zAyzAmirfPueqMDPXkH5VaPeCnQe7WU6lZaVjLk843OTpXV7Y4lFyBjzDADu/F3EPBbFJRemRrfN8VAC5QSuDwqtU4Kh6zqlGonUAnHttdfi/PPPx5AhQzB06FA88sgj+PLLLzFp0iQAWendV199hSeeeAJA1iB1wQUX4IEHHsBRRx1leVnV19ejc2e1XTWVgd+wJ/LKK4KoACPA5k+Ha7A5Mq6R1g3nDVQi69C5hw/z1qtKrxZvK+h61TLf+Bmu26rct4LGIafuW9I5o1SF0lPr9j0BlZHOFZjMzQ9/FGP2rW5t+fY9ledCdW7fy/4sd9yWMZf75TGW8wwstf04Px7zGc9EtB177Jc3+Os0L9ttSbyBU4PiiBRd1ynVSKRGqTPPPBMbN27E7bffjjVr1uDAAw/E9OnT0bdvXwDAmjVr8OWXX1qff/jhh5FOp3H55Zfj8ssvt16/8MIL8fjjj8vOvp6w3KKARilCYWJGdoLwm7D5yzqcAPETSZmLM9Xhk79hFMYVDJOYIO+WTEb9jaAK2IYDvdq+vdF3ehYUvi+D0I1SAu5o54auZFg3CQTAOt1menhKxQVtQpkGG3FuLIzaKMUqNOAZggyLTrzGHiA3/pilP9v5eae3p9OpUcQcbESw0WcaeQbJMIToZKSLEl3XKdVI5Fqtyy67DJdddpnne/mGppkzZ4rPULVjeUo5Fm/pFuDJcdn3zvs7UNM+kqwRBCceM5Axma9rs07yPT7hkWuwjd/CO2yci9MwZQSmpPzrTkxT6appbW7s11wGTokqJMsoVaE0LhEX5ymVysn3EhJ1M05j/07LU0pdo5ThMKKFiQ7yPV4vOyM2Sukg3zN9DGeWEaPEscfZ3gyf8SwuYB7jw5XMsd+v7FQkJqF8LPkerVOKous6pRqJ3ChFSIZPUPnyvZVzsj/NlNz8EIQHhuWq7v0+n2x1mGtJvleILMmJM/0wT7d18E5QAV3d4r3qN1++J4sWM7uRr61QmsYNRikRnlK5NBNSPaWyPxljVqwilY1SovoCyfeCo4N8zxp78iq0XDmcn3zPLU0uMZMBkCFPy8eWqyncGXLIkDfqMDaogK7rlGpEXQE+IYYMl+85j0wcCzkWbSBKggAc8Td8Zgn+sl5u2jTjcWR5ugWJT1YO1mJPg/YXJbq6xZsem5uo5HvNIXlKcWmdiNNgnqZUTykrOC2ws0X9mFKiAj/rYCCvtzylol1fVrpJFxUXzInf3Gh5XJf4bGd/d8n3HMlXi3zPWhcq3Bc4cuKT6WOkixIZ/ZoIhrozOCEGbnRyGqKcBirqlIQCxFsx5MiSf4VBuYvJakbmRioeC98oaG8cQkuyKrHc4jVr+7bswX4tcvlehTGleD9ICbh9L5WJwFPK0a+b07mYUjXqekoZgg4ndJASq+MpVZmcyRnHTBR+hjPe3ks18Dvbm/NrC799T0JZ5aPVulCGFDQ3T+lweBsl1hqRXKUih+R7bY0+R2UNUl0H2q85B3AW7aKBIIDW3Wl1cksm1+BCZNZfzABMhLsZ1ME7QQXKjYMSNV4Smsjke2EFOs+56qQFVEY6Z+hKSvWUyv7MMGZ7SiXUNUq1ZflefY0agc4r9RyRMZf7zS3lPtv5ebnyvexPqfI9rcI6ZH+KnEsqDezfVojCq4/whoxSbY3DL87+y8eIZw1SJN8jFKC1G+sykuRfYRAv84SzmpEZnNe+Sju8NEm+F4zWPB5VxUtCIyo+WWu0mCHJ96zb9wQGOpfoKRV3GDyb0urHlBIl39NBys6NhdEbpbI/yy0rGXO539xoy1VL9JRyyvec3lEuaXL4bcdaw0ncUmQ08gyyb+MU9wxapwRD13VKNULyPSILl/CRUYpQgKAxpXQwSvEs0s0eNjLrz/bWIfmebHSN1eAlAzEMw+7LMmNKpcLylMoZpYTElMrJ9yR2CH663Zw2rf5Yr7BRSlRsQR0OaOpq1Lh9L1PhuC1jLveV75U5ljo/70zT/bsAoxTJ94oi6jZOJ1y+p0N5RImu65RqhDyl2hqpJgAMiNe440rVdgDMNMWUIpQgqHxPixOxWPHv0hZhEutPxIJDp4CqUaKrW7xtNHW/HjMMmIxJnSa5p1RtSDGl0kJu3+OeUhLle7lHbW+xDR2V3lAoEtHyPZWHIttTSo1A5yrL9/wObMoNjO3Mq1uyJ0e+J3Ojb3sGSXtk2ZB8Tx1ExfsjSoeMUm2N5/8H+PzfwKkPAIdNtF//0YqockQQBbQWBNK+HUtalspGhKeO7pgSF0siAorqdCIbJboGEPWTPcQNAyaYVK/H0GJK5XZqKQF5T0XgKcUNwjua0wCyc0GlhjuRiLrwgrdFlQ9oeAD6ppZoPaUqDfwsYzzL+NRnvMx5zO8Azy9eXljIHvsZY1p50MsoHx0uQVABu29FnBGC5HttDh7I3KCqJ9SltVMknQJNGxGcGKoOj/0g46piEafbOngnqICubvF+Rsco+rJllKo0phSX7wn0lErK9JTiRilHkHOVrz4v9/a01tBhLqzLebA1paM1SlXqOSKj//vNLeU+uzU5YPb38NuObC9ZZ7Go3Bc4UXrdEW6iCMpPeEOWibYGjxlFRilCYVpzVddKvqephEkklV7NXQoiFhw6BBdWgWqT79mBjuXlxQp0HpKnVNheXowxK06VzP7Ah44dLVlPKe6NoyqibqLUwUDOY32lTCbEKBqUSj1cZRoS8ufGcsMA+BkmnH1VhNxN9oGE8zk6yOplGjhpmVIcUfH+iNIhy0RbwzJK5S3gnpsIPDke2LpaepYIIp/WgmSaGizEOTThFSJzsWS5ZodplNIguLAKlCs5iRo/CU25N2BVQnOax5SqzOgSz3lKpUK+fc9ZFkmZt+/l6ma75Sml9nJWVOBnU6KBv1yctyLymxKjwPQx0ARFxi1dfoazctcRfnOV06tQRNuxjWhyxkpnv9LhzF3G3Og3jxFuYiTfUwaKKdXWyPjI95bNAnZuApq3yc8TQeTBT+68FjTMEWhYB6NATNBV4DrDi0KG3MYQ4KGgg3eCCujqFu8XEDlS+V6FRpekoEDnztv8pAY6z5fvKe8plf0pTL6n8MbTGetrZ4uJDrXRbD0qPQyRMZe3Kt8rM6ZUMfmeiHlYxLxbDF3leyKnkkoD+7cVdA0zUI1oYE8mQsVPvsf/z8hUTERP3JqwvYxShZ9TGRku/7ohMziviNNtku8FQ9e2b2a8N3JR3KQZWqBzHlMq5My7jFIS+4NllMoFOq+r0JNMNCIuXAD0uHTBMAw7rlQqurhSld76KmM885sb42V62lljmU96Xs8KAxleZU6c/UqvdaFIA2f2J61TilNsv0HIhYxSbQ1udMoXkcfi7vcJIkJsmUzhe85FmcoLcY4o2YbOyLyqWMQpGMn3gqFr2+fZzd/cRCHFbTGzm/hKA53Hc3N+OmTXBafnlVSjVK44uHxPm5hSITcdPwOqavC4UlEapexbeyszSokcz/y8wMv1rPGLKeUsAxFtJ8qYUjpMy6Ju43SS0WRsiBpD03VKNULyvbZG36OB+l2ATr3dr1ueUtHejkIQQHGZjGvxoYFZXVcJk0hk3gojItg2BRANBjcc6Nb2/WQPUbj5N6fClu+Fm3dnjCqZJ/K2fC/nKZVUezIQ1XZ0kbJn40ql0JSKMtB59mf5gc6zP0WOZ35zS7nSYb8DINHyPdless7nqN4XAJLvqYSuHt3VCBml2hqjfuz9Osn3CIWwZDIes4TzoF8LN21Ngz2LxE9SIAIRAUVNa6GvfvuLEktyolnbt4JHKxDonN++VxuSfC/sQOfc8yoZN6RufnhdbG/OeUol1faUEhX4WaYUuhIsT6l0dAefduDn8v5exlzuK7cr89l+Y5nz/yLWUbLXPc61oup9AZDUlnw8fgk3cYr7qgxqHy0R8jBIvkeoQ7GTC+eiXgejAJ3CFBKFfC/M022Znl46I8JLTQZ2/bpfl3G6nU9oMaVybmtm6PI95kpfFrxuuKdUreJGKVGBn3W5dIHXz86WCI1SFXqOyJjL/eaWsuV7PIysT3pAYTSPMIhSvqeBTUpK+VjrLNrpF8Vep2i2UKlCqKm2Nfw6nWFkvaWoUxIKUGyScC0+NBjB+KmdbhImkcg06ojYSFQaMLetoOutNszHE072NeeAwyhVYUwpHu8pJSjQucx4UoDDU6pFE08pQRsfXQzkKgQ610G+Z80t+UakMseeTCvpAWLajmwDvn2jrx5yNTkGTvLoDgIdHKsDyffaGn84Fvj6Q+CcvwEDTrRfv+q/6h+1EW0Gvv/yCjzoPGnWYbLlWdRNwiQSmfI3EW7ydsDc0JKsSorJcFXGT0ITRV/m8r3Qbt/zuj2iAnh6PH1Z8Lqxbt9rozGlMpoYyLnRcGekRikN5Hs+nh2NeKYAAE92SURBVG+xMscevxhVzv8LMUrJlu9pZoCRMTfalyDoUSZRQfI9dVB7FifCh8vz8iNE06BFKIR9ytaKp5QG7ZZOYQrJSHQrJ/ledOja9luT78n8Ps1pHlOqMk8g2yglJtB5okJPrlKx5Xt6eEqJkrLqculCXa5+miMNdF7ZJl0F+V6pz7Y9iIrI9wS0najke6r3A065getLgdYpwYjiVl3CGzJKtTX47Xo0SBEKY00SHutX3WIHiJJt6IyfREEEJN+LjnIlJ1HTmnxPphQ37JhS6ZB31GZE8j1eF/bte2obpURJPzOaeEMo4SmVW0+UW1Yy5nK/uSVe5KCuGH6edM4yEDGP2fkNPWlPdDPAxCUYOFmFnoFtBV0Pz6oRaqptDT5D5HtKvfxj4K/nAusWys8TQeRhuap7rGic7u16xA7I/tRtYy4S0yf4qgisG9NCLH+S7wVD17bvJ3uIRL4XmlEq5ykVcqTtVCYi+V5eTCnVjVJWXwi57eiyGa9VIKZUpbJxGeOZ39xiFFkTFcM2Wrpfd/5fxDxsCJh3i6GLcZYj48DGbkt6lElUFNtvEHIho1RbI8M9pfIWcMtmAp/9C9i2XnqWCCKfYvI9pskinEM3exQi09WeSwTDLH9dNoJRo+sJpH8cFvnfx4opVWmg85zRKBWyfI/LAZOSb53g4yo32qlvlBIt31N7LFLBU6rSW19lzOV+9VmpfK8gPVeg8xIzGQCS7xXHku8JnExonRKMWAQe0IQ3ZJRqa/jGlIq53yeICLFPkQrf87tNRlXiRb5LW4UvxGTI38qVPRRDtzYYFbrGauB9NSwJTSWELt+rkkDn+Y9TPtC5oMDPMuPzVQI3GjZFGlMq+zP/AoOgyJjLuSNjwdhTZmBsv0sbhMv3JK97/L6nqpB8Tx2KhQsh5EJNta1hxZTKq/oYGaUIdSh204xu0ilRsg2d8Qu+KgJLRhDi0GZJBWgGLYodZF6vU8iMJRH2ke9J/C7N6eycXVuhUSrJA52HPA6lLQOz7EDn7rpRPdC5sNv3KoyTJIt6yygVoXyvQomXjLncz+On3MDYft5houV79kZflqeU+7mqI+PAxvSZxwg3IkI8EOWRiDoDhGT6Hg3suhfQbjf36+QpRShEsQmb5Hv6I1W+J2AzKNOopjPOPpphhd4tqqKUfC8kTynuuRD27Xs8RlVScuXm9z1d5HthTwO6yPfqFIgppZN8z++2vNDke67b90TElOLPlzNYVlq3spEhb9TFYB01Im5oJsqDjFJtjdOmeL/OjVKZ6BYMBMEpdlORKVH6FQZxS7YRcUYUwu9GIBGUK3soBj9RI/lecZxSCjPDtOmzYUtoKsEySlUaU0pUoHMzqtv33P9X31NKzGm8qZl8L8qYUnZZVSbfEzmXc5tx/txStnyvlZtEs88qNZetY5eVnLHSlLimCANRcl4nFGYgGDLqggiG4tMYIQ0e+Jw8pQgFsE4kPZqjfZIoM0flQ6cwhcg83TcEeLfodiobFc7y0clT0D/YsPt9GViBziuW72X/XlSg84TkwCX5dVOrekwpAW2HMaaN53CdAvK9Sj1HZMzlzMfIWG778Ys55iwCEW1HlGegHxmJN/qGgQyvW92Cv0eFrheyVCNqz+KEPEi+RyhEsQWYXxBiVdE12LNIZLqVi5Hv6RVUNSqc9atT8/czfBe7gEFIPjLMMiJVGlOKByIP+zSYe17J9pTSLaYUn6/C7AfOtFQ3Stm370UZ6LyyTbqMuTzs2/eYj7eMc/0kwpAjW76nm1eQDAMnhRkIRhSHTYQ3JN9razw4GNi2Hvifl4EeB9mvX/Bi9me8Jpp8EYSDeJHFny4xNDi2bCPijCiEKfEEr5gUtFxMitUQCOfGR6cgoqaPfM/qy5KsUi0OnVBYMaVSod++F5GnVF7dqB5TyhDQdpx9SvXNuBKeUhUaLmTM5X5zS7nyT9PHg8h9+16JmQxAvMz8lotuXkFS5HuahbqIChFrRKI8yCjV1mjZDrRsK3w9WSc/LwThQzHJlXaLDzqFKYBJNCyKON0m+V4wnNWrU/v3a5+ypbhhGqWSOf1O+Lfv5QKdS/eUcv9fdU8pkR6bQOGFyqpRXxN9oPNKPUdkzOW+Y0/M/X5Q/C9tcP4uQL4nwDOwGLp5BZF8Tx2KhQsh5KL4NEaEDpfnqb6CIdo0/OTO01NKMy8VW7ahz6ZcNNZpsITVUkzAgoPke8FweiTopAz3Cw4sO/YED3IOhBDoXJh8j3tKSQ50rtnteyKC5DunFOU9pRIKeUpVGOhc5FzO+2dhTKny+q+ft4zr9j0B85jssAXaXYBjiG9L1s2LmpRJVBRTZhByIctEW4PfrmfkLeDmPAhM/T6w8h35eSKIPGxDgv7yPRGyDd2ReYLHnxGmjIDke8Fwlo9O8j0+7hR6F8iVpDhv3qvUA0C4fE/y9W/55aG+p1T4Bk3nnKL6WFRXw41SEcaU8unXQZExl4cdU8rPg8hllBLQdKx5V9K6RzfvZUPAuiQfy8Cp+NgQNaRmUAcySrU1/Dylls0EPn4W2LxCdo4IooBiCzDdXJLpZo9CopDvhXkiqVsbjAp95XvZn2FJaMqlOR3OzXuAQ74XckAcbuSS7SmV3/dUv31PROBnl3xP8bGIe0rt1Fq+J34u9x17ypQO+8v3DM/fw0L67Xua3ELJkdOWaJ0SBBE3NBPlofYsToSPNePlnSpat+9Ft2AgCE6xIJC2e7seM60lRaQZz0JmHdptKbw0dbvpJyoMw7BPITVq/6aPzEd6oPMQjVLcaJQOOXCGJd+T7Cnlvj2s8tsJRSMimK6zKlWXLdXXRC/fq1TiJWMut8ce9+vlBsb2kyw6u6sIQ068zPyWi37rwvDlvPn4ydAJN7LbKuGP2rM4ET7c6FRw13XOSKVT4A+iainmTqvbiZh9CkMTHkdmHYoMMKxLUNUo0dFT0K5f9+tRxZSqNJ4UACRi3CgVbub5Qj4p2VPK2ffqEnHl+6KItuMc01SfD+uS0Qc6r9RzRMZc7je3lC/fKy4H9HovDER4BhZDN68gGZIx3dbKUSH7AhPCH7p9r62x55FAaieQbOd+3fKUIqMUET3FXL+Zz8mfqsQ13JSLxvY0Ev8sMfK97E9d2mCUZMufaWWU9VvMy746usXMbuBD9ZQSJN+T3Recj+NeOCojIvCz2ygVWrJC4DG/UiZD2swgEYKhtVQq3aRLuTEttwTP98ItNxiz38Uwzv4qJqaU3HWPbgYYGQZOy1BH7idF0fHgrFoho1Rb4/yp3q9zo1SG5HtE9BQLKMxP5jVZe1gLAp025aKRGay+XNlDMSoNmNuWiMUAmHq5xvvfWOV+XzRhxpTi8jpRgc6Tko0MzrqpU1y6B4gJ/Gw6PPpU9xRz3o7YlM6gQwRGqUrlTMVuBQ4LX8+mMqWDpo8HkTN5EQZl2QZ83aRqtmRM3DMsuaomZRIVItaIRHmoP5MTciBPKUIhqkm+J/tqZB2oNOBsKYiUzai+EVQB2QFvw8BPvic7ICqX74URL8mOKRWyp1TOFSMh3VPKYZTSyFMqzH7gFxRbRZxtOCoJX6WeIzLm8rDHHr9LRZz/FzGPyb7RLKOZV5AMyZjMdZbO0O176qBJ9yWEYxmlqFMS0cNPkYrK9zSZaK2FLNl7Lezgq+KfFRew4CD5XnDKlZ1Eia98T/J3CTPQedJxGhzmRsjMeUrJlmO5jFIJ9Y1SQgKdazQXGoZhxZXa2RKNUcoatyuV7wmcy/3mlrLle3ws80kv+6wSMxkAu6zkxpTSoS8Acg2ctE4pTlzDg7NqheR7bY279skewfzgHaBDV/v106YAp9xXGGuKICKAn+x43r7nc5KoKsWkiG0VW/4m01OK5HtRwKtYl/bv3ETlb3BkS3FbzPACnccdLgTpDAstMLl9+150MaW4sUNlrH4QpnxPMyl7XTKOplQGzelojFJ2eVVmlBI5lvnNjeV6c5g+c5XoQOey4/RwGZwuXkF2WxL3DFqnBMOgNboykFGqLcEYsGND9vf8gbuuk/z8EIQP1SXfy/6kmz1sZLqVi5BcyYyJpTsxy+tRj/Zf7EYzQ/Lpf5ieUgmHESptMiRDci7iMaoSkm/fc3p+6BTovK3K94BssPMtSGFnSzRuw/a4Xd7fy5Fc+cWAKu9wxU++ZziGFDHyPblepZXWrWxiljhFvHxPl/EhKki+pw7qHy8R4eGMF2VQ1RPqYkkdPDZ/fkGIVYWCKBZiBeCUId+LuZ8ZBiYt9gLDvY1EBnQNE+dpaX58kriE020nYcaUSjrGy1SI+qOoAp3rKt8L8zTe1Gwu5MHOmyLylKp07SBjLrc8m/LldmUGxvZNzynfE2GUEjDvFkO7dWERNUBYWMHfNSmTqCi23yDkQpaJtoTzZr18o9RHzwD/vBpY8h+pWSIIL4q5fmt3IkbXzRbgd3orAttDIfxYLrq0wSiRcfV1mDiz6SehkeX1Fertew6jkRmiVS0d0WbQJd/TwFOKNyURMaV0sY1zo1TUMaXKnXdkzOV+3m/ljj1+39kt3ystj0GQfcGFbkG9ZXiSMVqnBEL2BSaEP2SUaksU85Ra8RYw7zFg7cdy80QQHhRbwOu3+Mj+1EW+JAOZbuUiFhyMTiADo5trfDH5nmxJiiXfC8ELydlUQ/WUUuH2PQ08pZyb9LDmAt3kOTz2V1S371VqxItSvlfu2OMvB3SkLaDvknyvODIMnLqND1Gh2xqlmiGjVFvCaZSK5S3i+KDFolksEIQTWybjEehcNzdtAbIN3TElekoJke9JDNSuO7ZrfMQZCYizneTL92JlSmjKxQp0HoKnlGEYVnDzdJieUlHJ91wxpdRfyjolUmENRbrdrlXPPaUiNkpVLN8TOJf7zY3ljj1+NzQ6y0BIoHM+70o2SunSF/hwKVIyRuuUYJB8Tx3Un8mJ8GBF5HvcSEUbZ0IB7ODIhe/p5pIs4xpp3ZB5qilGvudOm/BH9ol5pTjXpWHdgFUuYcr3ACCR2ymGaZSKLNC5U76nkacUEF770c07hMv3mlNRBTrP/qxYvicw+1YeY+GMPX6e5TLlezK8xHW7fES0rN1Z5rqMD1FBITbUgW7fa1MYQK/BWY8pI99Til8FQTtnInos+Z5XoHPNDAJxzTblMuBFIeNUU8SCg1mnsuGlWa2IiKUjEvdi3tu7QJYU1w50Ho7RhUvs0iHuqvlpfJTyPS1u33OMFaEZpXLVqIuUXRVPqUrlezLiABV4NpV5uJLxmauc3VWIp5QjTcbExz3jfUGXdaFoQ0ixwxXCjW5rlGqGjFJtidoOwPdner/HjVQZku8R0VNUvqfZiRjp1QvhG1kZm6lYkbZULjLzrzuWa7wm7d8l3yuIwyJZvhe2pxSX74W4E0pZRim5FlqnQZt74KiMy1MqpPbjJ81SldoIY0oxxuzDkDLLS8YBky25cr9ulDmPZXwkXIZhwDCyBiMRMaWcZWwyhhjEtlF7XSj0MaFhyfcEtSW3DF2TQokI3dYo1Qyd8xJZyFOKUIhiN7fYQaZl5qh86GaPQuTK99zPDAPdvPWiRDfXeFvu4iV54Z+R5CllZjfvYQQ6B+wb+FIhWtXSEcn3nFWjnVGqjcr3ovSUCsNzRMZc3prcrtRnF7sYhqcpov0YAjwDiyHzRt8wEC3fc1/YIeQRVYNua5RqRpNtHSEcK6YUGaWI6IkVObnQLXYAncIUwk9vZcj3bMlVeGn6SSKIQixDjiYrvmLeJ+VKaMolbE+ppBUsOcRA55loAp0764ff6qYyzkOUsLw2/eIPqQo3HjZFEFPKtUkvs7xEz+XOMTJ/biw3MLZ9MUzhe7wPiZiHnf1TxnDJ7ey69AXL605QV3CWuS7B36NCt7iX1QzJ99oS274B/nAsEE8AV853vzfiBuCoy4DajtHkjSAc8DnUa/Nkahc7IPtTl025DIqd3oaNLbkK01NKL8NolIiQT4qkWN2WK6EpFzumVDhGl3jOmykV6u172TzK3vi4Ykpp5ikV1tmfbrdr1VtGKfmeUsVkuUERPZcX824p17OmmAcRf0nEPOx8Xphzrx+6eQ2KNoSYrrakSaFERLH9BiEXMkq1JTIpYOuXQCxZ+F673bL/CEIBirnT6rb4IPleIdrL9zQLMBwlxaS4KuKU7+Uj280/7Nv3ktbteyHK9yxPKZLvFUOEfE+3m2jrIo0pZf+uqnzPmW7Y8j2v7yxUvudIk+R7hYiWgjvT1aRIIkO3NUo1o77PMxEe/HjOoGon1MZyk/e6fU+i9CsM4gIkM7ojM0BvsbZULqbE/OtOTLP2X2x8KVdCUy6WfC+0mFICAp2b0Qc618NTyv49LE87y1NKk7mwLkpPKUeZl7t2ED2XZ4rksWz5XhFjDX+GiHnMmX9REjUnuvUF0fOiSwpK65Si0BpdHchTqi3Bb9bzMkot+Q+w7A2gz1HA/qfKzRdB5FHsilaZ0q8w4GskWXFodCAjMf6DiNNt3TwUokS32yeLyfdkx55oMUO+fY97SoVpoM1EE+jcWT+1GsSUct52Fl6g8+xPXbxD6iINdF6554joubyYfK/csaeYVzIvBxHtR4RnYDF06wuivXPCCOzfVii23yDkov5MToQH95SKeZwqrnoXeOc3wPLZcvNEEB5Uk3yPbvYohNehjLWSyNv3dDGMRolurvHF5Huypbhhy/csT6lQb9+LxlPKOf7r4CkFhN8XdDOO10cY6NwZx6vcTbroubyYIaHcsYe3Na8DIP4MEdOY83FyjFJ69QWS76mDbmuUaoaMUm2JYvI9/hrdvkcoQLzIqaB985keM61ugZ5lIFP+VqwtlYupmYQ0SnST7xWrWy6hkfVdQpfvxcIPdJ6KylPKUT86xJQC7LEorPZTTJqlIlF6SrnkexUapUTN5e5g7HnyPR6MucRnFwuGb8n3BMxj3DMQkLP2kRkSIAyseVHwTY4xgw7PWiMuuC6I4JBRqi1hGaW8joC5UUr+YoEg8ikq38twLxs9JlruQEDyPRvr9FZCHfLFX5hxLXTzUIgS3eR7xQLm2ieqco1StSEZXRJxLt8L31MqKd1TSq+YUkD4MhHdJEs80HmzrvI9wXO5M90C+V6svLGnmAcRf01U+5HpgaKb97LldSfID0C3sSFKSL6nDhRTqi0RSwBd9wNqOhS+Z+QWdeQpRSiAFZzaU76X+4wmk63tqRNxRhTCWihLsOqIiANkLfjIKtUqurX/ILdVyfouVkypkDyl+A15YXp68fhUsj2lnOO/Np5SsXA36bp5DdcrEFOqEs8R0WOZM938Oi3XiMHbmlcbsW7fE9R+4oYBE0yqfC+koVI4ccEHHDLXWLoTdxhPGWPaGDarETJKtSV26wdc/p73e7wTklGKUAB7AeYv39NlruUTnC7yJRmYGXl1yJ8Rpmt2MUkE4UZ2cPBKKdY2ZUtxW0KOKRXPuXqEKd/j8akSkgdkZ9er0yDQOeBoPyHNBRmJ42gY1EYYU8q6XKOCMVv0XO5MN39jXO7YYxbxLLeMUoLajyXfk7D2yWg2J4uWNspcY+mOOyi/LZUl5KPHTE6Ix7Dum402HwSB4pKfYrdjqYhu8iUZSJXvCZAQ6GYYjRLdXOOL376X/SldvheSUSoZExjoXLKLQkxDTylR8j1dTvbV8JQqv6xEz+XFZOHljj0k31MT0V63MtdYuiP7pkjCHzJKEVliJN8j1KFYcGS+n9LFLdmSIpKnlIV1iidDvicg0LZuQVWjJC6g/EVSTBIlO2i7Jd8L+fa9VIj5twKdSx6Pef0YRnhGO9HYsvSQAp1rduEC92hriiLQuTXnlJ+G6LncFDD2FJureJqiDBcyx367Lwh/VChIa0u0RmkV55igyzqlWiH5Xlti/afA3y4EOvYALpzmfm/w+cCAMUBdp2jyRhAefL1lJ+Ys2QAYwIZtzejWsQ4tZnZBu3rTDryzdCOO6Leb0otyvv9oMTMF3+Wwvrti3srNWN/YhG4d63y/i5lhmLt8E9Y3NmH39rW+aRR7T6X0v2lsAgCs2LANZoYJrr9sBazatMNV/vnfpVg7ys//tqY0AODTNQ04cu8uSre/KDEzDA07UwCAxesa0ZLO+LalIG2nlPZYbvr8MztTad/xZcXGHQV9uZz85/9dfjvb3pQtu4VfbcU+XTtU1M7MDMPWXF18kVcXlZQ/9+b6ePVW9NqlXlpf4B4jiZiBd5dtUn4eMDPM2vDM/3IL+uzW3lX+g/fo6Pt3fmNzKmfc2by9RYu5kBtXdzRn+5Zff61kbPZLo2uHWgBZI0C5ZRV0Li937OnRuS6bRwbfPK7d2lTS2LN2S3auXb1lp2uuNTPM6rtL1jVi9KDuobadbHvPpv/hl5vRa5f6UMb+ucs3Yd4GA7su3Yh4ImHV9cqN2wEA6xuaJawpKoePX00pM3B95lNsbNilXRJA9lILHcaGKHGeEbzzxQbUJOMljz2l1Bvhj8EivhLqoYcewq9//WusWbMGBxxwAO6//34MHz7c9/OzZs3Ctddei4ULF6JXr1648cYbMWnSpMDPa2hoQOfOnbF161Z06qSZAeaNyVmPppE3IpVKYemfLkH/AfshfuzNwKy7gIwJjLo5+1nn//nf7Xsc8Idjgc57Atd8kv3c46dkf078lyt9vDEZ+PJtoM/R2TSc6eU/K//v+O/56ec/q9L089Pwe1Z+eUhMP5VKYfr06Rg7diySyWR5ZVUs//lpOP+fn4Ym6S/5ZgcmfDocv0v/HwDgnNRPAQBPJ38OADg39VM8lfv9nNRP0bNzHZ7YZyb6d21XUv4zj47Fxk0bsctVbyH51t3+dR2kb/mUz8ZtzThp649w7s6ncLjxGd5n++H+9ATru5yX/ikuj01F3Mjg/vSEwu+SK48Llh6DM7f/BSaLYYo53lUe56V/ir8k7PLIf0/19K9r90v8q+Md6NKh1rMtma9PxpLFn2Gfi/+Y7UN+5e/RnzZua8aoDdfj9+atVv6vTjzvqosr4tn8P9v+PHfeHe2xpPzrOHY6/y6/7zrJG9tcc1Be+hsXzcQLm/rgF9vHFW1LvuXvKPs1W5twdeJ5mCyG32bGF22PYaffs3Md/tXxDgDAMRuux8OOtlRu+vl9hqd/SuNNBe2sWPq+Y4+jnszXfoGVc/+N11MH4hc7xhXNR7nl78xjQV/2aT9lz4W5fn3cxhtwfsuz/vl3Uu48FnTsbyX/G7c145TGm7Bma5Pv2NmjUy0m1z+NEd/aG/HjfhJo7Dk3/VM85dFWrfIPKf/W76WMPXnlv+SbHThvyUisa2z2bUthjM35afiNDfntpWCeySufJd/swDlLRhady0WOPcduvKFgTVRq+s93OMc11jjbo+c8XOa60K+9h10+fnV9XbtfFraXcta1xfYAFa4LT9xyI85rejp4e/foT6Ws20SPDalUClse+Da6dOmC2EXTwx978t8LcWw+ueFHOGvHU2WNPWu2NlnVUnQOUoSCPSnUsotE6in17LPP4uqrr8ZDDz2EYcOG4eGHH8aYMWOwaNEi9OnTp+Dzy5cvx9ixY3HppZfiL3/5C+bMmYPLLrsMXbt2xXe/+90IvoFkYnHgjV9mfz/6GjAjhvibdwCr3gaWvwmMuiX73qy7sp/j/+d/t/Wr7P95/KhZdwErZtu/O9P/Mpdmfnr5aefny/k7YKf/51Pdzwoj/fw0/J4FRJu+k3LKqlj6zjRG3mj/f8XswjQ0SH/JNzvQf9GDeMj8D46OfwoAuCIzFQCs//8Fv3C9Z2wD+i96HksGXYn+JeQ/9uUcdAVgzr7b7kM8z87vEqRv+ZRPFwBnpZ7B4bHPMCy+CDCzCzGe/yfxCwyLL8I9qQkAgO9te9r+LoBVHhNSX8NEDNclnwfHmYZfWemQ/t07foIuzYuADfBsS/Hlb4L1HN96+Xv0py4Afmfe5sr/4Ya7Lq5LPo97UhMK8o5y86/j2OlMw/ksvpDzKnvAnoPicVf6GxfNRJdv3sX+ZgOuiGeKtiW/8neW/RSMh8my5X+Uuahoeww7fWMb0KV5LgDg93ltqdz08/sMT39C6umCdubbPouNPY4xa/Onb2Lv5kVYYwLAuKL5KLf8nXns0jzX7gvF2k+5c2GuX//WvBXDkv75d1HuPBZ07G8l/11ydYu4/9h5xvZnMKrl7/j8mx9iIIKNPV5zoVX+Iebf+vtSxh4H/Luc0UpbCmNszk/Db2zIXzfE37zDnmfyyoQ/66zU10XncpFjz0PmrZWnv2NRdq7yaI+e83CZ60K/9h52+fjV9d07foL+ixbZ7aXcdW2xPUCF68KzU38taEvF2ruTctZtoseGmGmi67bPgG1i0i94L8Sx+Xsea/SgY88U2GNGa/VGtE6kRql7770XF198MS655BIAwP33349XXnkFv/vd7zB58uSCz//+979Hnz59cP/99wMA9t9/f3zwwQe4++6724ZRyrK6/xIx08TiHuMwsOYbxJa/CfQbYZ+Q8s7JP+/4OwBZo1R+J37jl0DfYcCgcfbn+o3Idnxn589POz/9Ubdk//E0Rt1iL5L7jQD2Gh5u+vlp+D0ryvR96rCksvJLP79uR95YPA2F088whguWHoO7zf9gWHwR5piD8G5mkDXh3pOagKNiizzfuzc1AR0+X4/+ix4MnP9M3+H4vKUr9n/zjtbrOmjfcqT/vnEg3mzZz8rjHHMQhsXtjaDzu0wxx+OK+FRcm3we96Ym4Lmlx2BWOoMLlh6DCamvrQnyntSEQOWhY/oLa76F73u0pUzf4Vi82zgMmH038OYd/uWf158eiZ+FA1o+9sx/fl0AcOX9rZzMpuz86zh2Oj+X36a92j6AxT3GYUD/AYjnpd+llfae35byyz+/7QDAFHN84PaoQ/rOPsPT8GtnXu0z3trYPPJGZGbeid03vGfVxRWZqUXzUUn5OPPYoS5h94UgY2cJbT+/X3vl/618+U4l81iF+c+fB4qNnfekJuD55aMqGpvvTU3A8JrPcHhI+S977MlhZlhJbSmMsTno2ONcN5gjbsLixkHY16PNvBE/C9PKSF/VsadY+gXzsFf9lrDuEZ3/YnVx/dJjMGfmnYjN/FX561rJ60Kv9u4cy/L7kypjQxzApz3Hl74nLXUfJHBsLmfs4e2z1TmICERk8r2Wlha0a9cOzz33HE4//XTr9auuugofffQRZs2aVfA3I0aMwODBg/HAAw9Yr73wwgs444wzsGPHDssVzUlzczOam5ut/zc0NGDPPffEhg0bIndTK5fY7LuzpzowYIAhU9MBsZZt9v879AD2OALmdx+1/iY+9WIYK2bD2LkJDIABwBxxEzLDr8++/+w5iH3xqvUeACs9AGDxGhhmC8yjr4axfKZ3xhrXIrZtrfVZZxr5eQSyp+xGLrA6/5tMhx7ZmFd5sN6HA+26ZL+3R/quZ3Xo4Z+P/PR3HwDztIc8y7Ug/Vx+M32HI7Zytjv/+em37wbzzKeRSqUwY8YMnJz6F2IbFxeWlUcZW/n3+m6d9oB5xUd2W5hxC4xV7xWkZ5W3swyMOAxmetdF7nfeJmJv3gXji1d985vZ8yjEVr0bvK75d9vneGDHBt+208LiqDFMa3LIMDhuvMn+3pipQ8dYk/VZAEizGBJGBs313ZDcpVdh++lxMOLz/2znw8pj8fae6ToIsW8W+bafzDE/Adv7mIK2k060RyK93ZX/FIsjmcsv/51/F/65NZldsR674pH0KZjXYSTWNjTjAGM5/pi8Gz1jmz3LY7HZGwPiX6GZJVBrpD3Liv9/hnkoLk1l+/zgjltwW/PdAIBu2FyQPi/TIHXBP3tPagL+bJ6IJ2smIxk3rKvnvdLn+c3PY357jzWshmkkEGdp3/HBa+zJMAMxg3mmbzIDcYO58sHLHrADJzenM/iC9cKKTA9cl3w+UBk724/ru+TnPTdGAMXHHu++XGTsidfCvPDf1mNiM26BsehF3zHF1d73PApIN7nL1JG+edlcINku+zcz78D2+X9Hp06dYGxbV5B+C0ugJldWvH14lRX//Z7UBEwxx+PC+Cs4s+Yt37bzgdkfQ+JLAtcF/9z09BHoHcuOPV5tk/fJIO3dqy87248z/SWZ3piQmO3b3p1/tyzTA6cn3vb8bs7P7b17O9SPvBps0LhW1wNrMrvi7vSZ6GVswHXJ561x0y8fz5qj8Hr7sVjb0Iw9jPV4LvkzV/kXK2NnHvdrvw21O9fb+eo3EuY5f8/+QdNWxJ/+rmc7y7bv3FzF51rHe/n5MFkM8dzYM8UcjxdrfoK9d2+H9rUeZ65GHLGv59ntvbYTYs0NgdYRmV37AXWdC9P0WvcYBgzmPQ/wsYe3M/5/r/bzDeuM/2b2KWns4Z9rru/mLn/n+OMYI0ofe7J1k19WPG3z/GnWGBF78y7sWDgdyzbscPU1nt/3zIE4Mv6553fLb/vjWn6OddgN/XZvh9Nb/oWRTa97pgnAc21QbOxZedBV6DrmJnz67G04pPldOG9wS235GrU713uWcdC6eCE9DHvH1rjq1pl3UWPPl5luODXxbtG5ttg6wm/uYoech8yhEwOte4KsI3j+XzaPwAvtv4e1Dc3ohO14pebGwGNPsbrI7HkkzAvsOTH+6PHZX4Ksm4v1i9w8zNfN8We+B+zcbD0nP/0t3Y7CLuvfbbW9f57pjRNbfg0A6Ld7O9zecg96mGsBZAOYN+digfH240yPjyfedZ1dE/F8WHsar3VVvBZs71G+ey6vdb61Tsut2/zaDx8jgo09SRhmKvuezx6Gp29OeBLo1BMAEHv/DzDefsB33dPQZTA6bZwfaOy5MHUTFrM90W/3djg+NROn7JzmWf58DgKAv/zPEBzZbzeoBt+Tjh492iXf23333du2fG/Dhg0wTRPdu3d3vd69e3esXbvW82/Wrl3r+fl0Oo0NGzagZ8+eBX8zefJk/OxnPyt4/dVXX0W7du0q+AZRMgin5Do/AMRatgGA1eli29aicfn7eH36dOsvRi3/AJ2aNuU+lx08/tU4CMh9plvmIAzFqzAcT3F1YrMFppHAq439MWbN/b45c34WgG8eAWQHc/653IAX27YW2FZY/+u2ZfDuvtdnv7fZYhkTXOnlft+EztjV2IB4Lh8xlnaVjTP9LVu2YJZVToNwmk+azvz+a7dLccqX71jfzfk5nv6OZBfMcJR/47IPsOuOZQXfywADA5DJfS/TSGATdkVXrPXMB2tch+mOdI9c+i56NPy3MB+8vIPWBZirTQxe+Q76bPrIM78A8GrnczF69Qe5usgO8gXP5psII45YLh/LGmvRf31hupwaw0QzS+Dc1E/wRew8JAz7Nkg+WXSMNbk+C8CaVGp3rgd2ri9Id077k3BUrowziDnyWPjdMrDz+9/6YTgUi3zbz7x3XsfXn+0AMAinIoYYcjdRpbe78gwASY/88u/CP9czthk9sRldjK1Y25A1pndAE3rGNhekx3+fmhmOa2LPo9ZIW4vU/LLi/1/E9rL+vmHbdhxc626TzvQTRsaqi8Wx861FvvNzPH3+2SnmeOyKBhwcW5aNL553E07MyC6a0oij1kijhSUK8gjYdbE21hPdjbWIs3R2weMzPgDusYcxIOFTxgAQN5irLhizyx4AwJtdDDAyDNeZl+GHiX9YnzWMwjKIGSjoy8XGHvcY4T/2WMZTj77s+lwufdNIFo4Rued6pW868ru2MYPeWz5ylasz/ekvvwwzng3GO3jle+izYzmwo/CzAFBjpFtt7/z3Fha3FnM9jU0YxJZ6th0A+HH6EvwzdgtqjbS14fFr7ymWbWfNLIH5bF+MjWWlMF5tM1nC2OPVl13tx5H+H9In41T2jtU//fo8APzFPB5j2VzPvuxKfxPw8fuzsHxFDbJjTxwxZPtn/vjbM7YZXY0tmGKOt9qwV1nx9GdmDrHGnlqkCsYe59+ZLIY0Yrm+HHfncSdc+VjZGMfHuXZZk27EmDUfucrfPdeavnNtfj7ijrEHQHbs2QRP1nX8FnZ3tHeWakYs/9k+64hU40bUbV7uma5f//SaB/jYc27qJ/g8dkHR9rOa7Y5LUjdY9cY3Sp5jDwNakLDa+9eZLuiH9Z7jj3uMGITTHJs2ZxkUW0e4PudI2z1GvIM+mz7BwT59+fLU1ZgTuwK1RtraTHvNcT1jm5E00gADlm/YgZrEOhyc8J+7vNYGfmNPisXxpy1DcNiMGdgntRXxtfZ6CgBq8z6bgVHy2PNW5iCcnpiTfaOVsWdJ7HzL6ORMr5yx5+/mcJzAPvAde5y/O9cRJuKIw/Sduz5je+Hztd0ADMKpRhyxnJHSq70HWUfw/C/I9LPGnjjMVsYe9zqixkj71sXaxgzed8yJ3/EZeyxDR2vtnfcLvifIrZtP/HIe6tINyIev8++tvRy35Oojfx3hzG/c0ReXb9iBbjXL0T+22vFB+1fGYLUzoLX2nh177q29HLcaH9h7Ao91lWkk8a+ulzv2XMXX+dwgZRoJrI31Qm+s9m0/9hgRZOxJtbqH4em/9tqr2FHbFQAw6Ku30L/IuueJxPdwKVvg2Zed5dYzthnt0GzVBeLrcXDSHnsyzLDKn89BAPDq7Pew8VP7uaoxY8YM6/cdO3YU+aRcIr99z8i7rpIxVvBaa5/3ep1z880349prr7X+zz2lTjjhhMgtguUSm3131hqdW4ha3hyxBIxMGuYBE1A/+HyM7TvM+hvjgM4w5z+J+MLnweI1iJstOKXjIstTKjZ7EbAMVhqA/bsBZv3NCbusQPqMpz3zZSyc6krfmUZ+HrPvJRHP5Czg3BPrgAlgB4wvSLtLu91xyrLXEWdpt9XeI7+7dahDbFvaMx/56Xeo64Sxex5llavhkyb/PZ5J49RNf0CMpT0/x9OvSdZh7F4jLKt0/bj7kM5N2K6yyv0d/15xswVdOtYA23zyccA4jB071k7n6x5Ib99QkJ5V3q4ySMLIpHzqIvvdrDaxrg/SDV/75veEhr9my8CjLvLTjzHTysfefXohfUxh++Hpt+ROHJ5K/gIJI+N5KrjI7INB8S+tzwL2yej6vU7DbkecVZD+UaveRfyLbH5jDg+ojGMzZ+UXdn4Pyfy3aPs5pMdBOKRjT8Rm340YMtbntu0yEB22fO7Kvzu/2UUU/y78c1PTw/DPzNFYwvbAGYf2wt8+/Bqfsz0wNT0M4xNzPMvj+Ng8a1Lk6eeXFf9/R4cF4ehvHYCLFtwAADg19nZB+i25RfVTyV+gxjBbqYvsZ6+IT8XvzdNwUcsNGL7Pbpi9dJNn+nHY+c3Po7O8e9SnEduSthc8PuOD19jjVwb8PV5WPB+87AFg/CHZA46pH61BI6vHFfGpgcvY2ZeLtR0+RgDFx55ifdkzfSOGsfseb5fN1z1gzn3E1X+df+fMb4+9ByG979XuMnWkf+LJpwGx7LIh/VUvvPvmdBwyeDCSn71YkL5X//SrixrDxBXxrLTsOXMEavod7dt2bk88Frgu+Aau1kiju7EZF7Vk27tX2yx/7Mn2ZWf7caZ/pPGpK79+fR4AhhqLfL+b83PXj94X+x94OPbfpU9u7DF9x9+p6WGYnjnSasOtjT0rWA9r7FnLdisYewraOzKefejOAZ+j24ppVj769O2HPU7KzV1mC9L77+rZznj7jmdSnnOtVz742DPFHI+LWm7A9aP3xcDuhbfZ7b7kZcTnf2y190zXgcD6hcHWEfuPQXr/7xSkWWzd4zUPpBzjqtP46NV+mlBT0thT6xhXd28XA5p9xh/HGJEde1g4Yw+AE/c51hojsK4PFi75HHfP+MKzLz+YfND3u+W3/Q0s66V23fH7osOO83DRu/t5psn7ZNCxJ2mYuHiXD9B19E2Y86/12HfoyUjE41b9bpr7V3RbMc31d6WOPQOMVYHHnmSrc23wsefo2MKiY48zfa91hN/ctc9ue2OfLvtmxx5mtrLuaX0dwfP/NetijT3b0C7A2BOsX3Tf+wCMHWOvm9P9n3b33aLtvUi/yFs3G/s9inTu77zSv7b5t4Ha+7yMHZHouuP3RUP8l/gwnV27fbV5J6Z+tMbVfoKUAX+v1sjmI87SVl/2XFcZMZyy5iPfPVf+PGMdHLI0etangC3+7YePEeWOPV57XnbAeByz17ctL01s2BfmW/W+657zMi8EHnuWsR5WXXRq+h4ueru3Z/nzOQgAThh+pFaeUqoQa/0jYth9990Rj8cLvKLWr19f4A3F6dGjh+fnE4kEunTp4vk3tbW16NSpk+sfACSTST3/vX0f4m/eAXPETfjn4Mey7u3fLAL6jYDxfxuBUbcgvvB5JL6a6/q7xFdzEV/4PDDqFhg//Sb7uTfvQPLt+6w0MeoWGCN/ZJWd0fdo+/cRN2T/ZvavkfhmIRKDTnb/+2ahnf6IG+y/G/kjoN8IO4+u9IcWpr/wee/0V86y8+hM35lH/qy1/80+Kz8fXunvPdxVrkXLgKe/cnbhd8lPv/9xVtkDQLzfMO+ycqYx4oZs+mv+65/+J89l64zXa98j3en930Z3ebvK4Eb/uuDp8zaxx2Dv/PL0v5zjXcZ+6fP6/eAPhfWbSz9zzI8xsu5vlpv3HHMQHkyfbqXxYPp0zDEHYVD8y2wsjvQ4673fpE/HI/Gz0G3FNO/033nQbvu5PGb6DsfnPe1NRkF77zcCsdVzC/uWI/3kbn3cbSdXPh22fI73jQMxxZH/9zMDrN+npMe5vkv/5idxT2oCxifm4CBjOcxOe+IX4w9Gz851uCA+A+MTc3BPaoJneQyJL8EccxB+4yiP/LLi6f9P4mVcGZ+Knp3r8NPvDcVnHYfiIGO5Z/pTcmkEqYsBufSvSz6PH8Sn4bOOQ3HehZOKpv+bvDJ4LPG9wra0Zj4yfYfjX4c8CnPETd7jg8/Y81jie670nc+emxnoyoez7D/rOBRjJ/wPxk74H3zWcSiOji2yYjcUK2NX/vsc5f4uXmMPHyP8xp78/uQa94b6p7//GPfYv2KW93jjNb5/+Hg2jfw+n0s/+e4UO93eh2Bd50OQ9BnP3O39dN+6eDB9utV2roxPxY5O+3i2nf7NT2KOOQhHxT9rtb3nt7N7UhNwSeIlq3690h/Q/ERZY88Uj/bjTH9S8l+4JzUBA3Ppe/X5A43lONBYju8n/+3ZzvLT32/kmUh23cdz7HGuBzLH/BjjE3MwOfEHqw0PKJKPg4zlaOrUzxp7Lo6/VFD+xcqYpzG0fhW6rZjmbj/z/mTPXXXti8+FfK7ymGvz+3V/x9hzZXyqVT6ea5T5T7jngfULvedC5zqCr5cWPBt47OFpeM0DD+aNq/nt4LOOR1nt53Dj80Bjj7Mufpseh/eNA9Fx80L/uYuPEWGPPYNORrK23h5/9hiM/Uae6duXj45/WtCXnWOzs+1/P/5v9Oxch8uOHYCzTzmx6NwSdOyZkls39F3wAGrffQA7arshvt8YV/12WzENj8TPctXhB470g4w9/5v8dyRjz6WJ6Z5jT7F1xJ8TE4rWb2LQyUj22D/wuqe1dYQz/w2dBlhjzw/i0wKNPcXqYkTdc8gc82PEP3zcvW72W9d6tnePPUD+niu3bk4MHF103bzL+nfxvnEgfttKez8zMctap1127AAcPmocDh19Dg4dfY61LnG2n6Bjw5T06XjfOBC7rH83l/8N/vuu9Qu891xF1vmLe5yW3ZOumV983VxbX97Yk7+HyUs/2a6zPfYs/rfP3JJNf5dv3g9UF+MTczAx/qpVF+eNHVVQ/gObn3DNQT0712Hovt2itxf4/AMKbSCqEJmnVE1NDQ477DDMmDHDFVNqxowZ+M53Ck+jAGDo0KH45z//6Xrt1VdfxZAhQ5QqVGE4Arpljr4GAx79PmJrZtuB+Jy33ZQSZBQoDGjoFWguP2AcT8MraHp+sNwgAcNLTb+cQJxRpO9Th4HLqlj6+XU76y47z15pKJx+bOSNeGL9T9F/0SLPgIN+wQgNZIMRLhl4JdA9eP5jy9/E/sjGVovz2/f86jpo33Kkf/jyN3F48hPcm5qAI1sJ0skDEPPvcuo+vVCTOC57veyibPBEXgatlYfXe1qkby7ybEux5W9iQEtXZMY+gng87l/+znYGZIO1xoMFpb0nNQH3piZYeY/HjgOA8vKv69jpFRC0WOBWAAPW/gPx+VML0t/4yWsY9s27gYIYe5V/ftvhgUR5vQUdG8JI3xCUvrPPOAPRerUzz/bZ2tg86y7EjvkRNnzyGoblgp23lo9Kyt+ZR5gB2k+Zc2F+v/bKP++/FpXMY0HG/iL5d84DzKMt5beDU/r1QE3i+LLGZl4GYOHlv+yxJ0c8ZgRuS2GMzUEDYuevG+Jv/BIDeo4HMLagzYxa14j+ix4MNJfrMPYMiy/ybY8F83CJ68LW2nuY5dNaXT+xz0zEjvl5VidXzrq2tT2AgHWhX3v360/OcuS/F2vvosYG0zQLLw0Kc+zxei/EsbmUushvnwBan4OIQEQq37v22mtx/vnnY8iQIRg6dCgeeeQRfPnll5g0aRKArPTuq6++whNPPAEAmDRpEn7zm9/g2muvxaWXXop33nkHf/rTn/DMM89E+TXkkTHtQS6VsgLsxY+9OdsJMzmtNu+k/P/Ov3My8kb7utORNwJvTLY/x/+2z9Hu9Ebd7E47P31nGoCd/oX/BB4/xX5WGOnnp+H3LFc6EaTvpJyyKpZ+ft06/5+fhgbp9+/aDksGXYnrlx6De3ZkJxE+6A+NLQQAnJ/+Cf6Cn1vv9exch1P36YX+Xdu13vYd/888OhYbN23ELsOvR/ytbMBvz7oupW/llc/Gbc14rvEcxLb/BTCB99l+mGKOd32XyzNTEc/Fr3muwzn2d3GUx3NLj8GZ2//iCqToVx7576me/vXtfoF/dbwDXTrUerYl8/XJMBZ/1nr5e/SnjduacX3jTa62FDcyrroAsnFpnm1/nivvZedfx7HTmYZzTnCSX/aAPQflpd8lY2LjIuDTTX0wZfu4om3Jr/ydZY+tTVYw699mxhdtj2Gn37NzHS7s+CUAFLSlctPP7zM8/ecazyloZ37pFx17HGPWrvuPwLK5jfg0dSCQQtF8lFv+zjxe2PFLd1/2az/lzoWOfj1h29O++XdR7jwWdOxvJf98HliztanI2Hk2BtcxjOhaX1D+Qcdm3la7dKgNNf/W35cy9jgI2pbCGJvz0wi6bjBN055n8sqn/xuTrWcVm8tVH3ue73AO/tUxazjIb4+e87Bf/QZc9+S397DLx6+ur2/3i6zhgLeXEtdt1t8U2wMIWBf6lUc+Ko4NmVQKmz78B7p06YKYiLEn/72Qx+ZS6iK/fXKKzkFEICK7fY/z0EMP4a677sKaNWtw4IEH4r777sOIEdk4GxMnTsSKFSswc+ZM6/OzZs3CNddcg4ULF6JXr1740Y9+ZBmxgtDQ0IDOnTsrEWW+ElKpFKZPn46xY8e2DS8xTaF6Kg8zwzB3+Sasb2zC7u1rAQPYsK0Z3TrW4bC+u2Leys1Y39iEbh3rcES/3cq6elVW3YTxXYKmoWP6rdVfpfXk9+xS8lFJ/quVIPXiLLfW2lKQtlNKewwj/fy/K6cdiE4/aD2deNIYzF/dGCgfYdehCPLzpXo/bK0dDN6jI155+aWC/iRjLpRF0LYUxthcalmVOp7pOPb4pSei7Yga++cu+wavzn4Pxw87AvFEouT2ogphjPUqjQ0673XKrQvd5iDAu55UsotEbpSSjUqFXwk6DwBtCaondaG60QOqJzWhetEDqic9oHqKFip/PaB6UhOqFz1Q3SgVWaBzgiAIgiAIgiAIgiAIou1CRimCIAiCIAiCIAiCIAhCOmSUIgiCIAiCIAiCIAiCIKRDRimCIAiCIAiCIAiCIAhCOmSUIgiCIAiCIAiCIAiCIKRDRimCIAiCIAiCIAiCIAhCOmSUIgiCIAiCIAiCIAiCIKRDRimCIAiCIAiCIAiCIAhCOmSUIgiCIAiCIAiCIAiCIKRDRimCIAiCIAiCIAiCIAhCOmSUIgiCIAiCIAiCIAiCIKSTiDoDsmGMAQAaGhoizkllpFIp7NixAw0NDUgmk1Fnh/CB6kldqG70gOpJTahe9IDqSQ+onqKFyl8PqJ7UhOpFD7zqidtDuH0kStqcUaqxsREAsOeee0acE4IgCIIgCIIgCIIgiGhobGxE586dI82DwVQwjUkkk8ng66+/RseOHWEYRtTZKZuGhgbsueeeWLVqFTp16hR1dggfqJ7UhepGD6ie1ITqRQ+onvSA6ilaqPz1gOpJTahe9MCrnhhjaGxsRK9evRCLRRvVqc15SsViMeyxxx5RZyM0OnXqRAOABlA9qQvVjR5QPakJ1YseUD3pAdVTtFD56wHVk5pQvehBfj1F7SHFoUDnBEEQBEEQBEEQBEEQhHTIKEUQBEEQBEEQBEEQBEFIh4xSmlJbW4tbb70VtbW1UWeFKALVk7pQ3egB1ZOaUL3oAdWTHlA9RQuVvx5QPakJ1YseqF5PbS7QOUEQBEEQBEEQBEEQBBE95ClFEARBEARBEARBEARBSIeMUgRBEARBEARBEARBEIR0yChFEARBEARBEARBEARBSIeMUiEyefJkHH744ejYsSO6deuGcePG4fPPP3d9hjGG2267Db169UJ9fT2OOeYYLFy40Hp/06ZNuOKKKzBw4EC0a9cOffr0wZVXXomtW7d6PrO5uRmHHHIIDMPARx991GoeFyxYgJEjR6K+vh69e/fG7bffjvywYk899RQOPvhgtGvXDj179sRFF12EjRs3ll4gilIt9fTb3/4W+++/P+rr6zFw4EA88cQTpReGYqheN01NTZg4cSIOOuggJBIJjBs3zvNzs2bNwmGHHYa6ujrsvffe+P3vf19SOahONdTTmjVrcM4552DgwIGIxWK4+uqrSy0G5aiGepk6dSpGjx6Nrl27olOnThg6dCheeeWVkstCZWTW01577QXDMFz/brrpplbz2NocVI39J59qqCed+1M1lP9bb72FYcOGoUuXLqivr8d+++2H++67r8KSUYtqqCcnc+bMQSKRwCGHHFJ6YShENdTLzJkzC9I1DAOfffZZhaWjDtVQT0B2LXjLLbegb9++qK2txT777INHH320tMJgRGiceOKJ7LHHHmOffPIJ++ijj9jJJ5/M+vTpw7Zt22Z95o477mAdO3Zkf//739mCBQvYmWeeyXr27MkaGhoYY4wtWLCAjR8/nk2bNo198cUX7LXXXmP9+/dn3/3udz2feeWVV7IxY8YwAGz+/PlF87d161bWvXt3dtZZZ7EFCxawv//976xjx47s7rvvtj4ze/ZsFovF2AMPPMCWLVvGZs+ezQ444AA2bty4ygtIEaqhnh566CHWsWNH9te//pUtXbqUPfPMM6xDhw5s2rRplRdQhKheN9u2bWOTJk1ijzzyCDvxxBPZd77znYLPLFu2jLVr145dddVVbNGiRewPf/gDSyaT7Pnnny+7XFSjGupp+fLl7Morr2R//vOf2SGHHMKuuuqqcotDGaqhXq666ip25513srlz57LFixezm2++mSWTSfbhhx+WXS6qIbOe+vbty26//Xa2Zs0a619jY2PR/AWZg6qx/+RTDfWkc3+qhvL/8MMP2dNPP80++eQTtnz5cvbkk0+ydu3asYcffjjEkoqWaqgnzpYtW9jee+/NTjjhBHbwwQdXXjgRUg318sYbbzAA7PPPP3elnU6nQyypaKmGemKMsdNOO40deeSRbMaMGWz58uXsvffeY3PmzCmpLMgoJZD169czAGzWrFmMMcYymQzr0aMHu+OOO6zPNDU1sc6dO7Pf//73vun87W9/YzU1NSyVSrlenz59Ottvv/3YwoULA20IHnroIda5c2fW1NRkvTZ58mTWq1cvlslkGGOM/frXv2Z777236+8efPBBtsceewT6zjqiYz0NHTqUXX/99a6/u+qqq9iwYcMCfWddUK1unFx44YWem+obb7yR7bfffq7X/vd//5cdddRRgdPWDR3rycnIkSOrclOte71wBg0axH72s58FTls3RNZT37592X333VdSfoLMQU6qtf/ko3s9cXTtT9VS/qeffjo777zzSnqWTuhcT2eeeSb7yU9+wm699VbtjVL56Fgv3Ci1efPmktLWGR3r6aWXXmKdO3dmGzduLCntfEi+JxDuNrfbbrsBAJYvX461a9fihBNOsD5TW1uLkSNH4u233y6aTqdOnZBIJKzX1q1bh0svvRRPPvkk2rVrFyg/77zzDkaOHIna2lrrtRNPPBFff/01VqxYAQA4+uijsXr1akyfPh2MMaxbtw7PP/88Tj755MDfWzd0rKfm5mbU1dW5/q6+vh5z585FKpUK9BwdUK1ugvDOO++48gdk6++DDz6oqrpxomM9tQWqoV4ymQwaGxut71CNiKwnALjzzjvRpUsXHHLIIfjlL3+JlpaWovkJMge1RaqhnnTuT9VQ/vPnz8fbb7+NkSNHFk1bZ3Stp8ceewxLly7FrbfeGvi76oSu9QIAgwcPRs+ePXHcccfhjTfeCPR9dUXHepo2bRqGDBmCu+66C71798aAAQNw/fXXY+fOnSV990TrHyHKgTGGa6+9Ft/+9rdx4IEHAgDWrl0LAOjevbvrs927d8fKlSs909m4cSN+/vOf43//939daU+cOBGTJk3CkCFDAi8S165di7322qvg2fy9fv364eijj8ZTTz2FM888E01NTUin0zjttNMwZcqUQM/QDV3r6cQTT8Qf//hHjBs3DoceeijmzZuHRx99FKlUChs2bEDPnj0DPUtlVKybIKxdu9Yzf+l0umrqxomu9VTtVEu93HPPPdi+fTvOOOMMYc+IEpH1BABXXXUVDj30UOy6666YO3cubr75Zixfvhx//OMfffMUZA5qa1RLPenan3Qv/z322APffPMN0uk0brvtNlxyySXBvrhm6FpPS5YswU033YTZs2cXbOKrAV3rpWfPnnjkkUdw2GGHobm5GU8++SSOO+44zJw5EyNGjCipDHRA13patmwZ3nrrLdTV1eGFF17Ahg0bcNlll2HTpk0lxZWqvp6nCD/84Q/x8ccf46233ip4zzAM1/8ZYwWvAUBDQwNOPvlkDBo0yGW5nzJlChoaGnDzzTf7Pv+AAw6wGuvw4cPx0ksv+T7b+fqiRYtw5ZVX4v/+7/9w4oknYs2aNbjhhhswadIk/OlPfwry1bVC13r66U9/irVr1+Koo44CYwzdu3fHxIkTcddddyEejwf56sqjat0EobX6qyZ0rqdqphrq5ZlnnsFtt92GF198Ed26dSv573VAZD0BwDXXXGP9/q1vfQu77rorJkyYYJ2WljsHtTWqoZ507k+6l//s2bOxbds2vPvuu7jpppuw77774uyzzw769bVBx3oyTRPnnHMOfvazn2HAgAFlfGv10bFeAGDgwIEYOHCg9f7QoUOxatUq3H333VVplNK1njKZDAzDwFNPPYXOnTsDAO69915MmDABv/3tb1FfXx/o+5NRSgBXXHEFpk2bhjfffBN77LGH9XqPHj0AZC2LTm+J9evXF1hAGxsbcdJJJ6FDhw544YUXkEwmrfdef/11vPvuuy5XOgAYMmQIzj33XPz5z3/G9OnTLakQbww9evSwLK7OZwO21XPy5MkYNmwYbrjhBgDZRtu+fXsMHz4cv/jFL6rKy0Pneqqvr8ejjz6Khx9+GOvWrbNOEzp27Ijdd9+9onJRAVXrJgh+9ZdIJNClS5fA6eiAzvVUzVRDvTz77LO4+OKL8dxzz+H4448v+e91QHQ9eXHUUUcBAL744gt06dKl7DmoLVEN9aRzf6qG8udeUwcddBDWrVuH2267reqMUrrWU2NjIz744APMnz8fP/zhDwFkN9mMMSQSCbz66qs49thjSy4PVdC1Xoql/Ze//KXo83VE53rq2bMnevfubRmkAGD//fcHYwyrV69G//79gxVCRRGpCBeZTIZdfvnlrFevXmzx4sWe7/fo0YPdeeed1mvNzc0Fwcq2bt3KjjrqKDZy5Ei2ffv2gnRWrlzJFixYYP175ZVXGAD2/PPPs1WrVvnm76GHHmK77LILa25utl674447XMHKxo8fz8444wzX37399tsMAPvqq6+CF4bCVEM9eTFixAh29tlnt/r9VUb1unFSLND5/vvv73pt0qRJVRXovBrqyUm1BGqulnp5+umnWV1dHXvhhRcCpaUbsurJi3/+858MAFu5cqXvZ0qdg6ql/+RTLfWka3+qlvLP5/bbb2d9+/YNlA8d0L2eTNN0zWcLFixgP/jBD9jAgQPZggULXLeg6YTu9eLHd7/7XTZq1KhA+dCBaqinhx9+mNXX17tu8vvHP/7BYrEY27FjR6C8MEa374XKD37wA9a5c2c2c+ZM13WLzgq54447WOfOndnUqVPZggUL2Nlnn+261rGhoYEdeeSR7KCDDmJffPFFoCswly9fHujmoy1btrDu3buzs88+my1YsIBNnTqVderUyXWt42OPPcYSiQR76KGH2NKlS9lbb73FhgwZwo444ojKC0gRqqGePv/8c/bkk0+yxYsXs/fee4+deeaZbLfddmPLly+vuHyiRPW6YYyxhQsXsvnz57NTTz2VHXPMMWz+/Pmuv1u2bBlr164du+aaa9iiRYvYn/70J5ZMJtnzzz9fUdmoRDXUE2PMeu2www5j55xzDps/fz5buHBh2eUSNdVQL08//TRLJBLst7/9revZW7ZsqahsVEJWPb399tvs3nvvZfPnz2fLli1jzz77LOvVqxc77bTTiuYvyBzEWPX1n3yqoZ507k/VUP6/+c1v2LRp09jixYvZ4sWL2aOPPso6derEbrnlFgElFg3VUE/5VMPte9VQL/fddx974YUX2OLFi9knn3zCbrrpJgaA/f3vfxdQYtFQDfXU2NjI9thjDzZhwgS2cOFCNmvWLNa/f392ySWXlFQWZJQKEQCe/x577DHrM5lMht16662sR48erLa2lo0YMYItWLDAep9ff+n1z8/gUMqG4OOPP2bDhw9ntbW1rEePHuy2224rsEg/+OCDbNCgQay+vp717NmTnXvuuWz16tXlFImSVEM9LVq0iB1yyCGsvr6ederUiX3nO99hn332WblFogw61E3fvn0903Yyc+ZMNnjwYFZTU8P22msv9rvf/a6c4lCWaqknr/d1PsGuhnoZOXKk5/sXXnhhmaWiHrLqad68eezII49knTt3ZnV1dWzgwIHs1ltvDXSKGmStUG39J59qqCed+1M1lP+DDz7IDjjgANauXTvWqVMnNnjwYPbQQw8x0zRDK6eoqYZ6yqcajFLVUC933nkn22effVhdXR3bdddd2be//W3273//O7QyUoFqqCfGGPv000/Z8ccfz+rr69kee+zBrr322pK8pBhjzMgVCEEQBEEQBEEQBEEQBEFIIxZ1BgiCIAiCIAiCIAiCIIi2BxmlCIIgCIIgCIIgCIIgCOmQUYogCIIgCIIgCIIgCIKQDhmlCIIgCIIgCIIgCIIgCOmQUYogCIIgCIIgCIIgCIKQDhmlCIIgCIIgCIIgCIIgCOmQUYogCIIgCIIgCIIgCIKQDhmlCIIgCIIgCIIgCIIgCOmQUYogCIIgCIIgCIIgCIKQDhmlCIIgCIIgymDixIkwDAOGYSCZTKJ79+4YPXo0Hn30UWQymcDpPP7449hll13EZZQgCIIgCEJRyChFEARBEARRJieddBLWrFmDFStW4KWXXsKoUaNw1VVX4ZRTTkE6nY46ewRBEARBEEpDRimCIAiCIIgyqa2tRY8ePdC7d28ceuih+PGPf4wXX3wRL730Eh5//HEAwL333ouDDjoI7du3x5577onLLrsM27ZtAwDMnDkTF110EbZu3Wp5Xd12220AgJaWFtx4443o3bs32rdvjyOPPBIzZ86M5osSBEEQBEEIgIxSBEEQBEEQIXLsscfi4IMPxtSpUwEAsVgMDz74ID755BP8+c9/xuuvv44bb7wRAHD00Ufj/vvvR6dOnbBmzRqsWbMG119/PQDgoosuwpw5c/DXv/4VH3/8Mb73ve/hpJNOwpIlSyL7bgRBEARBEGFiMMZY1JkgCIIgCILQjYkTJ2LLli34xz/+UfDeWWedhY8//hiLFi0qeO+5557DD37wA2zYsAFANqbU1VdfjS1btlifWbp0Kfr374/Vq1ejV69e1uvHH388jjjiCPzqV78K/fsQBEEQBEHIJhF1BgiCIAiCIKoNxhgMwwAAvPHGG/jVr36FRYsWoaGhAel0Gk1NTdi+fTvat2/v+fcffvghGGMYMGCA6/Xm5mZ06dJFeP4JgiAIgiBkQEYpgiAIgiCIkPn000/Rr18/rFy5EmPHjsWkSZPw85//HLvtthveeustXHzxxUilUr5/n8lkEI/HMW/ePMTjcdd7HTp0EJ19giAIgiAIKZBRiiAIgiAIIkRef/11LFiwANdccw0++OADpNNp3HPPPYjFsqE8//a3v7k+X1NTA9M0Xa8NHjwYpmli/fr1GD58uLS8EwRBEARByISMUgRBEARBEGXS3NyMtWvXwjRNrFu3Di+//DImT56MU045BRdccAEWLFiAdDqNKVOm4NRTT8WcOXPw+9//3pXGXnvthW3btuG1117DwQcfjHbt2mHAgAE499xzccEFF+Cee+7B4MGDsWHDBrz++us46KCDMHbs2Ii+MUEQBEEQRHjQ7XsEQRAEQRBl8vLLL6Nnz57Ya6+9cNJJJ+GNN97Agw8+iBdffBHxeByHHHII7r33Xtx555048MAD8dRTT2Hy5MmuNI4++mhMmjQJZ555Jrp27Yq77roLAPDYY4/hggsuwHXXXYeBAwfitNNOw3vvvYc999wziq9KEARBEAQROnT7HkEQBEEQBEEQBEEQBCEd8pQiCIIgCIIgCIIgCIIgpENGKYIgCIIgCIIgCIIgCEI6ZJQiCIIgCIIgCIIgCIIgpENGKYIgCIIgCIIgCIIgCEI6ZJQiCIIgCIIgCIIgCIIgpENGKYIgCIIgCIIgCIIgCEI6ZJQiCIIgCIIgCIIgCIIgpENGKYIgCIIgCIIgCIIgCEI6ZJQiCIIgCIIgCIIgCIIgpENGKYIgCIIgCIIgCIIgCEI6ZJQiCIIgCIIgCIIgCIIgpENGKYIgCIIgCIIgCIIgCEI6/w80fOvU5BkxmQAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 1200x500 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import classification_report\n",
    "import datetime\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Step 1: Load recent IBM data\n",
    "end_date = datetime.datetime.now().strftime('%Y-%m-%d')\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", end=end_date)\n",
    "\n",
    "# Step 2: Create lag features\n",
    "for i in range(1, 6):\n",
    "    df[f'lag_{i}'] = df['Close'].shift(i)\n",
    "\n",
    "# Step 3: Create target variable (5-day forward return direction)\n",
    "df['return_5d'] = df['Close'].pct_change(5).shift(-5)\n",
    "df['target'] = (df['return_5d'] > 0).astype(int)\n",
    "\n",
    "# Step 4: Clean and prepare data\n",
    "features = [f'lag_{i}' for i in range(1, 6)]\n",
    "df.dropna(inplace=True)\n",
    "X = df[features]\n",
    "y = df['target']\n",
    "\n",
    "# Step 5: Train/test split (time-aware)\n",
    "X_train, X_test = X[:-200], X[-200:]\n",
    "y_train, y_test = y[:-200], y[-200:]\n",
    "\n",
    "# Step 6: Train model\n",
    "clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "clf.fit(X_train, y_train)\n",
    "y_pred = clf.predict(X_test)\n",
    "\n",
    "# Step 7: Evaluation\n",
    "print(\"\\nðŸ“ˆ Classification Report:\\n\")\n",
    "print(classification_report(y_test, y_pred, target_names=[\"Down\", \"Up\"]))\n",
    "\n",
    "# Step 8: Visualize prediction vs actual\n",
    "results = pd.DataFrame({'Predicted': y_pred, 'Actual': y_test.values}, index=y_test.index)\n",
    "plt.figure(figsize=(12, 5))\n",
    "plt.plot(results.index, results['Actual'], label='Actual', linestyle='-', marker='o')\n",
    "plt.plot(results.index, results['Predicted'], label='Predicted', linestyle='--', marker='x')\n",
    "plt.title(\"IBM 5-Day Directional Prediction\")\n",
    "plt.xlabel(\"Date\")\n",
    "plt.ylabel(\"Direction (0=Down, 1=Up)\")\n",
    "plt.legend()\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "3c052b98-ecc5-4fcb-98d6-62053338a4fd",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[15], line 13\u001b[0m\n\u001b[0;32m     10\u001b[0m df \u001b[38;5;241m=\u001b[39m yf\u001b[38;5;241m.\u001b[39mdownload(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mIBM\u001b[39m\u001b[38;5;124m\"\u001b[39m, start\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2018-01-01\u001b[39m\u001b[38;5;124m\"\u001b[39m, end\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m)\n\u001b[0;32m     12\u001b[0m \u001b[38;5;66;03m# Step 2: Add technical indicators\u001b[39;00m\n\u001b[1;32m---> 13\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     14\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     15\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download IBM historical data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", end=None)\n",
    "\n",
    "# Step 2: Add technical indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Create targets\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Feature set\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price = df['next_5d_close']\n",
    "y_dir = df['dir_5d']\n",
    "\n",
    "# Step 5: Train models\n",
    "reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "reg.fit(X, y_price)\n",
    "clf.fit(X, y_dir)\n",
    "\n",
    "# Step 6: Predict next 5-day price and direction\n",
    "latest_input = X.iloc[-1:]\n",
    "predicted_price = reg.predict(latest_input)[0]\n",
    "predicted_direction = clf.predict(latest_input)[0]\n",
    "\n",
    "# Step 7: Display results\n",
    "print(\"\\nðŸ“ˆ IBM 5-Day Forecast\")\n",
    "print(f\"Predicted Price in 5 Days: ${predicted_price:.2f}\")\n",
    "print(f\"Predicted Direction in 5 Days: {'Up' if predicted_direction == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "569c5b93-b882-46ca-a0a0-04f8539a15b1",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[16], line 19\u001b[0m\n\u001b[0;32m     16\u001b[0m         df[col] \u001b[38;5;241m=\u001b[39m df[col]\u001b[38;5;241m.\u001b[39miloc[:, \u001b[38;5;241m0\u001b[39m]\n\u001b[0;32m     18\u001b[0m \u001b[38;5;66;03m# Step 2: Add technical indicators\u001b[39;00m\n\u001b[1;32m---> 19\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     20\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     21\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download IBM data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Ensure required columns are 1D\n",
    "for col in ['Close', 'High', 'Low', 'Volume']:\n",
    "    if isinstance(df[col], pd.DataFrame):\n",
    "        df[col] = df[col].iloc[:, 0]\n",
    "\n",
    "# Step 2: Add technical indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Targets (5-day ahead)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 4: Feature & target setup\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price = df['next_5d_close']\n",
    "y_dir = df['dir_5d']\n",
    "\n",
    "# Step 5: Train models\n",
    "regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor.fit(X, y_price)\n",
    "classifier.fit(X, y_dir)\n",
    "\n",
    "# Step 6: Make predictions on latest data\n",
    "latest_features = X.iloc[-1:]\n",
    "predicted_price = regressor.predict(latest_features)[0]\n",
    "predicted_direction = classifier.predict(latest_features)[0]\n",
    "\n",
    "# Step 7: Output results\n",
    "print(\"\\nðŸ“Š IBM 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "87982413-cd83-42b0-abdc-734a85b570bf",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "KeyError",
     "evalue": "\"['Adj Close'] not in index\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[17], line 14\u001b[0m\n\u001b[0;32m     11\u001b[0m df \u001b[38;5;241m=\u001b[39m yf\u001b[38;5;241m.\u001b[39mdownload(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mIBM\u001b[39m\u001b[38;5;124m\"\u001b[39m, start\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m2018-01-01\u001b[39m\u001b[38;5;124m\"\u001b[39m, end\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m)\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Ensure data has the required structure\u001b[39;00m\n\u001b[1;32m---> 14\u001b[0m df \u001b[38;5;241m=\u001b[39m df[[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mOpen\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mAdj Close\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]]  \u001b[38;5;66;03m# filter only necessary columns\u001b[39;00m\n\u001b[0;32m     15\u001b[0m df \u001b[38;5;241m=\u001b[39m df\u001b[38;5;241m.\u001b[39mdropna()\n\u001b[0;32m     17\u001b[0m \u001b[38;5;66;03m# Step 2: Add technical indicators\u001b[39;00m\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py:4108\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   4106\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m is_iterator(key):\n\u001b[0;32m   4107\u001b[0m         key \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mlist\u001b[39m(key)\n\u001b[1;32m-> 4108\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39m_get_indexer_strict(key, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mcolumns\u001b[39m\u001b[38;5;124m\"\u001b[39m)[\u001b[38;5;241m1\u001b[39m]\n\u001b[0;32m   4110\u001b[0m \u001b[38;5;66;03m# take() does not accept boolean indexers\u001b[39;00m\n\u001b[0;32m   4111\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mgetattr\u001b[39m(indexer, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mdtype\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m) \u001b[38;5;241m==\u001b[39m \u001b[38;5;28mbool\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\indexes\\multi.py:2763\u001b[0m, in \u001b[0;36mMultiIndex._get_indexer_strict\u001b[1;34m(self, key, axis_name)\u001b[0m\n\u001b[0;32m   2760\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(keyarr) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(keyarr[\u001b[38;5;241m0\u001b[39m], \u001b[38;5;28mtuple\u001b[39m):\n\u001b[0;32m   2761\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_get_indexer_level_0(keyarr)\n\u001b[1;32m-> 2763\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_raise_if_missing(key, indexer, axis_name)\n\u001b[0;32m   2764\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m[indexer], indexer\n\u001b[0;32m   2766\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28msuper\u001b[39m()\u001b[38;5;241m.\u001b[39m_get_indexer_strict(key, axis_name)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\indexes\\multi.py:2781\u001b[0m, in \u001b[0;36mMultiIndex._raise_if_missing\u001b[1;34m(self, key, indexer, axis_name)\u001b[0m\n\u001b[0;32m   2779\u001b[0m cmask \u001b[38;5;241m=\u001b[39m check \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m\n\u001b[0;32m   2780\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m cmask\u001b[38;5;241m.\u001b[39many():\n\u001b[1;32m-> 2781\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mkeyarr[cmask]\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m not in index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m   2782\u001b[0m \u001b[38;5;66;03m# We get here when levels still contain values which are not\u001b[39;00m\n\u001b[0;32m   2783\u001b[0m \u001b[38;5;66;03m# actually in Index anymore\u001b[39;00m\n\u001b[0;32m   2784\u001b[0m \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mkeyarr\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m not in index\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mKeyError\u001b[0m: \"['Adj Close'] not in index\""
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download stock data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", end=None)\n",
    "\n",
    "# Ensure data has the required structure\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Adj Close', 'Volume']]  # filter only necessary columns\n",
    "df = df.dropna()\n",
    "\n",
    "# Step 2: Add technical indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 3: Create prediction targets (5 days ahead)\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Drop rows with NaN values (from indicators and shift)\n",
    "df = df.dropna()\n",
    "\n",
    "# Step 4: Set up features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price = df['next_5d_close']\n",
    "y_dir = df['dir_5d']\n",
    "\n",
    "# Step 5: Train models\n",
    "regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "regressor.fit(X, y_price)\n",
    "classifier.fit(X, y_dir)\n",
    "\n",
    "# Step 6: Predict next 5-day price and direction\n",
    "latest_data = X.iloc[-1:]\n",
    "predicted_price = regressor.predict(latest_data)[0]\n",
    "predicted_direction = classifier.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Output results\n",
    "print(\"\\nðŸ“Š IBM 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "8e8a0a84-8fe9-4986-a4a3-a32c26220e60",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1860, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[18], line 23\u001b[0m\n\u001b[0;32m     20\u001b[0m df\u001b[38;5;241m.\u001b[39mdropna(inplace\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m     22\u001b[0m \u001b[38;5;66;03m# Step 3: Add technical indicators\u001b[39;00m\n\u001b[1;32m---> 23\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     24\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     25\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1860, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download stock data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Ensure proper column structure\n",
    "required_columns = ['Open', 'High', 'Low', 'Close', 'Volume']\n",
    "missing_cols = [col for col in required_columns if col not in df.columns]\n",
    "if missing_cols:\n",
    "    raise KeyError(f\"Missing required columns: {missing_cols}\")\n",
    "\n",
    "df = df[required_columns].copy()\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add technical indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create target columns\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Feature selection\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price = df['next_5d_close']\n",
    "y_dir = df['dir_5d']\n",
    "\n",
    "# Step 6: Model training\n",
    "regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "regressor.fit(X, y_price)\n",
    "classifier.fit(X, y_dir)\n",
    "\n",
    "# Step 7: Predict for the next 5 days\n",
    "latest_data = X.iloc[-1:]\n",
    "predicted_price = regressor.predict(latest_data)[0]\n",
    "predicted_direction = classifier.predict(latest_data)[0]\n",
    "\n",
    "# Step 8: Output results\n",
    "print(\"\\nðŸ“Š IBM 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "a67f626e-9c33-49bc-b73c-04ab478e29af",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[19], line 27\u001b[0m\n\u001b[0;32m     24\u001b[0m df\u001b[38;5;241m.\u001b[39mdropna(inplace\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m     26\u001b[0m \u001b[38;5;66;03m# Step 3: Add technical indicators\u001b[39;00m\n\u001b[1;32m---> 27\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     28\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     29\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download stock data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Ensure proper column structure\n",
    "required_columns = ['Open', 'High', 'Low', 'Close', 'Volume']\n",
    "df = df[[col for col in required_columns if col in df.columns]].copy()\n",
    "\n",
    "# Flatten any 2D columns into 1D Series\n",
    "for col in df.columns:\n",
    "    if isinstance(df[col], pd.DataFrame):\n",
    "        df[col] = df[col].iloc[:, 0]\n",
    "    elif df[col].ndim == 2:\n",
    "        df[col] = df[col].squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add technical indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "bb = BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create target columns\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'] > df['Close']).astype(int)\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Feature selection\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price = df['next_5d_close']\n",
    "y_dir = df['dir_5d']\n",
    "\n",
    "# Step 6: Model training\n",
    "regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "regressor.fit(X, y_price)\n",
    "classifier.fit(X, y_dir)\n",
    "\n",
    "# Step 7: Predict for the next 5 days\n",
    "latest_data = X.iloc[-1:]\n",
    "predicted_price = regressor.predict(latest_data)[0]\n",
    "predicted_direction = classifier.predict(latest_data)[0]\n",
    "\n",
    "# Step 8: Output results\n",
    "print(\"\\nðŸ“Š IBM 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "73feb819-21e3-4c0b-84b1-d8ab11ae3969",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th>Price</th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ticker</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018-01-02</th>\n",
       "      <td>105.453556</td>\n",
       "      <td>105.665138</td>\n",
       "      <td>104.798308</td>\n",
       "      <td>105.282913</td>\n",
       "      <td>4395815</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-01-03</th>\n",
       "      <td>107.391966</td>\n",
       "      <td>109.077855</td>\n",
       "      <td>106.702588</td>\n",
       "      <td>108.176895</td>\n",
       "      <td>9875914</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-01-04</th>\n",
       "      <td>108.968663</td>\n",
       "      <td>110.791064</td>\n",
       "      <td>108.777550</td>\n",
       "      <td>110.367889</td>\n",
       "      <td>7903785</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-01-05</th>\n",
       "      <td>110.872954</td>\n",
       "      <td>111.186928</td>\n",
       "      <td>109.958333</td>\n",
       "      <td>110.907074</td>\n",
       "      <td>5434807</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018-01-08</th>\n",
       "      <td>111.023133</td>\n",
       "      <td>111.876313</td>\n",
       "      <td>110.367885</td>\n",
       "      <td>111.575989</td>\n",
       "      <td>5478425</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-21</th>\n",
       "      <td>264.970001</td>\n",
       "      <td>265.649994</td>\n",
       "      <td>260.410004</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>3753900</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-22</th>\n",
       "      <td>260.769989</td>\n",
       "      <td>261.269989</td>\n",
       "      <td>257.910004</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>3091300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-23</th>\n",
       "      <td>258.579987</td>\n",
       "      <td>259.869995</td>\n",
       "      <td>255.789993</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>2722600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-27</th>\n",
       "      <td>261.000000</td>\n",
       "      <td>263.790009</td>\n",
       "      <td>259.630005</td>\n",
       "      <td>263.230011</td>\n",
       "      <td>3283600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-28</th>\n",
       "      <td>263.160004</td>\n",
       "      <td>265.000000</td>\n",
       "      <td>261.394989</td>\n",
       "      <td>261.489990</td>\n",
       "      <td>442141</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1861 rows Ã— 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Price             Open        High         Low       Close   Volume\n",
       "Ticker             IBM         IBM         IBM         IBM      IBM\n",
       "Date                                                               \n",
       "2018-01-02  105.453556  105.665138  104.798308  105.282913  4395815\n",
       "2018-01-03  107.391966  109.077855  106.702588  108.176895  9875914\n",
       "2018-01-04  108.968663  110.791064  108.777550  110.367889  7903785\n",
       "2018-01-05  110.872954  111.186928  109.958333  110.907074  5434807\n",
       "2018-01-08  111.023133  111.876313  110.367885  111.575989  5478425\n",
       "...                ...         ...         ...         ...      ...\n",
       "2025-05-21  264.970001  265.649994  260.410004  260.869995  3753900\n",
       "2025-05-22  260.769989  261.269989  257.910004  258.369995  3091300\n",
       "2025-05-23  258.579987  259.869995  255.789993  258.630005  2722600\n",
       "2025-05-27  261.000000  263.790009  259.630005  263.230011  3283600\n",
       "2025-05-28  263.160004  265.000000  261.394989  261.489990   442141\n",
       "\n",
       "[1861 rows x 5 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "da219ece-4fce-4b0c-8317-bdebeb9c3bf1",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM 5-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 5 days: $260.46\n",
      "ðŸ“‰ Predicted direction: Down\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price = df['next_5d_close']\n",
    "y_dir = df['dir_5d']\n",
    "\n",
    "regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "regressor.fit(X, y_price)\n",
    "classifier.fit(X, y_dir)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "predicted_price = regressor.predict(latest_data)[0]\n",
    "predicted_direction = classifier.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "6951be43-d721-4ca1-a228-4a966a1af8b2",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[23], line 19\u001b[0m\n\u001b[0;32m     16\u001b[0m df\u001b[38;5;241m.\u001b[39mdropna(inplace\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m     18\u001b[0m \u001b[38;5;66;03m# Step 2: Add technical indicators\u001b[39;00m\n\u001b[1;32m---> 19\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     20\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     21\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.metrics import accuracy_score\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Keep only necessary columns\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Drop rows with missing data\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 2: Add technical indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'])\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "df.dropna(inplace=True)  # Drop any rows with NaNs from indicators\n",
    "\n",
    "# Step 3: Create targets for 1, 2, and 3 days ahead\n",
    "for n in [1, 2, 3]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)  # Drop rows with NaNs after shifting\n",
    "\n",
    "# Step 4: Features and labels\n",
    "features = ['rsi', 'stoch', 'macd', 'bb_bbh', 'bb_bbl', 'Close', 'Volume']\n",
    "X = df[features]\n",
    "\n",
    "# Split data into train and test sets (e.g., last 20% for testing)\n",
    "split_index = int(len(df) * 0.8)\n",
    "X_train, X_test = X.iloc[:split_index], X.iloc[split_index:]\n",
    "y_train = {n: df[f'dir_{n}d'].iloc[:split_index] for n in [1, 2, 3]}\n",
    "y_test = {n: df[f'dir_{n}d'].iloc[split_index:] for n in [1, 2, 3]}\n",
    "\n",
    "# Step 5: Train separate models for each prediction horizon\n",
    "models = {}\n",
    "for n in [1, 2, 3]:\n",
    "    model = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    model.fit(X_train, y_train[n])\n",
    "    models[n] = model\n",
    "\n",
    "# Step 6: Predict and evaluate\n",
    "for n in [1, 2, 3]:\n",
    "    preds = models[n].predict(X_test)\n",
    "    acc = accuracy_score(y_test[n], preds)\n",
    "    print(f\"Accuracy for {n}-day direction prediction: {acc:.4f}\")\n",
    "\n",
    "# Step 7: Predict future direction and price for next 1, 2, and 3 days using latest data\n",
    "latest_features = X.iloc[-1].values.reshape(1, -1)\n",
    "print(\"\\nPredictions on latest data:\")\n",
    "for n in [1, 2, 3]:\n",
    "    pred_dir = models[n].predict(latest_features)[0]\n",
    "    # For price prediction: naive approach = current close * (1 + avg pct change)\n",
    "    # But here, we only have classification, so just show direction\n",
    "    print(f\"Direction prediction for next {n} day(s): {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "524063b8-4ada-45cf-b847-2aba9fb3c873",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m~\\AppData\\Local\\Temp\\ipykernel_36168\\492373376.py\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[0;32m     40\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     41\u001b[0m \u001b[1;31m# Step 4: Create targets for 1, 2, 3, and 5 days ahead (price and direction)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     42\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mn\u001b[0m \u001b[1;32min\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m2\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m3\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m5\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     43\u001b[0m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mshift\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m-\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 44\u001b[1;33m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mdir_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m>\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mint\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     45\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     46\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdropna\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0minplace\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m  \u001b[1;31m# drop rows with NaNs from shifting\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\ops\\common.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     72\u001b[0m                     \u001b[1;32mreturn\u001b[0m \u001b[0mNotImplemented\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     73\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     74\u001b[0m         \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mitem_from_zerodim\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     75\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 76\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mmethod\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\arraylike.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     46\u001b[0m     \u001b[1;33m@\u001b[0m\u001b[0munpack_zerodim_and_defer\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"__lt__\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m__lt__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 48\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0moperator\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mlt\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, op)\u001b[0m\n\u001b[0;32m   7894\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7895\u001b[0m         \u001b[0maxis\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mLiteral\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m1\u001b[0m  \u001b[1;31m# only relevant for Series other case\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7896\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 7897\u001b[1;33m         \u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_align_for_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   7898\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7899\u001b[0m         \u001b[1;31m# See GH#4537 for discussion of scalar op behavior\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7900\u001b[0m         \u001b[0mnew_data\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_dispatch_frame_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, axis, flex, level)\u001b[0m\n\u001b[0;32m   8201\u001b[0m             \u001b[1;31m# axis=1 is default for DataFrame-with-Series op\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8202\u001b[0m             \u001b[0maxis\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mif\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m \u001b[1;32melse\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8203\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8204\u001b[0m                 \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mleft\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mequals\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mright\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mindex\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 8205\u001b[1;33m                     raise ValueError(\n\u001b[0m\u001b[0;32m   8206\u001b[0m                         \u001b[1;34m\"Operands are not aligned. Do \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8207\u001b[0m                         \u001b[1;34m\"`left, right = left.align(right, axis=1, copy=False)` \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8208\u001b[0m                         \u001b[1;34m\"before operating.\"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating."
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” make sure inputs are 1D\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for 1, 2, 3, and 5 days ahead (price and direction)\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)  # drop rows with NaNs from shifting\n",
    "\n",
    "# Step 5: Features\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train regressors and classifiers for each prediction horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Predict on latest data point\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Price & Direction Forecasts\")\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nðŸ“… {n}-Day Forecast:\")\n",
    "    print(f\"  Predicted price: ${pred_price:.2f}\")\n",
    "    print(f\"  Predicted direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "05aa2b71-4201-47dc-818d-9b128ac88857",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m~\\AppData\\Local\\Temp\\ipykernel_36168\\492373376.py\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[0;32m     40\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     41\u001b[0m \u001b[1;31m# Step 4: Create targets for 1, 2, 3, and 5 days ahead (price and direction)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     42\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mn\u001b[0m \u001b[1;32min\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m2\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m3\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m5\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     43\u001b[0m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mshift\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m-\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 44\u001b[1;33m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mdir_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m>\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mint\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     45\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     46\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdropna\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0minplace\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m  \u001b[1;31m# drop rows with NaNs from shifting\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\ops\\common.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     72\u001b[0m                     \u001b[1;32mreturn\u001b[0m \u001b[0mNotImplemented\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     73\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     74\u001b[0m         \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mitem_from_zerodim\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     75\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 76\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mmethod\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\arraylike.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     46\u001b[0m     \u001b[1;33m@\u001b[0m\u001b[0munpack_zerodim_and_defer\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"__lt__\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m__lt__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 48\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0moperator\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mlt\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, op)\u001b[0m\n\u001b[0;32m   7894\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7895\u001b[0m         \u001b[0maxis\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mLiteral\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m1\u001b[0m  \u001b[1;31m# only relevant for Series other case\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7896\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 7897\u001b[1;33m         \u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_align_for_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   7898\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7899\u001b[0m         \u001b[1;31m# See GH#4537 for discussion of scalar op behavior\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7900\u001b[0m         \u001b[0mnew_data\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_dispatch_frame_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, axis, flex, level)\u001b[0m\n\u001b[0;32m   8201\u001b[0m             \u001b[1;31m# axis=1 is default for DataFrame-with-Series op\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8202\u001b[0m             \u001b[0maxis\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mif\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m \u001b[1;32melse\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8203\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8204\u001b[0m                 \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mleft\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mequals\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mright\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mindex\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 8205\u001b[1;33m                     raise ValueError(\n\u001b[0m\u001b[0;32m   8206\u001b[0m                         \u001b[1;34m\"Operands are not aligned. Do \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8207\u001b[0m                         \u001b[1;34m\"`left, right = left.align(right, axis=1, copy=False)` \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8208\u001b[0m                         \u001b[1;34m\"before operating.\"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating."
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” make sure inputs are 1D\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for 1, 2, 3, and 5 days ahead (price and direction)\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)  # drop rows with NaNs from shifting\n",
    "\n",
    "# Step 5: Features\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train regressors and classifiers for each prediction horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Predict on latest data point\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Price & Direction Forecasts\")\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nðŸ“… {n}-Day Forecast:\")\n",
    "    print(f\"  Predicted price: ${pred_price:.2f}\")\n",
    "    print(f\"  Predicted direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "760da94d-3ae0-4537-b414-6ccb70bd89b4",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[26], line 20\u001b[0m\n\u001b[0;32m     17\u001b[0m df\u001b[38;5;241m.\u001b[39mdropna(inplace\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m     19\u001b[0m \u001b[38;5;66;03m# Step 3: Add technical indicators\u001b[39;00m\n\u001b[1;32m---> 20\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     21\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(\n\u001b[0;32m     22\u001b[0m     high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     23\u001b[0m )\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     24\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add technical indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'], low=df['Low'], close=df['Close']\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for 1, 2, 3, and 5 days ahead (price and direction)\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'].values > df['Close'].values).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Define features\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "    \n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Predict for latest data\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Price & Direction Forecasts\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nðŸ“… {n}-Day Forecast:\")\n",
    "    print(f\"  Predicted price: ${pred_price:.2f}\")\n",
    "    print(f\"  Predicted direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "3986fc83-7291-4071-9797-bd52713049ac",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[27], line 19\u001b[0m\n\u001b[0;32m     16\u001b[0m     df[col] \u001b[38;5;241m=\u001b[39m df[col]\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mfloat\u001b[39m)\n\u001b[0;32m     18\u001b[0m \u001b[38;5;66;03m# Step 3: Add technical indicators (make sure inputs are Series, not DataFrames)\u001b[39;00m\n\u001b[1;32m---> 19\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     20\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     21\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Step 2: Ensure all columns are float type and Series (1D)\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float)\n",
    "\n",
    "# Step 3: Add technical indicators (make sure inputs are Series, not DataFrames)\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'], window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'], window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'], window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for 1, 2, 3, and 5 day predictions\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Drop NaNs created by indicators or target shifting\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Define feature columns and prepare input matrix\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train separate models for each prediction horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "    regressor.fit(X, y_price)\n",
    "    classifier.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = regressor\n",
    "    classifiers[n] = classifier\n",
    "\n",
    "# Step 7: Predict using the latest available data\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Forecast Summary\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "\n",
    "    print(f\"\\nðŸ“… {n}-Day Prediction:\")\n",
    "    print(f\"  ðŸ“ˆ Predicted Close Price: ${pred_price:.2f}\")\n",
    "    print(f\"  ðŸ“‰ Predicted Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "8bd9bfb9-963f-4351-ba23-093d7a4d0af9",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1860, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[28], line 23\u001b[0m\n\u001b[0;32m     20\u001b[0m low \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     21\u001b[0m volume \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[1;32m---> 23\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     24\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mhigh, low\u001b[38;5;241m=\u001b[39mlow, close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     25\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1860, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Step 2: Ensure all columns are floats\n",
    "df = df.astype(float)\n",
    "\n",
    "# Step 3: Add technical indicators using 1D Series\n",
    "close = df['Close']\n",
    "high = df['High']\n",
    "low = df['Low']\n",
    "volume = df['Volume']\n",
    "\n",
    "df['rsi'] = RSIIndicator(close=close).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close, window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create prediction targets for 1, 2, 3, and 5 days\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Step 5: Drop NaNs created by indicators and shifting\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 6: Define features and train models\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Make predictions on the latest data\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ“ˆ Predicted Close Price: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“‰ Predicted Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "a2d452b4-19f6-4f34-b389-5864e3606535",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[29], line 22\u001b[0m\n\u001b[0;32m     19\u001b[0m volume \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     21\u001b[0m \u001b[38;5;66;03m# Step 3: Compute technical indicators\u001b[39;00m\n\u001b[1;32m---> 22\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     23\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mhigh, low\u001b[38;5;241m=\u001b[39mlow, close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     24\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download historical stock data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "df = df.astype(float)\n",
    "\n",
    "# Step 2: Extract Series for indicators\n",
    "close = df['Close']    # âœ… This is a Series\n",
    "high = df['High']\n",
    "low = df['Low']\n",
    "volume = df['Volume']\n",
    "\n",
    "# Step 3: Compute technical indicators\n",
    "df['rsi'] = RSIIndicator(close=close).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close, window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create future price and direction targets\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Step 5: Drop rows with NaNs due to indicators or shifting\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 6: Select features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    # Train models\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Predict using the latest available data\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "085b702b-0f39-4da2-8550-6009aec01b65",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[30], line 21\u001b[0m\n\u001b[0;32m     18\u001b[0m volume \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     20\u001b[0m \u001b[38;5;66;03m# Step 3: Add technical indicators (all inputs are Series)\u001b[39;00m\n\u001b[1;32m---> 21\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose, window\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m14\u001b[39m)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     22\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mhigh, low\u001b[38;5;241m=\u001b[39mlow, close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     23\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download historical stock data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 2: Ensure all data columns are Series (not 2D DataFrames)\n",
    "close = df['Close']   # âœ… 1D Series\n",
    "high = df['High']\n",
    "low = df['Low']\n",
    "volume = df['Volume']\n",
    "\n",
    "# Step 3: Add technical indicators (all inputs are Series)\n",
    "df['rsi'] = RSIIndicator(close=close, window=14).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close, window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create future targets\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Step 5: Drop any rows with NaNs\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 6: Select features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 7: Train Random Forest models for each target\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 8: Predict using latest data\n",
    "latest_data = X.iloc[-1:].copy()\n",
    "\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "db773945-94f9-4995-86e2-d5b17f5b8f33",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[31], line 25\u001b[0m\n\u001b[0;32m     22\u001b[0m volume \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     24\u001b[0m \u001b[38;5;66;03m# Step 4: Add technical indicators (using Series inputs only)\u001b[39;00m\n\u001b[1;32m---> 25\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose, window\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m14\u001b[39m)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     26\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mhigh, low\u001b[38;5;241m=\u001b[39mlow, close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     27\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download historical stock data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Ensure correct column types\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 3: Extract Series (1D) for indicators\n",
    "close = df['Close']\n",
    "high = df['High']\n",
    "low = df['Low']\n",
    "volume = df['Volume']\n",
    "\n",
    "# Step 4: Add technical indicators (using Series inputs only)\n",
    "df['rsi'] = RSIIndicator(close=close, window=14).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close, window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 5: Create future target columns\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Step 6: Drop any rows with missing values\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 7: Define features and training data\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 8: Fit models and make predictions\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 9: Predict on the latest data\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "0917c0a5-6400-416b-9a94-eff58c36feb9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "YF.download() has changed argument auto_adjust default to True\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[1], line 25\u001b[0m\n\u001b[0;32m     22\u001b[0m volume \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     24\u001b[0m \u001b[38;5;66;03m# Step 4: Add technical indicators (using Series inputs only)\u001b[39;00m\n\u001b[1;32m---> 25\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose, window\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m14\u001b[39m)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     26\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mhigh, low\u001b[38;5;241m=\u001b[39mlow, close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     27\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download historical stock data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Ensure correct column types\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 3: Extract Series (1D) for indicators\n",
    "close = df['Close']\n",
    "high = df['High']\n",
    "low = df['Low']\n",
    "volume = df['Volume']\n",
    "\n",
    "# Step 4: Add technical indicators (using Series inputs only)\n",
    "df['rsi'] = RSIIndicator(close=close, window=14).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close, window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 5: Create future target columns\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Step 6: Drop any rows with missing values\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 7: Define features and training data\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 8: Fit models and make predictions\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 9: Predict on the latest data\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "9e248865-e47c-4588-b06f-9b5effb88a4f",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[2], line 25\u001b[0m\n\u001b[0;32m     22\u001b[0m volume \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     24\u001b[0m \u001b[38;5;66;03m# Step 4: Compute indicators (no 2D arrays!)\u001b[39;00m\n\u001b[1;32m---> 25\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     26\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mhigh, low\u001b[38;5;241m=\u001b[39mlow, close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     27\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.trend import SMAIndicator, EMAIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download historical stock data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", progress=False)\n",
    "\n",
    "# Step 2: Keep only necessary columns and make sure they are floats\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 3: Ensure these are Series (1D)\n",
    "close = df['Close']\n",
    "high = df['High']\n",
    "low = df['Low']\n",
    "volume = df['Volume']\n",
    "\n",
    "# Step 4: Compute indicators (no 2D arrays!)\n",
    "df['rsi'] = RSIIndicator(close=close).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close, window=20)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 5: Future values and direction\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Step 6: Drop missing data\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 7: Machine learning features\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 8: Train models\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 9: Predict the next values\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "57665c64-cf72-410d-942b-1f78d302151a",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[4], line 19\u001b[0m\n\u001b[0;32m     15\u001b[0m df \u001b[38;5;241m=\u001b[39m df[[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mOpen\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]]\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mfloat\u001b[39m)\n\u001b[0;32m     17\u001b[0m \u001b[38;5;66;03m# âœ… CORRECT way to select Series (NOT df[['Close']])\u001b[39;00m\n\u001b[1;32m---> 19\u001b[0m close \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mvalues, index\u001b[38;5;241m=\u001b[39mdf\u001b[38;5;241m.\u001b[39mindex)\n\u001b[0;32m     20\u001b[0m high \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mvalues, index\u001b[38;5;241m=\u001b[39mdf\u001b[38;5;241m.\u001b[39mindex)\n\u001b[0;32m     21\u001b[0m low \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mvalues, index\u001b[38;5;241m=\u001b[39mdf\u001b[38;5;241m.\u001b[39mindex)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", progress=False)\n",
    "\n",
    "# Step 2: Ensure all relevant columns are float and properly selected as Series\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# âœ… CORRECT way to select Series (NOT df[['Close']])\n",
    "\n",
    "close = pd.Series(df['Close'].values, index=df.index)\n",
    "high = pd.Series(df['High'].values, index=df.index)\n",
    "low = pd.Series(df['Low'].values, index=df.index)\n",
    "volume = pd.Series(df['Volume'].values, index=df.index)\n",
    "\n",
    "\n",
    "# Step 3: Compute indicators\n",
    "df['rsi'] = RSIIndicator(close=close).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Future labels\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare ML input\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Predict\n",
    "latest = X.iloc[[-1]]\n",
    "\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest)[0]\n",
    "    pred_dir = classifiers[n].predict(latest)[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "220e11f6-ce95-4e9c-a37e-ce6f01df8af6",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[5], line 22\u001b[0m\n\u001b[0;32m     19\u001b[0m volume \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     21\u001b[0m \u001b[38;5;66;03m# Step 4: Compute technical indicators\u001b[39;00m\n\u001b[1;32m---> 22\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     23\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mhigh, low\u001b[38;5;241m=\u001b[39mlow, close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     24\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", progress=False)\n",
    "\n",
    "# Step 2: Select relevant columns and ensure float dtype\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 3: Extract Series properly (single bracket to get 1D Series)\n",
    "close = df['Close']\n",
    "high = df['High']\n",
    "low = df['Low']\n",
    "volume = df['Volume']\n",
    "\n",
    "# Step 4: Compute technical indicators\n",
    "df['rsi'] = RSIIndicator(close=close).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 5: Create future target labels\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Drop rows with NaN values caused by shifting\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 6: Prepare feature matrix and targets for ML models\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 7: Train Random Forest models for each forecast horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 8: Predict using the latest available data\n",
    "latest = X.iloc[[-1]]\n",
    "\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(latest)[0]\n",
    "    pred_dir = classifiers[n].predict(latest)[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "14a81b4d-0169-446b-896b-9d57d320a482",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[7], line 24\u001b[0m\n\u001b[0;32m     21\u001b[0m volume \u001b[38;5;241m=\u001b[39m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[0;32m     23\u001b[0m \u001b[38;5;66;03m# Step 4: Compute technical indicators\u001b[39;00m\n\u001b[1;32m---> 24\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     25\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mhigh, low\u001b[38;5;241m=\u001b[39mlow, close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mstoch()\n\u001b[0;32m     26\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mmacd_diff()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.metrics import accuracy_score, mean_absolute_error\n",
    "from sklearn.model_selection import TimeSeriesSplit\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", progress=False)\n",
    "\n",
    "# Step 2: Select relevant columns and ensure float dtype\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 3: Extract Series properly\n",
    "close = df['Close']\n",
    "high = df['High']\n",
    "low = df['Low']\n",
    "volume = df['Volume']\n",
    "\n",
    "# Step 4: Compute technical indicators\n",
    "df['rsi'] = RSIIndicator(close=close).rsi()\n",
    "df['stoch'] = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "df['macd'] = MACD(close=close).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=close, window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=close, window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=close)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 5: Create future target labels\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Drop rows with NaN values caused by shifting and indicators\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 6: Prepare feature matrix and targets for ML models\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 7: Train and evaluate models using time-series cross-validation\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "results = []\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    # Time-series split\n",
    "    tscv = TimeSeriesSplit(n_splits=5)\n",
    "    \n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    # Store evaluation metrics\n",
    "    reg_scores = []\n",
    "    clf_scores = []\n",
    "    \n",
    "    for train_idx, test_idx in tscv.split(X):\n",
    "        X_train, X_test = X.iloc[train_idx], X.iloc[test_idx]\n",
    "        y_price_train, y_price_test = y_price.iloc[train_idx], y_price.iloc[test_idx]\n",
    "        y_dir_train, y_dir_test = y_dir.iloc[train_idx], y_dir.iloc[test_idx]\n",
    "        \n",
    "        # Train and predict\n",
    "        reg.fit(X_train, y_price_train)\n",
    "        clf.fit(X_train, y_dir_train)\n",
    "        \n",
    "        # Evaluate\n",
    "        price_pred = reg.predict(X_test)\n",
    "        dir_pred = clf.predict(X_test)\n",
    "        \n",
    "        reg_scores.append(mean_absolute_error(y_price_test, price_pred))\n",
    "        clf_scores.append(accuracy_score(y_dir_test, dir_pred))\n",
    "    \n",
    "    # Store models and results\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "    \n",
    "    print(f\"\\n{n}-Day Forecast Evaluation:\")\n",
    "    print(f\"  Price MAE: {sum(reg_scores)/len(reg_scores):.2f}\")\n",
    "    print(f\"  Direction Accuracy: {sum(clf_scores)/len(clf_scores):.2%}\")\n",
    "\n",
    "# Step 8: Predict using the latest available data (proper out-of-sample)\n",
    "# In a real application, you would need to:\n",
    "# 1. Get new data that wasn't used in training\n",
    "# 2. Calculate indicators based only on historical data\n",
    "# 3. Make prediction\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast (based on most recent trained data):\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(X.iloc[[-1]])[0]  # Fixed here\n",
    "    pred_dir = classifiers[n].predict(X.iloc[[-1]])[0]    # Fixed here\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "eb1b208e-6091-476b-86e0-cf123004ebb9",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[8], line 20\u001b[0m\n\u001b[0;32m     16\u001b[0m df \u001b[38;5;241m=\u001b[39m df[[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mOpen\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mVolume\u001b[39m\u001b[38;5;124m'\u001b[39m]]\u001b[38;5;241m.\u001b[39mastype(\u001b[38;5;28mfloat\u001b[39m)\n\u001b[0;32m     18\u001b[0m \u001b[38;5;66;03m# Step 3: Compute technical indicators\u001b[39;00m\n\u001b[0;32m     19\u001b[0m \u001b[38;5;66;03m# Convert to numpy arrays and flatten if needed\u001b[39;00m\n\u001b[1;32m---> 20\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi()\u001b[38;5;241m.\u001b[39mvalues\u001b[38;5;241m.\u001b[39mflatten()\n\u001b[0;32m     21\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m StochasticOscillator(high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch()\u001b[38;5;241m.\u001b[39mvalues\u001b[38;5;241m.\u001b[39mflatten()\n\u001b[0;32m     22\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff()\u001b[38;5;241m.\u001b[39mvalues\u001b[38;5;241m.\u001b[39mflatten()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.metrics import accuracy_score, mean_absolute_error\n",
    "from sklearn.model_selection import TimeSeriesSplit\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", progress=False)\n",
    "\n",
    "# Step 2: Select relevant columns and ensure float dtype\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 3: Compute technical indicators\n",
    "# Convert to numpy arrays and flatten if needed\n",
    "df['rsi'] = RSIIndicator(close=df['Close']).rsi().values.flatten()\n",
    "df['stoch'] = StochasticOscillator(high=df['High'], low=df['Low'], close=df['Close']).stoch().values.flatten()\n",
    "df['macd'] = MACD(close=df['Close']).macd_diff().values.flatten()\n",
    "df['obv'] = OnBalanceVolumeIndicator(close=df['Close'], volume=df['Volume']).on_balance_volume().values.flatten()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'], window=10).sma_indicator().values.flatten()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'], window=20).ema_indicator().values.flatten()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'])\n",
    "df['bb_bbm'] = bb.bollinger_mavg().values.flatten()\n",
    "df['bb_bbh'] = bb.bollinger_hband().values.flatten()\n",
    "df['bb_bbl'] = bb.bollinger_lband().values.flatten()\n",
    "\n",
    "# Step 4: Create future target labels\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Drop rows with NaN values\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train and evaluate models\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    # Time-series split\n",
    "    tscv = TimeSeriesSplit(n_splits=5)\n",
    "    \n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    # Cross-validation\n",
    "    for train_idx, test_idx in tscv.split(X):\n",
    "        X_train, X_test = X.iloc[train_idx], X.iloc[test_idx]\n",
    "        y_price_train, y_price_test = y_price.iloc[train_idx], y_price.iloc[test_idx]\n",
    "        y_dir_train, y_dir_test = y_dir.iloc[train_idx], y_dir.iloc[test_idx]\n",
    "        \n",
    "        reg.fit(X_train, y_price_train)\n",
    "        clf.fit(X_train, y_dir_train)\n",
    "    \n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Make predictions\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(X.iloc[[-1]])[0]\n",
    "    pred_dir = classifiers[n].predict(X.iloc[[-1]])[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "21395ba1-4e4a-4d12-b1eb-43238a8628e1",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[9], line 24\u001b[0m\n\u001b[0;32m     21\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m pd\u001b[38;5;241m.\u001b[39mSeries(np\u001b[38;5;241m.\u001b[39marray(indicator_output)\u001b[38;5;241m.\u001b[39mflatten(), index\u001b[38;5;241m=\u001b[39mdf\u001b[38;5;241m.\u001b[39mindex)\n\u001b[0;32m     23\u001b[0m \u001b[38;5;66;03m# Calculate indicators\u001b[39;00m\n\u001b[1;32m---> 24\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m safe_series_conversion(RSIIndicator(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mrsi())\n\u001b[0;32m     25\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m safe_series_conversion(StochasticOscillator(\n\u001b[0;32m     26\u001b[0m     high\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], low\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mstoch())\n\u001b[0;32m     27\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m safe_series_conversion(MACD(close\u001b[38;5;241m=\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\u001b[38;5;241m.\u001b[39mmacd_diff())\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", progress=False)\n",
    "\n",
    "# Step 2: Select relevant columns\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 3: Compute technical indicators with proper conversion\n",
    "def safe_series_conversion(indicator_output):\n",
    "    \"\"\"Convert indicator output to proper pandas Series\"\"\"\n",
    "    if isinstance(indicator_output, pd.Series):\n",
    "        return indicator_output\n",
    "    return pd.Series(np.array(indicator_output).flatten(), index=df.index)\n",
    "\n",
    "# Calculate indicators\n",
    "df['rsi'] = safe_series_conversion(RSIIndicator(close=df['Close']).rsi())\n",
    "df['stoch'] = safe_series_conversion(StochasticOscillator(\n",
    "    high=df['High'], low=df['Low'], close=df['Close']).stoch())\n",
    "df['macd'] = safe_series_conversion(MACD(close=df['Close']).macd_diff())\n",
    "df['obv'] = safe_series_conversion(OnBalanceVolumeIndicator(\n",
    "    close=df['Close'], volume=df['Volume']).on_balance_volume())\n",
    "df['sma_10'] = safe_series_conversion(SMAIndicator(\n",
    "    close=df['Close'], window=10).sma_indicator())\n",
    "df['ema_20'] = safe_series_conversion(EMAIndicator(\n",
    "    close=df['Close'], window=20).ema_indicator())\n",
    "\n",
    "# Bollinger Bands\n",
    "bb = BollingerBands(close=df['Close'])\n",
    "df['bb_bbm'] = safe_series_conversion(bb.bollinger_mavg())\n",
    "df['bb_bbh'] = safe_series_conversion(bb.bollinger_hband())\n",
    "df['bb_bbl'] = safe_series_conversion(bb.bollinger_lband())\n",
    "\n",
    "# Step 4: Create future targets\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Clean data\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "    \n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Make predictions\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(X.iloc[[-1]])[0]\n",
    "    pred_dir = classifiers[n].predict(X.iloc[[-1]])[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "4ee6e82e-9640-4641-9c31-9ae3644319e1",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Data must be 1-dimensional, got ndarray of shape (1861, 1) instead",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[10], line 50\u001b[0m\n\u001b[0;32m     43\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m (\n\u001b[0;32m     44\u001b[0m         pd\u001b[38;5;241m.\u001b[39mSeries(np\u001b[38;5;241m.\u001b[39marray(bb\u001b[38;5;241m.\u001b[39mbollinger_mavg())\u001b[38;5;241m.\u001b[39mflatten(), index\u001b[38;5;241m=\u001b[39mclose\u001b[38;5;241m.\u001b[39mindex),\n\u001b[0;32m     45\u001b[0m         pd\u001b[38;5;241m.\u001b[39mSeries(np\u001b[38;5;241m.\u001b[39marray(bb\u001b[38;5;241m.\u001b[39mbollinger_hband())\u001b[38;5;241m.\u001b[39mflatten(), index\u001b[38;5;241m=\u001b[39mclose\u001b[38;5;241m.\u001b[39mindex),\n\u001b[0;32m     46\u001b[0m         pd\u001b[38;5;241m.\u001b[39mSeries(np\u001b[38;5;241m.\u001b[39marray(bb\u001b[38;5;241m.\u001b[39mbollinger_lband())\u001b[38;5;241m.\u001b[39mflatten(), index\u001b[38;5;241m=\u001b[39mclose\u001b[38;5;241m.\u001b[39mindex)\n\u001b[0;32m     47\u001b[0m     )\n\u001b[0;32m     49\u001b[0m \u001b[38;5;66;03m# Calculate indicators\u001b[39;00m\n\u001b[1;32m---> 50\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mrsi\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m calculate_rsi(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\n\u001b[0;32m     51\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstoch\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m calculate_stochastic(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mHigh\u001b[39m\u001b[38;5;124m'\u001b[39m], df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLow\u001b[39m\u001b[38;5;124m'\u001b[39m], df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\n\u001b[0;32m     52\u001b[0m df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmacd\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m calculate_macd(df[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m])\n",
      "Cell \u001b[1;32mIn[10], line 18\u001b[0m, in \u001b[0;36mcalculate_rsi\u001b[1;34m(close)\u001b[0m\n\u001b[0;32m     17\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mcalculate_rsi\u001b[39m(close):\n\u001b[1;32m---> 18\u001b[0m     rsi \u001b[38;5;241m=\u001b[39m RSIIndicator(close\u001b[38;5;241m=\u001b[39mclose)\u001b[38;5;241m.\u001b[39mrsi()\n\u001b[0;32m     19\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m pd\u001b[38;5;241m.\u001b[39mSeries(np\u001b[38;5;241m.\u001b[39marray(rsi)\u001b[38;5;241m.\u001b[39mflatten(), index\u001b[38;5;241m=\u001b[39mclose\u001b[38;5;241m.\u001b[39mindex)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:34\u001b[0m, in \u001b[0;36mRSIIndicator.__init__\u001b[1;34m(self, close, window, fillna)\u001b[0m\n\u001b[0;32m     32\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window \u001b[38;5;241m=\u001b[39m window\n\u001b[0;32m     33\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_fillna \u001b[38;5;241m=\u001b[39m fillna\n\u001b[1;32m---> 34\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_run()\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\ta\\momentum.py:48\u001b[0m, in \u001b[0;36mRSIIndicator._run\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m     44\u001b[0m emadn \u001b[38;5;241m=\u001b[39m down_direction\u001b[38;5;241m.\u001b[39mewm(\n\u001b[0;32m     45\u001b[0m     alpha\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m/\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_window, min_periods\u001b[38;5;241m=\u001b[39mmin_periods, adjust\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m     46\u001b[0m )\u001b[38;5;241m.\u001b[39mmean()\n\u001b[0;32m     47\u001b[0m relative_strength \u001b[38;5;241m=\u001b[39m emaup \u001b[38;5;241m/\u001b[39m emadn\n\u001b[1;32m---> 48\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_rsi \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mSeries(\n\u001b[0;32m     49\u001b[0m     np\u001b[38;5;241m.\u001b[39mwhere(emadn \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m, \u001b[38;5;241m100\u001b[39m, \u001b[38;5;241m100\u001b[39m \u001b[38;5;241m-\u001b[39m (\u001b[38;5;241m100\u001b[39m \u001b[38;5;241m/\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m+\u001b[39m relative_strength))),\n\u001b[0;32m     50\u001b[0m     index\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_close\u001b[38;5;241m.\u001b[39mindex,\n\u001b[0;32m     51\u001b[0m )\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\series.py:584\u001b[0m, in \u001b[0;36mSeries.__init__\u001b[1;34m(self, data, index, dtype, name, copy, fastpath)\u001b[0m\n\u001b[0;32m    582\u001b[0m         data \u001b[38;5;241m=\u001b[39m data\u001b[38;5;241m.\u001b[39mcopy()\n\u001b[0;32m    583\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 584\u001b[0m     data \u001b[38;5;241m=\u001b[39m sanitize_array(data, index, dtype, copy)\n\u001b[0;32m    586\u001b[0m     manager \u001b[38;5;241m=\u001b[39m _get_option(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.data_manager\u001b[39m\u001b[38;5;124m\"\u001b[39m, silent\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n\u001b[0;32m    587\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m manager \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:659\u001b[0m, in \u001b[0;36msanitize_array\u001b[1;34m(data, index, dtype, copy, allow_2d)\u001b[0m\n\u001b[0;32m    656\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mndarray, subarr)\n\u001b[0;32m    657\u001b[0m             subarr \u001b[38;5;241m=\u001b[39m maybe_infer_to_datetimelike(subarr)\n\u001b[1;32m--> 659\u001b[0m subarr \u001b[38;5;241m=\u001b[39m _sanitize_ndim(subarr, data, dtype, index, allow_2d\u001b[38;5;241m=\u001b[39mallow_2d)\n\u001b[0;32m    661\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(subarr, np\u001b[38;5;241m.\u001b[39mndarray):\n\u001b[0;32m    662\u001b[0m     \u001b[38;5;66;03m# at this point we should have dtype be None or subarr.dtype == dtype\u001b[39;00m\n\u001b[0;32m    663\u001b[0m     dtype \u001b[38;5;241m=\u001b[39m cast(np\u001b[38;5;241m.\u001b[39mdtype, dtype)\n",
      "File \u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\construction.py:718\u001b[0m, in \u001b[0;36m_sanitize_ndim\u001b[1;34m(result, data, dtype, index, allow_2d)\u001b[0m\n\u001b[0;32m    716\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m allow_2d:\n\u001b[0;32m    717\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m result\n\u001b[1;32m--> 718\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    719\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mData must be 1-dimensional, got ndarray of shape \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdata\u001b[38;5;241m.\u001b[39mshape\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m instead\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    720\u001b[0m     )\n\u001b[0;32m    721\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_object_dtype(dtype) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(dtype, ExtensionDtype):\n\u001b[0;32m    722\u001b[0m     \u001b[38;5;66;03m# i.e. NumpyEADtype(\"O\")\u001b[39;00m\n\u001b[0;32m    724\u001b[0m     result \u001b[38;5;241m=\u001b[39m com\u001b[38;5;241m.\u001b[39masarray_tuplesafe(data, dtype\u001b[38;5;241m=\u001b[39mnp\u001b[38;5;241m.\u001b[39mdtype(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mobject\u001b[39m\u001b[38;5;124m\"\u001b[39m))\n",
      "\u001b[1;31mValueError\u001b[0m: Data must be 1-dimensional, got ndarray of shape (1861, 1) instead"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\", progress=False)\n",
    "\n",
    "# Step 2: Select relevant columns\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].astype(float)\n",
    "\n",
    "# Step 3: Compute technical indicators with proper conversion\n",
    "def calculate_rsi(close):\n",
    "    rsi = RSIIndicator(close=close).rsi()\n",
    "    return pd.Series(np.array(rsi).flatten(), index=close.index)\n",
    "\n",
    "def calculate_stochastic(high, low, close):\n",
    "    stoch = StochasticOscillator(high=high, low=low, close=close).stoch()\n",
    "    return pd.Series(np.array(stoch).flatten(), index=close.index)\n",
    "\n",
    "def calculate_macd(close):\n",
    "    macd = MACD(close=close).macd_diff()\n",
    "    return pd.Series(np.array(macd).flatten(), index=close.index)\n",
    "\n",
    "def calculate_obv(close, volume):\n",
    "    obv = OnBalanceVolumeIndicator(close=close, volume=volume).on_balance_volume()\n",
    "    return pd.Series(np.array(obv).flatten(), index=close.index)\n",
    "\n",
    "def calculate_sma(close, window):\n",
    "    sma = SMAIndicator(close=close, window=window).sma_indicator()\n",
    "    return pd.Series(np.array(sma).flatten(), index=close.index)\n",
    "\n",
    "def calculate_ema(close, window):\n",
    "    ema = EMAIndicator(close=close, window=window).ema_indicator()\n",
    "    return pd.Series(np.array(ema).flatten(), index=close.index)\n",
    "\n",
    "def calculate_bollinger_bands(close):\n",
    "    bb = BollingerBands(close=close)\n",
    "    return (\n",
    "        pd.Series(np.array(bb.bollinger_mavg()).flatten(), index=close.index),\n",
    "        pd.Series(np.array(bb.bollinger_hband()).flatten(), index=close.index),\n",
    "        pd.Series(np.array(bb.bollinger_lband()).flatten(), index=close.index)\n",
    "    )\n",
    "\n",
    "# Calculate indicators\n",
    "df['rsi'] = calculate_rsi(df['Close'])\n",
    "df['stoch'] = calculate_stochastic(df['High'], df['Low'], df['Close'])\n",
    "df['macd'] = calculate_macd(df['Close'])\n",
    "df['obv'] = calculate_obv(df['Close'], df['Volume'])\n",
    "df['sma_10'] = calculate_sma(df['Close'], 10)\n",
    "df['ema_20'] = calculate_ema(df['Close'], 20)\n",
    "\n",
    "bb_mavg, bb_hband, bb_lband = calculate_bollinger_bands(df['Close'])\n",
    "df['bb_bbm'] = bb_mavg\n",
    "df['bb_bbh'] = bb_hband\n",
    "df['bb_bbl'] = bb_lband\n",
    "\n",
    "# Step 4: Create future targets\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "# Clean data\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features and targets\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "    \n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Make predictions\n",
    "print(\"\\nðŸ“ˆ IBM Stock Forecast:\")\n",
    "for n in [1, 2, 3, 5]:\n",
    "    pred_price = regressors[n].predict(X.iloc[[-1]])[0]\n",
    "    pred_dir = classifiers[n].predict(X.iloc[[-1]])[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ”® Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "6805e9b9-e09d-41e3-8216-dc0e956bddbc",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM 5-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 5 days: $260.37\n",
      "ðŸ“‰ Predicted direction: Down\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price = df['next_5d_close']\n",
    "y_dir = df['dir_5d']\n",
    "\n",
    "regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "regressor.fit(X, y_price)\n",
    "classifier.fit(X, y_dir)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "predicted_price = regressor.predict(latest_data)[0]\n",
    "predicted_direction = classifier.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "25c6abca-cec1-4e28-b196-169b7ce457ee",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m~\\AppData\\Local\\Temp\\ipykernel_35308\\1471021807.py\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[0;32m     38\u001b[0m \u001b[1;31m# Step 4: Create targets for multiple forecast horizons\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     39\u001b[0m \u001b[0mforecast_days\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m2\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m3\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m5\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     40\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mn\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mforecast_days\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     41\u001b[0m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mshift\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m-\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 42\u001b[1;33m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mdir_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m>\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mint\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     43\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     44\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdropna\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0minplace\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     45\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\ops\\common.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     72\u001b[0m                     \u001b[1;32mreturn\u001b[0m \u001b[0mNotImplemented\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     73\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     74\u001b[0m         \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mitem_from_zerodim\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     75\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 76\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mmethod\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\arraylike.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     46\u001b[0m     \u001b[1;33m@\u001b[0m\u001b[0munpack_zerodim_and_defer\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"__lt__\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m__lt__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 48\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0moperator\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mlt\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, op)\u001b[0m\n\u001b[0;32m   7894\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7895\u001b[0m         \u001b[0maxis\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mLiteral\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m1\u001b[0m  \u001b[1;31m# only relevant for Series other case\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7896\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 7897\u001b[1;33m         \u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_align_for_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   7898\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7899\u001b[0m         \u001b[1;31m# See GH#4537 for discussion of scalar op behavior\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7900\u001b[0m         \u001b[0mnew_data\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_dispatch_frame_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, axis, flex, level)\u001b[0m\n\u001b[0;32m   8201\u001b[0m             \u001b[1;31m# axis=1 is default for DataFrame-with-Series op\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8202\u001b[0m             \u001b[0maxis\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mif\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m \u001b[1;32melse\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8203\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8204\u001b[0m                 \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mleft\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mequals\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mright\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mindex\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 8205\u001b[1;33m                     raise ValueError(\n\u001b[0m\u001b[0;32m   8206\u001b[0m                         \u001b[1;34m\"Operands are not aligned. Do \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8207\u001b[0m                         \u001b[1;34m\"`left, right = left.align(right, axis=1, copy=False)` \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8208\u001b[0m                         \u001b[1;34m\"before operating.\"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating."
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for multiple forecast horizons\n",
    "forecast_days = [1, 2, 3, 5]\n",
    "for n in forecast_days:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare feature matrix\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models for each forecast horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in forecast_days:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "\n",
    "    reg = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    clf = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "    reg.fit(X, y_price)\n",
    "    clf.fit(X, y_dir)\n",
    "\n",
    "    regressors[n] = reg\n",
    "    classifiers[n] = clf\n",
    "\n",
    "# Step 7: Predict using the latest data\n",
    "latest_data = X.iloc[[-1]]\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Stock Forecasts:\")\n",
    "for n in forecast_days:\n",
    "    pred_price = regressors[n].predict(latest_data)[0]\n",
    "    pred_dir = classifiers[n].predict(latest_data)[0]\n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ“ˆ Predicted Close: ${pred_price:.2f}\")\n",
    "    print(f\"   ðŸ“Š Direction: {'Up' if pred_dir == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "6e949dc7-7016-45fc-bf00-933fb16da757",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM Stock Forecast\n",
      "---------------------\n",
      "\n",
      "â³ 1-Day Forecast:\n",
      "   ðŸ’° Predicted price: $266.79\n",
      "   ðŸ“ˆ Direction: Down\n"
     ]
    },
    {
     "ename": "TypeError",
     "evalue": "unsupported format string passed to Series.__format__",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[13], line 83\u001b[0m\n\u001b[0;32m     81\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m   ðŸ’° Predicted price: $\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mpredicted_price\u001b[38;5;132;01m:\u001b[39;00m\u001b[38;5;124m.2f\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m     82\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m   ðŸ“ˆ Direction: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mUp\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mif\u001b[39;00m\u001b[38;5;250m \u001b[39mpredicted_direction\u001b[38;5;250m \u001b[39m\u001b[38;5;241m==\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;241m1\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01melse\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDown\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m---> 83\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m   â„¹ï¸ Current price: $\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39miloc[\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m]\u001b[38;5;132;01m:\u001b[39;00m\u001b[38;5;124m.2f\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m     84\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m n \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m     85\u001b[0m     \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m   ðŸ”„ Potential change: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m(predicted_price\u001b[38;5;241m/\u001b[39mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39miloc[\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m]\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m)\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m100\u001b[39m\u001b[38;5;132;01m:\u001b[39;00m\u001b[38;5;124m.2f\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m%\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mTypeError\u001b[0m: unsupported format string passed to Series.__format__"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for multiple horizons\n",
    "for n in [1, 2, 3, 5]:  # Added 1-day, 2-day, and 3-day targets\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models for each horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    regressor.fit(X, y_price)\n",
    "    classifier.fit(X, y_dir)\n",
    "    \n",
    "    regressors[n] = regressor\n",
    "    classifiers[n] = classifier\n",
    "\n",
    "# Step 7: Predict for all horizons\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Stock Forecast\")\n",
    "print(\"---------------------\")\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    predicted_price = regressors[n].predict(latest_data)[0]\n",
    "    predicted_direction = classifiers[n].predict(latest_data)[0]\n",
    "    \n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ’° Predicted price: ${predicted_price:.2f}\")\n",
    "    print(f\"   ðŸ“ˆ Direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n",
    "    print(f\"   â„¹ï¸ Current price: ${df['Close'].iloc[-1]:.2f}\")\n",
    "    if n == 1:\n",
    "        print(f\"   ðŸ”„ Potential change: {(predicted_price/df['Close'].iloc[-1]-1)*100:.2f}%\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "c53dae31-ffc7-4fa2-9653-27867907271d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m~\\AppData\\Local\\Temp\\ipykernel_35308\\3202758234.py\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[0;32m     41\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     42\u001b[0m \u001b[1;31m# Step 4: Create targets for multiple horizons\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     43\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mn\u001b[0m \u001b[1;32min\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m2\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m3\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m5\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     44\u001b[0m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mshift\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m-\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 45\u001b[1;33m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mdir_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m>\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mint\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     46\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdropna\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0minplace\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     48\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\ops\\common.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     72\u001b[0m                     \u001b[1;32mreturn\u001b[0m \u001b[0mNotImplemented\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     73\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     74\u001b[0m         \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mitem_from_zerodim\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     75\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 76\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mmethod\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\arraylike.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     46\u001b[0m     \u001b[1;33m@\u001b[0m\u001b[0munpack_zerodim_and_defer\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"__lt__\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m__lt__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 48\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0moperator\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mlt\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, op)\u001b[0m\n\u001b[0;32m   7894\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7895\u001b[0m         \u001b[0maxis\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mLiteral\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m1\u001b[0m  \u001b[1;31m# only relevant for Series other case\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7896\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 7897\u001b[1;33m         \u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_align_for_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   7898\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7899\u001b[0m         \u001b[1;31m# See GH#4537 for discussion of scalar op behavior\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7900\u001b[0m         \u001b[0mnew_data\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_dispatch_frame_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, axis, flex, level)\u001b[0m\n\u001b[0;32m   8201\u001b[0m             \u001b[1;31m# axis=1 is default for DataFrame-with-Series op\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8202\u001b[0m             \u001b[0maxis\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mif\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m \u001b[1;32melse\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8203\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8204\u001b[0m                 \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mleft\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mequals\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mright\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mindex\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 8205\u001b[1;33m                     raise ValueError(\n\u001b[0m\u001b[0;32m   8206\u001b[0m                         \u001b[1;34m\"Operands are not aligned. Do \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8207\u001b[0m                         \u001b[1;34m\"`left, right = left.align(right, axis=1, copy=False)` \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8208\u001b[0m                         \u001b[1;34m\"before operating.\"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating."
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for multiple horizons\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models for each horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    regressor.fit(X, y_price)\n",
    "    classifier.fit(X, y_dir)\n",
    "    \n",
    "    regressors[n] = regressor\n",
    "    classifiers[n] = classifier\n",
    "\n",
    "# Step 7: Predict for all horizons\n",
    "latest_data = X.iloc[-1:]\n",
    "current_price = float(df['Close'].iloc[-1])  # Convert to float explicitly\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Stock Forecast\")\n",
    "print(\"---------------------\")\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    predicted_price = float(regressors[n].predict(latest_data)[0])  # Ensure float type\n",
    "    predicted_direction = classifiers[n].predict(latest_data)[0]\n",
    "    \n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ’° Predicted price: ${predicted_price:.2f}\")\n",
    "    print(f\"   ðŸ“ˆ Direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n",
    "    print(f\"   â„¹ï¸ Current price: ${current_price:.2f}\")\n",
    "    if n == 1:\n",
    "        print(f\"   ðŸ”„ Potential change: {(predicted_price/current_price-1)*100:.2f}%\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "269b05dd-41d3-4e79-a5d1-5d1b7da05753",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (2716665742.py, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  Cell \u001b[1;32mIn[15], line 1\u001b[1;36m\u001b[0m\n\u001b[1;33m    [*********************100%***********************]  1 of 1 completed\u001b[0m\n\u001b[1;37m     ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "[*********************100%***********************]  1 of 1 completed\n",
    "---------------------------------------------------------------------------\n",
    "ValueError                                Traceback (most recent call last)\n",
    "~\\AppData\\Local\\Temp\\ipykernel_35308\\3202758234.py in ?()\n",
    "     41 \n",
    "     42 # Step 4: Create targets for multiple horizons\n",
    "     43 for n in [1, 2, 3, 5]:\n",
    "     44     df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "---> 45     df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "     46 \n",
    "     47 df.dropna(inplace=True)\n",
    "     48 \n",
    "\n",
    "~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\ops\\common.py in ?(self, other)\n",
    "     72                     return NotImplemented\n",
    "     73 \n",
    "     74         other = item_from_zerodim(other)\n",
    "     75 \n",
    "---> 76         return method(self, other)\n",
    "\n",
    "~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\arraylike.py in ?(self, other)\n",
    "     46     @unpack_zerodim_and_defer(\"__lt__\")\n",
    "     47     def __lt__(self, other):\n",
    "---> 48         return self._cmp_method(other, operator.lt)\n",
    "\n",
    "~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py in ?(self, other, op)\n",
    "   7894     def _cmp_method(self, other, op):\n",
    "   7895         axis: Literal[1] = 1  # only relevant for Series other case\n",
    "   7896 \n",
    "-> 7897         self, other = self._align_for_op(other, axis, flex=False, level=None)\n",
    "   7898 \n",
    "   7899         # See GH#4537 for discussion of scalar op behavior\n",
    "   7900         new_data = self._dispatch_frame_op(other, op, axis=axis)\n",
    "\n",
    "~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py in ?(self, other, axis, flex, level)\n",
    "   8201             # axis=1 is default for DataFrame-with-Series op\n",
    "   8202             axis = axis if axis is not None else 1\n",
    "   8203             if not flex:\n",
    "   8204                 if not left.axes[axis].equals(right.index):\n",
    "-> 8205                     raise ValueError(\n",
    "   8206                         \"Operands are not aligned. Do \"\n",
    "   8207                         \"`left, right = left.align(right, axis=1, copy=False)` \"\n",
    "   8208                         \"before operating.\"\n",
    "\n",
    "ValueError: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "46357ae2-d25b-4da7-a233-11370711a1b9",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m~\\AppData\\Local\\Temp\\ipykernel_35308\\3202758234.py\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[0;32m     41\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     42\u001b[0m \u001b[1;31m# Step 4: Create targets for multiple horizons\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     43\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mn\u001b[0m \u001b[1;32min\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m2\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m3\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m5\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     44\u001b[0m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mshift\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m-\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 45\u001b[1;33m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mdir_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m>\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mint\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     46\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdropna\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0minplace\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     48\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\ops\\common.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     72\u001b[0m                     \u001b[1;32mreturn\u001b[0m \u001b[0mNotImplemented\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     73\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     74\u001b[0m         \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mitem_from_zerodim\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     75\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 76\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mmethod\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\arraylike.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     46\u001b[0m     \u001b[1;33m@\u001b[0m\u001b[0munpack_zerodim_and_defer\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"__lt__\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m__lt__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 48\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0moperator\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mlt\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, op)\u001b[0m\n\u001b[0;32m   7894\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7895\u001b[0m         \u001b[0maxis\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mLiteral\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m1\u001b[0m  \u001b[1;31m# only relevant for Series other case\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7896\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 7897\u001b[1;33m         \u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_align_for_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   7898\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7899\u001b[0m         \u001b[1;31m# See GH#4537 for discussion of scalar op behavior\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7900\u001b[0m         \u001b[0mnew_data\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_dispatch_frame_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, axis, flex, level)\u001b[0m\n\u001b[0;32m   8201\u001b[0m             \u001b[1;31m# axis=1 is default for DataFrame-with-Series op\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8202\u001b[0m             \u001b[0maxis\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mif\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m \u001b[1;32melse\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8203\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8204\u001b[0m                 \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mleft\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mequals\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mright\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mindex\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 8205\u001b[1;33m                     raise ValueError(\n\u001b[0m\u001b[0;32m   8206\u001b[0m                         \u001b[1;34m\"Operands are not aligned. Do \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8207\u001b[0m                         \u001b[1;34m\"`left, right = left.align(right, axis=1, copy=False)` \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8208\u001b[0m                         \u001b[1;34m\"before operating.\"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating."
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for multiple horizons\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    df[f'dir_{n}d'] = (df[f'next_{n}d_close'] > df['Close']).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models for each horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    regressor.fit(X, y_price)\n",
    "    classifier.fit(X, y_dir)\n",
    "    \n",
    "    regressors[n] = regressor\n",
    "    classifiers[n] = classifier\n",
    "\n",
    "# Step 7: Predict for all horizons\n",
    "latest_data = X.iloc[-1:]\n",
    "current_price = float(df['Close'].iloc[-1])  # Convert to float explicitly\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Stock Forecast\")\n",
    "print(\"---------------------\")\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    predicted_price = float(regressors[n].predict(latest_data)[0])  # Ensure float type\n",
    "    predicted_direction = classifiers[n].predict(latest_data)[0]\n",
    "    \n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ’° Predicted price: ${predicted_price:.2f}\")\n",
    "    print(f\"   ðŸ“ˆ Direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n",
    "    print(f\"   â„¹ï¸ Current price: ${current_price:.2f}\")\n",
    "    if n == 1:\n",
    "        print(f\"   ðŸ”„ Potential change: {(predicted_price/current_price-1)*100:.2f}%\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "6c00aca4-1d83-47c7-b61a-aa2e968fd83d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m~\\AppData\\Local\\Temp\\ipykernel_35308\\1292447268.py\u001b[0m in \u001b[0;36m?\u001b[1;34m()\u001b[0m\n\u001b[0;32m     43\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mn\u001b[0m \u001b[1;32min\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m2\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m3\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m5\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     44\u001b[0m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mshift\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m-\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     45\u001b[0m     \u001b[1;31m# Ensure proper alignment before comparison\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     46\u001b[0m     \u001b[0maligned_next\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maligned_close\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mnext_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md_close\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0malign\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'Close'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 47\u001b[1;33m     \u001b[0mdf\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33mf'\u001b[0m\u001b[1;33mdir_\u001b[0m\u001b[1;33m{\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m}\u001b[0m\u001b[1;33md\u001b[0m\u001b[1;33m'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0maligned_next\u001b[0m \u001b[1;33m>\u001b[0m \u001b[0maligned_close\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mint\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     48\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     49\u001b[0m \u001b[0mdf\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdropna\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0minplace\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     50\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\ops\\common.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     72\u001b[0m                     \u001b[1;32mreturn\u001b[0m \u001b[0mNotImplemented\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     73\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     74\u001b[0m         \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mitem_from_zerodim\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     75\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 76\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mmethod\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\arraylike.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other)\u001b[0m\n\u001b[0;32m     46\u001b[0m     \u001b[1;33m@\u001b[0m\u001b[0munpack_zerodim_and_defer\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"__lt__\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     47\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m__lt__\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 48\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0moperator\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mlt\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, op)\u001b[0m\n\u001b[0;32m   7894\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_cmp_method\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7895\u001b[0m         \u001b[0maxis\u001b[0m\u001b[1;33m:\u001b[0m \u001b[0mLiteral\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m1\u001b[0m  \u001b[1;31m# only relevant for Series other case\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7896\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 7897\u001b[1;33m         \u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mother\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_align_for_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mFalse\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mlevel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   7898\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7899\u001b[0m         \u001b[1;31m# See GH#4537 for discussion of scalar op behavior\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   7900\u001b[0m         \u001b[0mnew_data\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_dispatch_frame_op\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mother\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mop\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Desktop\\sample_project\\env\\Lib\\site-packages\\pandas\\core\\frame.py\u001b[0m in \u001b[0;36m?\u001b[1;34m(self, other, axis, flex, level)\u001b[0m\n\u001b[0;32m   8201\u001b[0m             \u001b[1;31m# axis=1 is default for DataFrame-with-Series op\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8202\u001b[0m             \u001b[0maxis\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mif\u001b[0m \u001b[0maxis\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m \u001b[1;32melse\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8203\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mflex\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8204\u001b[0m                 \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mleft\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0maxes\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mequals\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mright\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mindex\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m-> 8205\u001b[1;33m                     raise ValueError(\n\u001b[0m\u001b[0;32m   8206\u001b[0m                         \u001b[1;34m\"Operands are not aligned. Do \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8207\u001b[0m                         \u001b[1;34m\"`left, right = left.align(right, axis=1, copy=False)` \"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   8208\u001b[0m                         \u001b[1;34m\"before operating.\"\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: Operands are not aligned. Do `left, right = left.align(right, axis=1, copy=False)` before operating."
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Create targets for multiple horizons\n",
    "for n in [1, 2, 3, 5]:\n",
    "    df[f'next_{n}d_close'] = df['Close'].shift(-n)\n",
    "    # Ensure proper alignment before comparison\n",
    "    aligned_next, aligned_close = df[f'next_{n}d_close'].align(df['Close'])\n",
    "    df[f'dir_{n}d'] = (aligned_next > aligned_close).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# Step 6: Train models for each horizon\n",
    "regressors = {}\n",
    "classifiers = {}\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    y_price = df[f'next_{n}d_close']\n",
    "    y_dir = df[f'dir_{n}d']\n",
    "    \n",
    "    regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "    classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "    \n",
    "    regressor.fit(X, y_price)\n",
    "    classifier.fit(X, y_dir)\n",
    "    \n",
    "    regressors[n] = regressor\n",
    "    classifiers[n] = classifier\n",
    "\n",
    "# Step 7: Predict for all horizons\n",
    "latest_data = X.iloc[-1:]\n",
    "current_price = float(df['Close'].iloc[-1])  # Convert to float explicitly\n",
    "\n",
    "print(\"\\nðŸ“Š IBM Stock Forecast\")\n",
    "print(\"---------------------\")\n",
    "\n",
    "for n in [1, 2, 3, 5]:\n",
    "    predicted_price = float(regressors[n].predict(latest_data)[0])  # Ensure float type\n",
    "    predicted_direction = classifiers[n].predict(latest_data)[0]\n",
    "    \n",
    "    print(f\"\\nâ³ {n}-Day Forecast:\")\n",
    "    print(f\"   ðŸ’° Predicted price: ${predicted_price:.2f}\")\n",
    "    print(f\"   ðŸ“ˆ Direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n",
    "    print(f\"   â„¹ï¸ Current price: ${current_price:.2f}\")\n",
    "    if n == 1:\n",
    "        print(f\"   ðŸ”„ Potential change: {(predicted_price/current_price-1)*100:.2f}%\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "199d24ca-c602-43f5-945e-df418b94e1fe",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM 5-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 5 days: $260.23\n",
      "ðŸ“‰ Predicted direction: Down\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(), \n",
    "    low=df['Low'].squeeze(), \n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(), \n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "y_price = df['next_5d_close']\n",
    "y_dir = df['dir_5d']\n",
    "\n",
    "regressor = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "\n",
    "regressor.fit(X, y_price)\n",
    "classifier.fit(X, y_dir)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "predicted_price = regressor.predict(latest_data)[0]\n",
    "predicted_direction = classifier.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction == 1 else 'Down'}\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "5944e9e3-2557-4f03-8630-78d9eec86da3",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM Forecast\n",
      "\n",
      "ðŸ—“ï¸ 1-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 1 day: $262.41\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ 2-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 2 days: $259.84\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ 5-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 5 days: $260.20\n",
      "ðŸ“‰ Predicted direction: Down\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(-2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# 1-day prediction models\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_1d.fit(X, y_price_1d)\n",
    "classifier_1d.fit(X, y_dir_1d)\n",
    "\n",
    "# 2-day prediction models\n",
    "y_price_2d = df['next_2d_close']\n",
    "y_dir_2d = df['dir_2d']\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_2d.fit(X, y_price_2d)\n",
    "classifier_2d.fit(X, y_dir_2d)\n",
    "\n",
    "# 5-day prediction models\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_5d.fit(X, y_price_5d)\n",
    "classifier_5d.fit(X, y_dir_5d)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "# 1-day prediction\n",
    "predicted_price_1d = regressor_1d.predict(latest_data)[0]\n",
    "predicted_direction_1d = classifier_1d.predict(latest_data)[0]\n",
    "\n",
    "# 2-day prediction\n",
    "predicted_price_2d = regressor_2d.predict(latest_data)[0]\n",
    "predicted_direction_2d = classifier_2d.predict(latest_data)[0]\n",
    "\n",
    "# 5-day prediction\n",
    "predicted_price_5d = regressor_5d.predict(latest_data)[0]\n",
    "predicted_direction_5d = classifier_5d.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM Forecast\")\n",
    "print(\"\\nðŸ—“ï¸ 1-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 1 day: ${predicted_price_1d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "\n",
    "print(\"\\nðŸ—“ï¸ 2-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 2 days: ${predicted_price_2d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "\n",
    "print(\"\\nðŸ—“ï¸ 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price_5d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_5d == 1 else 'Down'}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "aff64bb1-9729-4e72-a7a5-964424a045e7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š PANW Forecast\n",
      "\n",
      "ðŸ—“ï¸ 1-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 1 day: $188.75\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ 2-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 2 days: $190.29\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ 3-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 3 days: $191.60\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ 4-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 4 days: $190.69\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ 5-Day Forecast\n",
      "ðŸ“ˆ Predicted price in 5 days: $190.80\n",
      "ðŸ“‰ Predicted direction: Down\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"PANW\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(-2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 3-day prediction\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['dir_3d'] = (df['next_3d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 4-day prediction\n",
    "df['next_4d_close'] = df['Close'].shift(-4)\n",
    "df['dir_4d'] = (df['next_4d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# 1-day prediction models\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_1d.fit(X, y_price_1d)\n",
    "classifier_1d.fit(X, y_dir_1d)\n",
    "\n",
    "# 2-day prediction models\n",
    "y_price_2d = df['next_2d_close']\n",
    "y_dir_2d = df['dir_2d']\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_2d.fit(X, y_price_2d)\n",
    "classifier_2d.fit(X, y_dir_2d)\n",
    "\n",
    "# 3-day prediction models\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "regressor_3d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_3d.fit(X, y_price_3d)\n",
    "classifier_3d.fit(X, y_dir_3d)\n",
    "\n",
    "# 4-day prediction models\n",
    "y_price_4d = df['next_4d_close']\n",
    "y_dir_4d = df['dir_4d']\n",
    "regressor_4d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_4d.fit(X, y_price_4d)\n",
    "classifier_4d.fit(X, y_dir_4d)\n",
    "\n",
    "# 5-day prediction models\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_5d.fit(X, y_price_5d)\n",
    "classifier_5d.fit(X, y_dir_5d)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "# 1-day prediction\n",
    "predicted_price_1d = regressor_1d.predict(latest_data)[0]\n",
    "predicted_direction_1d = classifier_1d.predict(latest_data)[0]\n",
    "\n",
    "# 2-day prediction\n",
    "predicted_price_2d = regressor_2d.predict(latest_data)[0]\n",
    "predicted_direction_2d = classifier_2d.predict(latest_data)[0]\n",
    "\n",
    "# 3-day prediction\n",
    "predicted_price_3d = regressor_3d.predict(latest_data)[0]\n",
    "predicted_direction_3d = classifier_3d.predict(latest_data)[0]\n",
    "\n",
    "# 4-day prediction\n",
    "predicted_price_4d = regressor_4d.predict(latest_data)[0]\n",
    "predicted_direction_4d = classifier_4d.predict(latest_data)[0]\n",
    "\n",
    "# 5-day prediction\n",
    "predicted_price_5d = regressor_5d.predict(latest_data)[0]\n",
    "predicted_direction_5d = classifier_5d.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š PANW Forecast\")\n",
    "\n",
    "print(\"\\nðŸ—“ï¸ 1-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 1 day: ${predicted_price_1d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "\n",
    "print(\"\\nðŸ—“ï¸ 2-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 2 days: ${predicted_price_2d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "\n",
    "print(\"\\nðŸ—“ï¸ 3-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 3 days: ${predicted_price_3d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_3d == 1 else 'Down'}\")\n",
    "\n",
    "print(\"\\nðŸ—“ï¸ 4-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 4 days: ${predicted_price_4d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_4d == 1 else 'Down'}\")\n",
    "\n",
    "print(\"\\nðŸ—“ï¸ 5-Day Forecast\")\n",
    "print(f\"ðŸ“ˆ Predicted price in 5 days: ${predicted_price_5d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_5d == 1 else 'Down'}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "2e0a1fdc-24b9-4aff-863f-abd90b71332a",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM Forecast\n",
      "\n",
      "--- Debugging Information ---\n"
     ]
    },
    {
     "ename": "TypeError",
     "evalue": "unsupported format string passed to Series.__format__",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[22], line 136\u001b[0m\n\u001b[0;32m    133\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124mðŸ“Š IBM Forecast\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    135\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m--- Debugging Information ---\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m--> 136\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mLatest Closing Price (from X): $\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39miloc[\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m]\u001b[38;5;132;01m:\u001b[39;00m\u001b[38;5;124m.2f\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    137\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mPredicted Price (1-day): $\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mpredicted_price_1d\u001b[38;5;132;01m:\u001b[39;00m\u001b[38;5;124m.2f\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    138\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mPredicted Direction (1-day): \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mUp\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mif\u001b[39;00m\u001b[38;5;250m \u001b[39mpredicted_direction_1d\u001b[38;5;250m \u001b[39m\u001b[38;5;241m==\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;241m1\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01melse\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDown\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mTypeError\u001b[0m: unsupported format string passed to Series.__format__"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(-2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 3-day prediction\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['dir_3d'] = (df['next_3d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 4-day prediction\n",
    "df['next_4d_close'] = df['Close'].shift(-4)\n",
    "df['dir_4d'] = (df['next_4d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# 1-day prediction models\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_1d.fit(X, y_price_1d)\n",
    "classifier_1d.fit(X, y_dir_1d)\n",
    "\n",
    "# 2-day prediction models\n",
    "y_price_2d = df['next_2d_close']\n",
    "y_dir_2d = df['dir_2d']\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_2d.fit(X, y_price_2d)\n",
    "classifier_2d.fit(X, y_dir_2d)\n",
    "\n",
    "# 3-day prediction models\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "regressor_3d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_3d.fit(X, y_price_3d)\n",
    "classifier_3d.fit(X, y_dir_3d)\n",
    "\n",
    "# 4-day prediction models\n",
    "y_price_4d = df['next_4d_close']\n",
    "y_dir_4d = df['dir_4d']\n",
    "regressor_4d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_4d.fit(X, y_price_4d)\n",
    "classifier_4d.fit(X, y_dir_4d)\n",
    "\n",
    "# 5-day prediction models\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_5d.fit(X, y_price_5d)\n",
    "classifier_5d.fit(X, y_dir_5d)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "# 1-day prediction\n",
    "predicted_price_1d = regressor_1d.predict(latest_data)[0]\n",
    "predicted_direction_1d = classifier_1d.predict(latest_data)[0]\n",
    "\n",
    "# 2-day prediction\n",
    "predicted_price_2d = regressor_2d.predict(latest_data)[0]\n",
    "predicted_direction_2d = classifier_2d.predict(latest_data)[0]\n",
    "\n",
    "# 3-day prediction\n",
    "predicted_price_3d = regressor_3d.predict(latest_data)[0]\n",
    "predicted_direction_3d = classifier_3d.predict(latest_data)[0]\n",
    "\n",
    "# 4-day prediction\n",
    "predicted_price_4d = regressor_4d.predict(latest_data)[0]\n",
    "predicted_direction_4d = classifier_4d.predict(latest_data)[0]\n",
    "\n",
    "# 5-day prediction\n",
    "predicted_price_5d = regressor_5d.predict(latest_data)[0]\n",
    "predicted_direction_5d = classifier_5d.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM Forecast\")\n",
    "\n",
    "print(\"\\n--- Debugging Information ---\")\n",
    "print(f\"Latest Closing Price (from X): ${df['Close'].iloc[-1]:.2f}\")\n",
    "print(f\"Predicted Price (1-day): ${predicted_price_1d:.2f}\")\n",
    "print(f\"Predicted Direction (1-day): {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "if len(df) > 1:\n",
    "    print(f\"Next Day's Closing Price (actual from data): ${df['Close'].iloc[-2]:.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (2-day): ${predicted_price_2d:.2f}\")\n",
    "print(f\"Predicted Direction (2-day): {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "if len(df) > 2:\n",
    "    print(f\"Closing Price in 2 Days (actual from data): ${df['Close'].iloc[-3]:.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (3-day): ${predicted_price_3d:.2f}\")\n",
    "print(f\"Predicted Direction (3-day): {'Up' if predicted_direction_3d == 1 else 'Down'}\")\n",
    "if len(df) > 3:\n",
    "    print(f\"Closing Price in 3 Days (actual from data): ${df['Close'].iloc[-4]:.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (4-day): ${predicted_price_4d:.2f}\")\n",
    "print(f\"Predicted Direction (4-day): {'Up' if predicted_direction_4d == 1 else 'Down'}\")\n",
    "if len(df) > 4:\n",
    "    print(f\"Closing Price in 4 Days (actual from data): ${df['Close'].iloc[-5]:.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (5-day): ${predicted_price_5d:.2f}\")\n",
    "print(f\"Predicted Direction (5-day): {'Up' if predicted_direction_5d == 1 else 'Down'}\")\n",
    "if len(df) > 5:\n",
    "    print(f\"Closing Price in 5 Days (actual from data): ${df['Close'].iloc[-6]:.2f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "733f8a0c-546a-4c5f-9a69-1a5d3b5c6779",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM Forecast\n",
      "\n",
      "--- Debugging Information ---\n"
     ]
    },
    {
     "ename": "TypeError",
     "evalue": "unsupported format string passed to Series.__format__",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[23], line 136\u001b[0m\n\u001b[0;32m    133\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124mðŸ“Š IBM Forecast\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    135\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m--- Debugging Information ---\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m--> 136\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mLatest Closing Price (from X): $\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdf[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mClose\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39miloc[\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m]\u001b[38;5;132;01m:\u001b[39;00m\u001b[38;5;124m.2f\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    137\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mPredicted Price (1-day): $\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mpredicted_price_1d\u001b[38;5;132;01m:\u001b[39;00m\u001b[38;5;124m.2f\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    138\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mPredicted Direction (1-day): \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mUp\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mif\u001b[39;00m\u001b[38;5;250m \u001b[39mpredicted_direction_1d\u001b[38;5;250m \u001b[39m\u001b[38;5;241m==\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;241m1\u001b[39m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01melse\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDown\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n",
      "\u001b[1;31mTypeError\u001b[0m: unsupported format string passed to Series.__format__"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(-2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 3-day prediction\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['dir_3d'] = (df['next_3d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 4-day prediction\n",
    "df['next_4d_close'] = df['Close'].shift(-4)\n",
    "df['dir_4d'] = (df['next_4d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# 1-day prediction models\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_1d.fit(X, y_price_1d)\n",
    "classifier_1d.fit(X, y_dir_1d)\n",
    "\n",
    "# 2-day prediction models\n",
    "y_price_2d = df['next_2d_close']\n",
    "y_dir_2d = df['dir_2d']\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_2d.fit(X, y_price_2d)\n",
    "classifier_2d.fit(X, y_dir_2d)\n",
    "\n",
    "# 3-day prediction models\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "regressor_3d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_3d.fit(X, y_price_3d)\n",
    "classifier_3d.fit(X, y_dir_3d)\n",
    "\n",
    "# 4-day prediction models\n",
    "y_price_4d = df['next_4d_close']\n",
    "y_dir_4d = df['dir_4d']\n",
    "regressor_4d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_4d.fit(X, y_price_4d)\n",
    "classifier_4d.fit(X, y_dir_4d)\n",
    "\n",
    "# 5-day prediction models\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_5d.fit(X, y_price_5d)\n",
    "classifier_5d.fit(X, y_dir_5d)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "# 1-day prediction\n",
    "predicted_price_1d = regressor_1d.predict(latest_data)[0]\n",
    "predicted_direction_1d = classifier_1d.predict(latest_data)[0]\n",
    "\n",
    "# 2-day prediction\n",
    "predicted_price_2d = regressor_2d.predict(latest_data)[0]\n",
    "predicted_direction_2d = classifier_2d.predict(latest_data)[0]\n",
    "\n",
    "# 3-day prediction\n",
    "predicted_price_3d = regressor_3d.predict(latest_data)[0]\n",
    "predicted_direction_3d = classifier_3d.predict(latest_data)[0]\n",
    "\n",
    "# 4-day prediction\n",
    "predicted_price_4d = regressor_4d.predict(latest_data)[0]\n",
    "predicted_direction_4d = classifier_4d.predict(latest_data)[0]\n",
    "\n",
    "# 5-day prediction\n",
    "predicted_price_5d = regressor_5d.predict(latest_data)[0]\n",
    "predicted_direction_5d = classifier_5d.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM Forecast\")\n",
    "\n",
    "print(\"\\n--- Debugging Information ---\")\n",
    "print(f\"Latest Closing Price (from X): ${df['Close'].iloc[-1]:.2f}\")\n",
    "print(f\"Predicted Price (1-day): ${predicted_price_1d:.2f}\")\n",
    "print(f\"Predicted Direction (1-day): {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "if len(df) > 1:\n",
    "    print(f\"Next Day's Closing Price (actual from data): ${df['Close'].iloc[-2]:.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (2-day): ${predicted_price_2d:.2f}\")\n",
    "print(f\"Predicted Direction (2-day): {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "if len(df) > 2:\n",
    "    print(f\"Closing Price in 2 Days (actual from data): ${df['Close'].iloc[-3]:.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (3-day): ${predicted_price_3d:.2f}\")\n",
    "print(f\"Predicted Direction (3-day): {'Up' if predicted_direction_3d == 1 else 'Down'}\")\n",
    "if len(df) > 3:\n",
    "    print(f\"Closing Price in 3 Days (actual from data): ${df['Close'].iloc[-4]:.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (4-day): ${predicted_price_4d:.2f}\")\n",
    "print(f\"Predicted Direction (4-day): {'Up' if predicted_direction_4d == 1 else 'Down'}\")\n",
    "if len(df) > 4:\n",
    "    print(f\"Closing Price in 4 Days (actual from data): ${df['Close'].iloc[-5]:.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (5-day): ${predicted_price_5d:.2f}\")\n",
    "print(f\"Predicted Direction (5-day): {'Up' if predicted_direction_5d == 1 else 'Down'}\")\n",
    "if len(df) > 5:\n",
    "    print(f\"Closing Price in 5 Days (actual from data): ${df['Close'].iloc[-6]:.2f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "45def9d7-4fd2-4184-b087-642033799abd",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM Forecast\n",
      "\n",
      "--- Debugging Information ---\n",
      "Latest Closing Price (from X): $266.95\n",
      "Predicted Price (1-day): $262.41\n",
      "Predicted Direction (1-day): Down\n",
      "Next Day's Closing Price (actual from data): $268.41\n",
      "\n",
      "Predicted Price (2-day): $259.84\n",
      "Predicted Direction (2-day): Down\n",
      "Closing Price in 2 Days (actual from data): $266.76\n",
      "\n",
      "Predicted Price (3-day): $258.05\n",
      "Predicted Direction (3-day): Down\n",
      "Closing Price in 3 Days (actual from data): $266.68\n",
      "\n",
      "Predicted Price (4-day): $259.98\n",
      "Predicted Direction (4-day): Down\n",
      "Closing Price in 4 Days (actual from data): $257.82\n",
      "\n",
      "Predicted Price (5-day): $260.32\n",
      "Predicted Direction (5-day): Down\n",
      "Closing Price in 5 Days (actual from data): $258.59\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(-2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 3-day prediction\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['dir_3d'] = (df['next_3d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 4-day prediction\n",
    "df['next_4d_close'] = df['Close'].shift(-4)\n",
    "df['dir_4d'] = (df['next_4d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# 1-day prediction models\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_1d.fit(X, y_price_1d)\n",
    "classifier_1d.fit(X, y_dir_1d)\n",
    "\n",
    "# 2-day prediction models\n",
    "y_price_2d = df['next_2d_close']\n",
    "y_dir_2d = df['dir_2d']\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_2d.fit(X, y_price_2d)\n",
    "classifier_2d.fit(X, y_dir_2d)\n",
    "\n",
    "# 3-day prediction models\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "regressor_3d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_3d.fit(X, y_price_3d)\n",
    "classifier_3d.fit(X, y_dir_3d)\n",
    "\n",
    "# 4-day prediction models\n",
    "y_price_4d = df['next_4d_close']\n",
    "y_dir_4d = df['dir_4d']\n",
    "regressor_4d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_4d.fit(X, y_price_4d)\n",
    "classifier_4d.fit(X, y_dir_4d)\n",
    "\n",
    "# 5-day prediction models\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_5d.fit(X, y_price_5d)\n",
    "classifier_5d.fit(X, y_dir_5d)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "# 1-day prediction\n",
    "predicted_price_1d = regressor_1d.predict(latest_data)[0]\n",
    "predicted_direction_1d = classifier_1d.predict(latest_data)[0]\n",
    "\n",
    "# 2-day prediction\n",
    "predicted_price_2d = regressor_2d.predict(latest_data)[0]\n",
    "predicted_direction_2d = classifier_2d.predict(latest_data)[0]\n",
    "\n",
    "# 3-day prediction\n",
    "predicted_price_3d = regressor_3d.predict(latest_data)[0]\n",
    "predicted_direction_3d = classifier_3d.predict(latest_data)[0]\n",
    "\n",
    "# 4-day prediction\n",
    "predicted_price_4d = regressor_4d.predict(latest_data)[0]\n",
    "predicted_direction_4d = classifier_4d.predict(latest_data)[0]\n",
    "\n",
    "# 5-day prediction\n",
    "predicted_price_5d = regressor_5d.predict(latest_data)[0]\n",
    "predicted_direction_5d = classifier_5d.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM Forecast\")\n",
    "\n",
    "print(\"\\n--- Debugging Information ---\")\n",
    "print(f\"Latest Closing Price (from X): ${df['Close'].iloc[-1].item():.2f}\")\n",
    "print(f\"Predicted Price (1-day): ${predicted_price_1d:.2f}\")\n",
    "print(f\"Predicted Direction (1-day): {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "if len(df) > 1:\n",
    "    print(f\"Next Day's Closing Price (actual from data): ${df['Close'].iloc[-2].item():.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (2-day): ${predicted_price_2d:.2f}\")\n",
    "print(f\"Predicted Direction (2-day): {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "if len(df) > 2:\n",
    "    print(f\"Closing Price in 2 Days (actual from data): ${df['Close'].iloc[-3].item():.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (3-day): ${predicted_price_3d:.2f}\")\n",
    "print(f\"Predicted Direction (3-day): {'Up' if predicted_direction_3d == 1 else 'Down'}\")\n",
    "if len(df) > 3:\n",
    "    print(f\"Closing Price in 3 Days (actual from data): ${df['Close'].iloc[-4].item():.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (4-day): ${predicted_price_4d:.2f}\")\n",
    "print(f\"Predicted Direction (4-day): {'Up' if predicted_direction_4d == 1 else 'Down'}\")\n",
    "if len(df) > 4:\n",
    "    print(f\"Closing Price in 4 Days (actual from data): ${df['Close'].iloc[-5].item():.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (5-day): ${predicted_price_5d:.2f}\")\n",
    "print(f\"Predicted Direction (5-day): {'Up' if predicted_direction_5d == 1 else 'Down'}\")\n",
    "if len(df) > 5:\n",
    "    print(f\"Closing Price in 5 Days (actual from data): ${df['Close'].iloc[-6].item():.2f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "f0b689e1-7dd6-4143-b8f4-bec109cfa74f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th>Price</th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>rsi</th>\n",
       "      <th>stoch</th>\n",
       "      <th>macd</th>\n",
       "      <th>obv</th>\n",
       "      <th>sma_10</th>\n",
       "      <th>...</th>\n",
       "      <th>next_1d_close</th>\n",
       "      <th>dir_1d</th>\n",
       "      <th>next_2d_close</th>\n",
       "      <th>dir_2d</th>\n",
       "      <th>next_3d_close</th>\n",
       "      <th>dir_3d</th>\n",
       "      <th>next_4d_close</th>\n",
       "      <th>dir_4d</th>\n",
       "      <th>next_5d_close</th>\n",
       "      <th>dir_5d</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ticker</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>...</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2025-05-07</th>\n",
       "      <td>247.800999</td>\n",
       "      <td>252.787818</td>\n",
       "      <td>247.185102</td>\n",
       "      <td>251.695084</td>\n",
       "      <td>3399700.0</td>\n",
       "      <td>60.438764</td>\n",
       "      <td>96.336975</td>\n",
       "      <td>2.142861</td>\n",
       "      <td>340682778.0</td>\n",
       "      <td>240.001907</td>\n",
       "      <td>...</td>\n",
       "      <td>252.460007</td>\n",
       "      <td>1</td>\n",
       "      <td>249.199997</td>\n",
       "      <td>0</td>\n",
       "      <td>253.690002</td>\n",
       "      <td>1</td>\n",
       "      <td>258.589996</td>\n",
       "      <td>1</td>\n",
       "      <td>257.820007</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-08</th>\n",
       "      <td>253.314322</td>\n",
       "      <td>254.824263</td>\n",
       "      <td>251.575891</td>\n",
       "      <td>252.460007</td>\n",
       "      <td>3637000.0</td>\n",
       "      <td>60.999786</td>\n",
       "      <td>92.581078</td>\n",
       "      <td>2.270441</td>\n",
       "      <td>344319778.0</td>\n",
       "      <td>242.466507</td>\n",
       "      <td>...</td>\n",
       "      <td>249.199997</td>\n",
       "      <td>0</td>\n",
       "      <td>253.690002</td>\n",
       "      <td>1</td>\n",
       "      <td>258.589996</td>\n",
       "      <td>1</td>\n",
       "      <td>257.820007</td>\n",
       "      <td>1</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-09</th>\n",
       "      <td>252.509995</td>\n",
       "      <td>253.000000</td>\n",
       "      <td>247.639999</td>\n",
       "      <td>249.199997</td>\n",
       "      <td>2901300.0</td>\n",
       "      <td>57.272102</td>\n",
       "      <td>82.351326</td>\n",
       "      <td>2.022794</td>\n",
       "      <td>341418478.0</td>\n",
       "      <td>244.299141</td>\n",
       "      <td>...</td>\n",
       "      <td>253.690002</td>\n",
       "      <td>1</td>\n",
       "      <td>258.589996</td>\n",
       "      <td>1</td>\n",
       "      <td>257.820007</td>\n",
       "      <td>1</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>1</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-12</th>\n",
       "      <td>252.500000</td>\n",
       "      <td>253.809998</td>\n",
       "      <td>244.649994</td>\n",
       "      <td>253.690002</td>\n",
       "      <td>4609500.0</td>\n",
       "      <td>60.823123</td>\n",
       "      <td>96.440744</td>\n",
       "      <td>2.042920</td>\n",
       "      <td>346027978.0</td>\n",
       "      <td>246.208255</td>\n",
       "      <td>...</td>\n",
       "      <td>258.589996</td>\n",
       "      <td>1</td>\n",
       "      <td>257.820007</td>\n",
       "      <td>1</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>1</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-13</th>\n",
       "      <td>254.429993</td>\n",
       "      <td>259.579987</td>\n",
       "      <td>252.880005</td>\n",
       "      <td>258.589996</td>\n",
       "      <td>3521400.0</td>\n",
       "      <td>64.309159</td>\n",
       "      <td>97.296855</td>\n",
       "      <td>2.251335</td>\n",
       "      <td>349549378.0</td>\n",
       "      <td>248.286504</td>\n",
       "      <td>...</td>\n",
       "      <td>257.820007</td>\n",
       "      <td>0</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>1</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-14</th>\n",
       "      <td>257.600006</td>\n",
       "      <td>260.549988</td>\n",
       "      <td>256.220001</td>\n",
       "      <td>257.820007</td>\n",
       "      <td>3634700.0</td>\n",
       "      <td>63.355139</td>\n",
       "      <td>92.358576</td>\n",
       "      <td>2.199864</td>\n",
       "      <td>345914678.0</td>\n",
       "      <td>250.046359</td>\n",
       "      <td>...</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>1</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-15</th>\n",
       "      <td>259.010010</td>\n",
       "      <td>267.429993</td>\n",
       "      <td>258.609985</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>4856300.0</td>\n",
       "      <td>69.045520</td>\n",
       "      <td>97.967154</td>\n",
       "      <td>2.597748</td>\n",
       "      <td>350770978.0</td>\n",
       "      <td>252.906786</td>\n",
       "      <td>...</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-16</th>\n",
       "      <td>266.350006</td>\n",
       "      <td>267.980011</td>\n",
       "      <td>264.589996</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>3817900.0</td>\n",
       "      <td>69.092200</td>\n",
       "      <td>96.533016</td>\n",
       "      <td>2.690184</td>\n",
       "      <td>354588878.0</td>\n",
       "      <td>255.190108</td>\n",
       "      <td>...</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-19</th>\n",
       "      <td>265.450012</td>\n",
       "      <td>269.140015</td>\n",
       "      <td>265.079987</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>3198600.0</td>\n",
       "      <td>70.093708</td>\n",
       "      <td>97.991669</td>\n",
       "      <td>2.680386</td>\n",
       "      <td>357787478.0</td>\n",
       "      <td>257.277829</td>\n",
       "      <td>...</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>0</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "      <td>263.230011</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-20</th>\n",
       "      <td>267.399994</td>\n",
       "      <td>269.279999</td>\n",
       "      <td>265.619995</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>2437900.0</td>\n",
       "      <td>67.994232</td>\n",
       "      <td>92.918614</td>\n",
       "      <td>2.402441</td>\n",
       "      <td>355349578.0</td>\n",
       "      <td>259.225511</td>\n",
       "      <td>...</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "      <td>263.230011</td>\n",
       "      <td>0</td>\n",
       "      <td>261.234985</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows Ã— 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Price             Open        High         Low       Close     Volume  \\\n",
       "Ticker             IBM         IBM         IBM         IBM        IBM   \n",
       "Date                                                                    \n",
       "2025-05-07  247.800999  252.787818  247.185102  251.695084  3399700.0   \n",
       "2025-05-08  253.314322  254.824263  251.575891  252.460007  3637000.0   \n",
       "2025-05-09  252.509995  253.000000  247.639999  249.199997  2901300.0   \n",
       "2025-05-12  252.500000  253.809998  244.649994  253.690002  4609500.0   \n",
       "2025-05-13  254.429993  259.579987  252.880005  258.589996  3521400.0   \n",
       "2025-05-14  257.600006  260.549988  256.220001  257.820007  3634700.0   \n",
       "2025-05-15  259.010010  267.429993  258.609985  266.679993  4856300.0   \n",
       "2025-05-16  266.350006  267.980011  264.589996  266.760010  3817900.0   \n",
       "2025-05-19  265.450012  269.140015  265.079987  268.410004  3198600.0   \n",
       "2025-05-20  267.399994  269.279999  265.619995  266.950012  2437900.0   \n",
       "\n",
       "Price             rsi      stoch      macd          obv      sma_10  ...  \\\n",
       "Ticker                                                               ...   \n",
       "Date                                                                 ...   \n",
       "2025-05-07  60.438764  96.336975  2.142861  340682778.0  240.001907  ...   \n",
       "2025-05-08  60.999786  92.581078  2.270441  344319778.0  242.466507  ...   \n",
       "2025-05-09  57.272102  82.351326  2.022794  341418478.0  244.299141  ...   \n",
       "2025-05-12  60.823123  96.440744  2.042920  346027978.0  246.208255  ...   \n",
       "2025-05-13  64.309159  97.296855  2.251335  349549378.0  248.286504  ...   \n",
       "2025-05-14  63.355139  92.358576  2.199864  345914678.0  250.046359  ...   \n",
       "2025-05-15  69.045520  97.967154  2.597748  350770978.0  252.906786  ...   \n",
       "2025-05-16  69.092200  96.533016  2.690184  354588878.0  255.190108  ...   \n",
       "2025-05-19  70.093708  97.991669  2.680386  357787478.0  257.277829  ...   \n",
       "2025-05-20  67.994232  92.918614  2.402441  355349578.0  259.225511  ...   \n",
       "\n",
       "Price      next_1d_close dir_1d next_2d_close dir_2d next_3d_close dir_3d  \\\n",
       "Ticker                                                                      \n",
       "Date                                                                        \n",
       "2025-05-07    252.460007      1    249.199997      0    253.690002      1   \n",
       "2025-05-08    249.199997      0    253.690002      1    258.589996      1   \n",
       "2025-05-09    253.690002      1    258.589996      1    257.820007      1   \n",
       "2025-05-12    258.589996      1    257.820007      1    266.679993      1   \n",
       "2025-05-13    257.820007      0    266.679993      1    266.760010      1   \n",
       "2025-05-14    266.679993      1    266.760010      1    268.410004      1   \n",
       "2025-05-15    266.760010      1    268.410004      1    266.950012      1   \n",
       "2025-05-16    268.410004      1    266.950012      1    260.869995      0   \n",
       "2025-05-19    266.950012      0    260.869995      0    258.369995      0   \n",
       "2025-05-20    260.869995      0    258.369995      0    258.630005      0   \n",
       "\n",
       "Price      next_4d_close dir_4d next_5d_close dir_5d  \n",
       "Ticker                                                \n",
       "Date                                                  \n",
       "2025-05-07    258.589996      1    257.820007      1  \n",
       "2025-05-08    257.820007      1    266.679993      1  \n",
       "2025-05-09    266.679993      1    266.760010      1  \n",
       "2025-05-12    266.760010      1    268.410004      1  \n",
       "2025-05-13    268.410004      1    266.950012      1  \n",
       "2025-05-14    266.950012      1    260.869995      1  \n",
       "2025-05-15    260.869995      0    258.369995      0  \n",
       "2025-05-16    258.369995      0    258.630005      0  \n",
       "2025-05-19    258.630005      0    263.230011      0  \n",
       "2025-05-20    263.230011      0    261.234985      0  \n",
       "\n",
       "[10 rows x 24 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.tail(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "7bf5be8c-f166-4bde-a31c-ffa25c9f8e55",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th>Price</th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>rsi</th>\n",
       "      <th>stoch</th>\n",
       "      <th>macd</th>\n",
       "      <th>obv</th>\n",
       "      <th>sma_10</th>\n",
       "      <th>...</th>\n",
       "      <th>next_1d_close</th>\n",
       "      <th>dir_1d</th>\n",
       "      <th>next_2d_close</th>\n",
       "      <th>dir_2d</th>\n",
       "      <th>next_3d_close</th>\n",
       "      <th>dir_3d</th>\n",
       "      <th>next_4d_close</th>\n",
       "      <th>dir_4d</th>\n",
       "      <th>next_5d_close</th>\n",
       "      <th>dir_5d</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ticker</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>...</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2025-05-14</th>\n",
       "      <td>257.600006</td>\n",
       "      <td>260.549988</td>\n",
       "      <td>256.220001</td>\n",
       "      <td>257.820007</td>\n",
       "      <td>3634700.0</td>\n",
       "      <td>63.355139</td>\n",
       "      <td>92.358576</td>\n",
       "      <td>2.199864</td>\n",
       "      <td>345914678.0</td>\n",
       "      <td>250.046359</td>\n",
       "      <td>...</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>1</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-15</th>\n",
       "      <td>259.010010</td>\n",
       "      <td>267.429993</td>\n",
       "      <td>258.609985</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>4856300.0</td>\n",
       "      <td>69.045520</td>\n",
       "      <td>97.967154</td>\n",
       "      <td>2.597748</td>\n",
       "      <td>350770978.0</td>\n",
       "      <td>252.906786</td>\n",
       "      <td>...</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-16</th>\n",
       "      <td>266.350006</td>\n",
       "      <td>267.980011</td>\n",
       "      <td>264.589996</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>3817900.0</td>\n",
       "      <td>69.092200</td>\n",
       "      <td>96.533016</td>\n",
       "      <td>2.690184</td>\n",
       "      <td>354588878.0</td>\n",
       "      <td>255.190108</td>\n",
       "      <td>...</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-19</th>\n",
       "      <td>265.450012</td>\n",
       "      <td>269.140015</td>\n",
       "      <td>265.079987</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>3198600.0</td>\n",
       "      <td>70.093708</td>\n",
       "      <td>97.991669</td>\n",
       "      <td>2.680386</td>\n",
       "      <td>357787478.0</td>\n",
       "      <td>257.277829</td>\n",
       "      <td>...</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>0</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "      <td>263.230011</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-20</th>\n",
       "      <td>267.399994</td>\n",
       "      <td>269.279999</td>\n",
       "      <td>265.619995</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>2437900.0</td>\n",
       "      <td>67.994232</td>\n",
       "      <td>92.918614</td>\n",
       "      <td>2.402441</td>\n",
       "      <td>355349578.0</td>\n",
       "      <td>259.225511</td>\n",
       "      <td>...</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "      <td>263.230011</td>\n",
       "      <td>0</td>\n",
       "      <td>261.234985</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Price             Open        High         Low       Close     Volume  \\\n",
       "Ticker             IBM         IBM         IBM         IBM        IBM   \n",
       "Date                                                                    \n",
       "2025-05-14  257.600006  260.549988  256.220001  257.820007  3634700.0   \n",
       "2025-05-15  259.010010  267.429993  258.609985  266.679993  4856300.0   \n",
       "2025-05-16  266.350006  267.980011  264.589996  266.760010  3817900.0   \n",
       "2025-05-19  265.450012  269.140015  265.079987  268.410004  3198600.0   \n",
       "2025-05-20  267.399994  269.279999  265.619995  266.950012  2437900.0   \n",
       "\n",
       "Price             rsi      stoch      macd          obv      sma_10  ...  \\\n",
       "Ticker                                                               ...   \n",
       "Date                                                                 ...   \n",
       "2025-05-14  63.355139  92.358576  2.199864  345914678.0  250.046359  ...   \n",
       "2025-05-15  69.045520  97.967154  2.597748  350770978.0  252.906786  ...   \n",
       "2025-05-16  69.092200  96.533016  2.690184  354588878.0  255.190108  ...   \n",
       "2025-05-19  70.093708  97.991669  2.680386  357787478.0  257.277829  ...   \n",
       "2025-05-20  67.994232  92.918614  2.402441  355349578.0  259.225511  ...   \n",
       "\n",
       "Price      next_1d_close dir_1d next_2d_close dir_2d next_3d_close dir_3d  \\\n",
       "Ticker                                                                      \n",
       "Date                                                                        \n",
       "2025-05-14    266.679993      1    266.760010      1    268.410004      1   \n",
       "2025-05-15    266.760010      1    268.410004      1    266.950012      1   \n",
       "2025-05-16    268.410004      1    266.950012      1    260.869995      0   \n",
       "2025-05-19    266.950012      0    260.869995      0    258.369995      0   \n",
       "2025-05-20    260.869995      0    258.369995      0    258.630005      0   \n",
       "\n",
       "Price      next_4d_close dir_4d next_5d_close dir_5d  \n",
       "Ticker                                                \n",
       "Date                                                  \n",
       "2025-05-14    266.950012      1    260.869995      1  \n",
       "2025-05-15    260.869995      0    258.369995      0  \n",
       "2025-05-16    258.369995      0    258.630005      0  \n",
       "2025-05-19    258.630005      0    263.230011      0  \n",
       "2025-05-20    263.230011      0    261.234985      0  \n",
       "\n",
       "[5 rows x 24 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "17444a2c-b210-46f7-b2f0-f649ae1b9f2a",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM Forecast\n",
      "Prediction Date: 2025-05-20\n",
      "\n",
      "--- Debugging Information ---\n",
      "Latest Closing Price (from X): $266.95\n",
      "Predicted Price (1-day): $262.41\n",
      "Predicted Direction (1-day): Down\n",
      "Next Day's Closing Price (actual from data): $268.41\n",
      "\n",
      "Predicted Price (2-day): $259.84\n",
      "Predicted Direction (2-day): Down\n",
      "Closing Price in 2 Days (actual from data): $266.76\n",
      "\n",
      "Predicted Price (3-day): $258.05\n",
      "Predicted Direction (3-day): Down\n",
      "Closing Price in 3 Days (actual from data): $266.68\n",
      "\n",
      "Predicted Price (4-day): $260.06\n",
      "Predicted Direction (4-day): Down\n",
      "Closing Price in 4 Days (actual from data): $257.82\n",
      "\n",
      "Predicted Price (5-day): $260.28\n",
      "Predicted Direction (5-day): Down\n",
      "Closing Price in 5 Days (actual from data): $258.59\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(-1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(-2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 3-day prediction\n",
    "df['next_3d_close'] = df['Close'].shift(-3)\n",
    "df['dir_3d'] = (df['next_3d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 4-day prediction\n",
    "df['next_4d_close'] = df['Close'].shift(-4)\n",
    "df['dir_4d'] = (df['next_4d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(-5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# 1-day prediction models\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_1d.fit(X, y_price_1d)\n",
    "classifier_1d.fit(X, y_dir_1d)\n",
    "\n",
    "# 2-day prediction models\n",
    "y_price_2d = df['next_2d_close']\n",
    "y_dir_2d = df['dir_2d']\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_2d.fit(X, y_price_2d)\n",
    "classifier_2d.fit(X, y_dir_2d)\n",
    "\n",
    "# 3-day prediction models\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "regressor_3d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_3d.fit(X, y_price_3d)\n",
    "classifier_3d.fit(X, y_dir_3d)\n",
    "\n",
    "# 4-day prediction models\n",
    "y_price_4d = df['next_4d_close']\n",
    "y_dir_4d = df['dir_4d']\n",
    "regressor_4d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_4d.fit(X, y_price_4d)\n",
    "classifier_4d.fit(X, y_dir_4d)\n",
    "\n",
    "# 5-day prediction models\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_5d.fit(X, y_price_5d)\n",
    "classifier_5d.fit(X, y_dir_5d)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "# Get the last date from the downloaded data\n",
    "last_date = df.index[-1].strftime('%Y-%m-%d')\n",
    "\n",
    "# 1-day prediction\n",
    "predicted_price_1d = regressor_1d.predict(latest_data)[0]\n",
    "predicted_direction_1d = classifier_1d.predict(latest_data)[0]\n",
    "\n",
    "# 2-day prediction\n",
    "predicted_price_2d = regressor_2d.predict(latest_data)[0]\n",
    "predicted_direction_2d = classifier_2d.predict(latest_data)[0]\n",
    "\n",
    "# 3-day prediction\n",
    "predicted_price_3d = regressor_3d.predict(latest_data)[0]\n",
    "predicted_direction_3d = classifier_3d.predict(latest_data)[0]\n",
    "\n",
    "# 4-day prediction\n",
    "predicted_price_4d = regressor_4d.predict(latest_data)[0]\n",
    "predicted_direction_4d = classifier_4d.predict(latest_data)[0]\n",
    "\n",
    "# 5-day prediction\n",
    "predicted_price_5d = regressor_5d.predict(latest_data)[0]\n",
    "predicted_direction_5d = classifier_5d.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM Forecast\")\n",
    "print(f\"Prediction Date: {last_date}\")\n",
    "print(\"\\n--- Debugging Information ---\")\n",
    "print(f\"Latest Closing Price (from X): ${df['Close'].iloc[-1].item():.2f}\")\n",
    "print(f\"Predicted Price (1-day): ${predicted_price_1d:.2f}\")\n",
    "print(f\"Predicted Direction (1-day): {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "if len(df) > 1:\n",
    "    print(f\"Next Day's Closing Price (actual from data): ${df['Close'].iloc[-2].item():.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (2-day): ${predicted_price_2d:.2f}\")\n",
    "print(f\"Predicted Direction (2-day): {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "if len(df) > 2:\n",
    "    print(f\"Closing Price in 2 Days (actual from data): ${df['Close'].iloc[-3].item():.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (3-day): ${predicted_price_3d:.2f}\")\n",
    "print(f\"Predicted Direction (3-day): {'Up' if predicted_direction_3d == 1 else 'Down'}\")\n",
    "if len(df) > 3:\n",
    "    print(f\"Closing Price in 3 Days (actual from data): ${df['Close'].iloc[-4].item():.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (4-day): ${predicted_price_4d:.2f}\")\n",
    "print(f\"Predicted Direction (4-day): {'Up' if predicted_direction_4d == 1 else 'Down'}\")\n",
    "if len(df) > 4:\n",
    "    print(f\"Closing Price in 4 Days (actual from data): ${df['Close'].iloc[-5].item():.2f}\")\n",
    "\n",
    "print(f\"\\nPredicted Price (5-day): ${predicted_price_5d:.2f}\")\n",
    "print(f\"Predicted Direction (5-day): {'Up' if predicted_direction_5d == 1 else 'Down'}\")\n",
    "if len(df) > 5:\n",
    "    print(f\"Closing Price in 5 Days (actual from data): ${df['Close'].iloc[-6].item():.2f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "2d4ff8ae-8cff-483e-b131-17716a8a2bb6",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ðŸ“Š IBM Forecast\n",
      "Date of Prediction: 2025-05-28\n",
      "\n",
      "--- Predictions ---\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-29:\n",
      "ðŸ“ˆ Predicted price: $262.54\n",
      "ðŸ“‰ Predicted direction: Up\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-30:\n",
      "ðŸ“ˆ Predicted price: $259.24\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-31:\n",
      "ðŸ“ˆ Predicted price: $259.23\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-06-01:\n",
      "ðŸ“ˆ Predicted price: $262.46\n",
      "ðŸ“‰ Predicted direction: Up\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-06-02:\n",
      "ðŸ“ˆ Predicted price: $266.57\n",
      "ðŸ“‰ Predicted direction: Up\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"IBM\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 3-day prediction\n",
    "df['next_3d_close'] = df['Close'].shift(3)\n",
    "df['dir_3d'] = (df['next_3d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 4-day prediction\n",
    "df['next_4d_close'] = df['Close'].shift(4)\n",
    "df['dir_4d'] = (df['next_4d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Train model\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "# 1-day prediction models\n",
    "y_price_1d = df['next_1d_close']\n",
    "y_dir_1d = df['dir_1d']\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_1d.fit(X, y_price_1d)\n",
    "classifier_1d.fit(X, y_dir_1d)\n",
    "\n",
    "# 2-day prediction models\n",
    "y_price_2d = df['next_2d_close']\n",
    "y_dir_2d = df['dir_2d']\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_2d.fit(X, y_price_2d)\n",
    "classifier_2d.fit(X, y_dir_2d)\n",
    "\n",
    "# 3-day prediction models\n",
    "y_price_3d = df['next_3d_close']\n",
    "y_dir_3d = df['dir_3d']\n",
    "regressor_3d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_3d.fit(X, y_price_3d)\n",
    "classifier_3d.fit(X, y_dir_3d)\n",
    "\n",
    "# 4-day prediction models\n",
    "y_price_4d = df['next_4d_close']\n",
    "y_dir_4d = df['dir_4d']\n",
    "regressor_4d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_4d.fit(X, y_price_4d)\n",
    "classifier_4d.fit(X, y_dir_4d)\n",
    "\n",
    "# 5-day prediction models\n",
    "y_price_5d = df['next_5d_close']\n",
    "y_dir_5d = df['dir_5d']\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=42)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "regressor_5d.fit(X, y_price_5d)\n",
    "classifier_5d.fit(X, y_dir_5d)\n",
    "\n",
    "# Step 6: Predict\n",
    "latest_data = X.iloc[-1:]\n",
    "\n",
    "# Get the last date from the downloaded data\n",
    "last_date = df.index[-1]\n",
    "\n",
    "# Calculate prediction dates\n",
    "prediction_date_1d = (last_date + pd.Timedelta(days=1)).strftime('%Y-%m-%d')\n",
    "prediction_date_2d = (last_date + pd.Timedelta(days=2)).strftime('%Y-%m-%d')\n",
    "prediction_date_3d = (last_date + pd.Timedelta(days=3)).strftime('%Y-%m-%d')\n",
    "prediction_date_4d = (last_date + pd.Timedelta(days=4)).strftime('%Y-%m-%d')\n",
    "prediction_date_5d = (last_date + pd.Timedelta(days=5)).strftime('%Y-%m-%d')\n",
    "prediction_date_prediction = last_date.strftime('%Y-%m-%d')\n",
    "\n",
    "\n",
    "# 1-day prediction\n",
    "predicted_price_1d = regressor_1d.predict(latest_data)[0]\n",
    "predicted_direction_1d = classifier_1d.predict(latest_data)[0]\n",
    "\n",
    "# 2-day prediction\n",
    "predicted_price_2d = regressor_2d.predict(latest_data)[0]\n",
    "predicted_direction_2d = classifier_2d.predict(latest_data)[0]\n",
    "\n",
    "# 3-day prediction\n",
    "predicted_price_3d = regressor_3d.predict(latest_data)[0]\n",
    "predicted_direction_3d = classifier_3d.predict(latest_data)[0]\n",
    "\n",
    "# 4-day prediction\n",
    "predicted_price_4d = regressor_4d.predict(latest_data)[0]\n",
    "predicted_direction_4d = classifier_4d.predict(latest_data)[0]\n",
    "\n",
    "# 5-day prediction\n",
    "predicted_price_5d = regressor_5d.predict(latest_data)[0]\n",
    "predicted_direction_5d = classifier_5d.predict(latest_data)[0]\n",
    "\n",
    "# Step 7: Results\n",
    "print(\"\\nðŸ“Š IBM Forecast\")\n",
    "print(f\"Date of Prediction: {prediction_date_prediction}\")\n",
    "print(\"\\n--- Predictions ---\")\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_1d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_1d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_2d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_2d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_3d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_3d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_3d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_4d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_4d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_4d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_5d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_5d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_5d == 1 else 'Down'}\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "face9117-49b1-4ff4-9b0f-7f924b5722c5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th>Price</th>\n",
       "      <th>Open</th>\n",
       "      <th>High</th>\n",
       "      <th>Low</th>\n",
       "      <th>Close</th>\n",
       "      <th>Volume</th>\n",
       "      <th>rsi</th>\n",
       "      <th>stoch</th>\n",
       "      <th>macd</th>\n",
       "      <th>obv</th>\n",
       "      <th>sma_10</th>\n",
       "      <th>...</th>\n",
       "      <th>next_1d_close</th>\n",
       "      <th>dir_1d</th>\n",
       "      <th>next_2d_close</th>\n",
       "      <th>dir_2d</th>\n",
       "      <th>next_3d_close</th>\n",
       "      <th>dir_3d</th>\n",
       "      <th>next_4d_close</th>\n",
       "      <th>dir_4d</th>\n",
       "      <th>next_5d_close</th>\n",
       "      <th>dir_5d</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ticker</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th>IBM</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>...</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Date</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2025-05-14</th>\n",
       "      <td>257.600006</td>\n",
       "      <td>260.549988</td>\n",
       "      <td>256.220001</td>\n",
       "      <td>257.820007</td>\n",
       "      <td>3634700.0</td>\n",
       "      <td>63.355139</td>\n",
       "      <td>92.358576</td>\n",
       "      <td>2.199864</td>\n",
       "      <td>345914678.0</td>\n",
       "      <td>250.046359</td>\n",
       "      <td>...</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>1</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-15</th>\n",
       "      <td>259.010010</td>\n",
       "      <td>267.429993</td>\n",
       "      <td>258.609985</td>\n",
       "      <td>266.679993</td>\n",
       "      <td>4856300.0</td>\n",
       "      <td>69.045520</td>\n",
       "      <td>97.967154</td>\n",
       "      <td>2.597748</td>\n",
       "      <td>350770978.0</td>\n",
       "      <td>252.906786</td>\n",
       "      <td>...</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>1</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-16</th>\n",
       "      <td>266.350006</td>\n",
       "      <td>267.980011</td>\n",
       "      <td>264.589996</td>\n",
       "      <td>266.760010</td>\n",
       "      <td>3817900.0</td>\n",
       "      <td>69.092200</td>\n",
       "      <td>96.533016</td>\n",
       "      <td>2.690184</td>\n",
       "      <td>354588878.0</td>\n",
       "      <td>255.190108</td>\n",
       "      <td>...</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>1</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>1</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-19</th>\n",
       "      <td>265.450012</td>\n",
       "      <td>269.140015</td>\n",
       "      <td>265.079987</td>\n",
       "      <td>268.410004</td>\n",
       "      <td>3198600.0</td>\n",
       "      <td>70.093708</td>\n",
       "      <td>97.991669</td>\n",
       "      <td>2.680386</td>\n",
       "      <td>357787478.0</td>\n",
       "      <td>257.277829</td>\n",
       "      <td>...</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>0</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "      <td>263.230011</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025-05-20</th>\n",
       "      <td>267.399994</td>\n",
       "      <td>269.279999</td>\n",
       "      <td>265.619995</td>\n",
       "      <td>266.950012</td>\n",
       "      <td>2437900.0</td>\n",
       "      <td>67.994232</td>\n",
       "      <td>92.918614</td>\n",
       "      <td>2.402441</td>\n",
       "      <td>355349578.0</td>\n",
       "      <td>259.225511</td>\n",
       "      <td>...</td>\n",
       "      <td>260.869995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.369995</td>\n",
       "      <td>0</td>\n",
       "      <td>258.630005</td>\n",
       "      <td>0</td>\n",
       "      <td>263.230011</td>\n",
       "      <td>0</td>\n",
       "      <td>261.309998</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Price             Open        High         Low       Close     Volume  \\\n",
       "Ticker             IBM         IBM         IBM         IBM        IBM   \n",
       "Date                                                                    \n",
       "2025-05-14  257.600006  260.549988  256.220001  257.820007  3634700.0   \n",
       "2025-05-15  259.010010  267.429993  258.609985  266.679993  4856300.0   \n",
       "2025-05-16  266.350006  267.980011  264.589996  266.760010  3817900.0   \n",
       "2025-05-19  265.450012  269.140015  265.079987  268.410004  3198600.0   \n",
       "2025-05-20  267.399994  269.279999  265.619995  266.950012  2437900.0   \n",
       "\n",
       "Price             rsi      stoch      macd          obv      sma_10  ...  \\\n",
       "Ticker                                                               ...   \n",
       "Date                                                                 ...   \n",
       "2025-05-14  63.355139  92.358576  2.199864  345914678.0  250.046359  ...   \n",
       "2025-05-15  69.045520  97.967154  2.597748  350770978.0  252.906786  ...   \n",
       "2025-05-16  69.092200  96.533016  2.690184  354588878.0  255.190108  ...   \n",
       "2025-05-19  70.093708  97.991669  2.680386  357787478.0  257.277829  ...   \n",
       "2025-05-20  67.994232  92.918614  2.402441  355349578.0  259.225511  ...   \n",
       "\n",
       "Price      next_1d_close dir_1d next_2d_close dir_2d next_3d_close dir_3d  \\\n",
       "Ticker                                                                      \n",
       "Date                                                                        \n",
       "2025-05-14    266.679993      1    266.760010      1    268.410004      1   \n",
       "2025-05-15    266.760010      1    268.410004      1    266.950012      1   \n",
       "2025-05-16    268.410004      1    266.950012      1    260.869995      0   \n",
       "2025-05-19    266.950012      0    260.869995      0    258.369995      0   \n",
       "2025-05-20    260.869995      0    258.369995      0    258.630005      0   \n",
       "\n",
       "Price      next_4d_close dir_4d next_5d_close dir_5d  \n",
       "Ticker                                                \n",
       "Date                                                  \n",
       "2025-05-14    266.950012      1    260.869995      1  \n",
       "2025-05-15    260.869995      0    258.369995      0  \n",
       "2025-05-16    258.369995      0    258.630005      0  \n",
       "2025-05-19    258.630005      0    263.230011      0  \n",
       "2025-05-20    263.230011      0    261.309998      0  \n",
       "\n",
       "[5 rows x 24 columns]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.tail()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "dd7a247b-96e1-40ff-9d19-570e964dcf99",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "--- Direction Prediction Accuracy on Test Set ---\n",
      "Accuracy for 1-day direction prediction: 67.49%\n",
      "Accuracy for 2-day direction prediction: 68.03%\n",
      "Accuracy for 3-day direction prediction: 71.31%\n",
      "Accuracy for 4-day direction prediction: 78.14%\n",
      "Accuracy for 5-day direction prediction: 56.83%\n",
      "\n",
      "ðŸ“Š PANW Forecast\n",
      "Date of Prediction: 2025-05-28\n",
      "\n",
      "--- Predictions ---\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-29:\n",
      "ðŸ“ˆ Predicted price: $187.50\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-30:\n",
      "ðŸ“ˆ Predicted price: $186.79\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-31:\n",
      "ðŸ“ˆ Predicted price: $186.16\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-06-01:\n",
      "ðŸ“ˆ Predicted price: $182.65\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-06-02:\n",
      "ðŸ“ˆ Predicted price: $192.79\n",
      "ðŸ“‰ Predicted direction: Up\n",
      "\n",
      "--- Debugging Information ---\n",
      "Latest Closing Price (from X): $187.80\n",
      "Next Day's Closing Price (actual from data): $187.46\n",
      "Closing Price in 2 Days (actual from data): $186.75\n",
      "Closing Price in 3 Days (actual from data): $186.14\n",
      "Closing Price in 4 Days (actual from data): $181.26\n",
      "Closing Price in 5 Days (actual from data): $194.48\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import accuracy_score\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(\"PANW\", start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 3-day prediction\n",
    "df['next_3d_close'] = df['Close'].shift(3)\n",
    "df['dir_3d'] = (df['next_3d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 4-day prediction\n",
    "df['next_4d_close'] = df['Close'].shift(4)\n",
    "df['dir_4d'] = (df['next_4d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features and target variables\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_dir_2d = df['dir_2d']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_dir_4d = df['dir_4d']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 6: Split data into training and testing sets\n",
    "test_size = 0.2  # 20% for testing\n",
    "random_state = 42 # for reproducibility\n",
    "\n",
    "X_train, X_test, y_train_1d, y_test_1d = train_test_split(X, y_dir_1d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "X_train, X_test, y_train_2d, y_test_2d = train_test_split(X, y_dir_2d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "X_train, X_test, y_train_3d, y_test_3d = train_test_split(X, y_dir_3d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "X_train, X_test, y_train_4d, y_test_4d = train_test_split(X, y_dir_4d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "X_train, X_test, y_train_5d, y_test_5d = train_test_split(X, y_dir_5d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "\n",
    "# Step 7: Train direction classification models and evaluate accuracy\n",
    "print(\"\\n--- Direction Prediction Accuracy on Test Set ---\")\n",
    "\n",
    "# 1-day prediction\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_1d.fit(X_train, y_train_1d)\n",
    "y_pred_1d = classifier_1d.predict(X_test)\n",
    "accuracy_1d = accuracy_score(y_test_1d, y_pred_1d)\n",
    "print(f\"Accuracy for 1-day direction prediction: {accuracy_1d * 100:.2f}%\")\n",
    "\n",
    "# 2-day prediction\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_2d.fit(X_train, y_train_2d)\n",
    "y_pred_2d = classifier_2d.predict(X_test)\n",
    "accuracy_2d = accuracy_score(y_test_2d, y_pred_2d)\n",
    "print(f\"Accuracy for 2-day direction prediction: {accuracy_2d * 100:.2f}%\")\n",
    "\n",
    "# 3-day prediction\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_3d.fit(X_train, y_train_3d)\n",
    "y_pred_3d = classifier_3d.predict(X_test)\n",
    "accuracy_3d = accuracy_score(y_test_3d, y_pred_3d)\n",
    "print(f\"Accuracy for 3-day direction prediction: {accuracy_3d * 100:.2f}%\")\n",
    "\n",
    "# 4-day prediction\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_4d.fit(X_train, y_train_4d)\n",
    "y_pred_4d = classifier_4d.predict(X_test)\n",
    "accuracy_4d = accuracy_score(y_test_4d, y_pred_4d)\n",
    "print(f\"Accuracy for 4-day direction prediction: {accuracy_4d * 100:.2f}%\")\n",
    "\n",
    "# 5-day prediction\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_5d.fit(X_train, y_train_5d)\n",
    "y_pred_5d = classifier_5d.predict(X_test)\n",
    "accuracy_5d = accuracy_score(y_test_5d, y_pred_5d)\n",
    "print(f\"Accuracy for 5-day direction prediction: {accuracy_5d * 100:.2f}%\")\n",
    "\n",
    "# Step 8: Train final models on the entire dataset and predict\n",
    "# Get the last date from the downloaded data\n",
    "last_date = df.index[-1]\n",
    "\n",
    "# Calculate prediction dates\n",
    "prediction_date_1d = (last_date + pd.Timedelta(days=1)).strftime('%Y-%m-%d')\n",
    "prediction_date_2d = (last_date + pd.Timedelta(days=2)).strftime('%Y-%m-%d')\n",
    "prediction_date_3d = (last_date + pd.Timedelta(days=3)).strftime('%Y-%m-%d')\n",
    "prediction_date_4d = (last_date + pd.Timedelta(days=4)).strftime('%Y-%m-%d')\n",
    "prediction_date_5d = (last_date + pd.Timedelta(days=5)).strftime('%Y-%m-%d')\n",
    "prediction_date_prediction = last_date.strftime('%Y-%m-%d')\n",
    "\n",
    "X_train_full = X\n",
    "y_train_full_1d = y_dir_1d\n",
    "y_train_full_2d = y_dir_2d\n",
    "y_train_full_3d = y_dir_3d\n",
    "y_train_full_4d = y_dir_4d\n",
    "y_train_full_5d = y_dir_5d\n",
    "\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_1d.fit(X_train_full, df['next_1d_close'])\n",
    "classifier_1d.fit(X_train_full, y_train_full_1d)\n",
    "predicted_price_1d = regressor_1d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_1d = classifier_1d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_2d.fit(X_train_full, df['next_2d_close'])\n",
    "classifier_2d.fit(X_train_full, y_train_full_2d)\n",
    "predicted_price_2d = regressor_2d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_2d = classifier_2d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "regressor_3d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_3d.fit(X_train_full, df['next_3d_close'])\n",
    "classifier_3d.fit(X_train_full, y_train_full_3d)\n",
    "predicted_price_3d = regressor_3d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_3d = classifier_3d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "regressor_4d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_4d.fit(X_train_full, df['next_4d_close'])\n",
    "classifier_4d.fit(X_train_full, y_train_full_4d)\n",
    "predicted_price_4d = regressor_4d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_4d = classifier_4d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_5d.fit(X_train_full, df['next_5d_close'])\n",
    "classifier_5d.fit(X_train_full, y_train_full_5d)\n",
    "predicted_price_5d = regressor_5d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_5d = classifier_5d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "# Step 9: Results\n",
    "print(\"\\nðŸ“Š PANW Forecast\")\n",
    "print(f\"Date of Prediction: {prediction_date_prediction}\")\n",
    "print(\"\\n--- Predictions ---\")\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_1d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_1d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_2d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_2d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_3d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_3d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_3d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_4d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_4d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_4d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_5d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_5d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_5d == 1 else 'Down'}\")\n",
    "\n",
    "print(\"\\n--- Debugging Information ---\")\n",
    "print(f\"Latest Closing Price (from X): ${df['Close'].iloc[-1].item():.2f}\")\n",
    "if len(df) > 1:\n",
    "    print(f\"Next Day's Closing Price (actual from data): ${df['Close'].iloc[-2].item():.2f}\")\n",
    "if len(df) > 2:\n",
    "    print(f\"Closing Price in 2 Days (actual from data): ${df['Close'].iloc[-3].item():.2f}\")\n",
    "if len(df) > 3:\n",
    "    print(f\"Closing Price in 3 Days (actual from data): ${df['Close'].iloc[-4].item():.2f}\")\n",
    "if len(df) > 4:\n",
    "    print(f\"Closing Price in 4 Days (actual from data): ${df['Close'].iloc[-5].item():.2f}\")\n",
    "if len(df) > 5:\n",
    "    print(f\"Closing Price in 5 Days (actual from data): ${df['Close'].iloc[-6].item():.2f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "1a972957-ead6-494a-9ba7-a134ec58d66f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdin",
     "output_type": "stream",
     "text": [
      "Enter the stock symbol (e.g., AAPL, MSFT, GOOG):  OM\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[*********************100%***********************]  1 of 1 completed\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "--- Direction Prediction Accuracy on Test Set ---\n",
      "Accuracy for 1-day direction prediction: 57.39%\n",
      "Accuracy for 2-day direction prediction: 64.78%\n",
      "Accuracy for 3-day direction prediction: 68.70%\n",
      "Accuracy for 4-day direction prediction: 76.52%\n",
      "Accuracy for 5-day direction prediction: 80.00%\n",
      "\n",
      "ðŸ“Š Stock Forecast\n",
      "Stock Symbol: OM\n",
      "Date of Prediction: 2025-05-28\n",
      "\n",
      "--- Predictions ---\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-29:\n",
      "ðŸ“ˆ Predicted price: $18.66\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-30:\n",
      "ðŸ“ˆ Predicted price: $18.17\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-05-31:\n",
      "ðŸ“ˆ Predicted price: $18.54\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-06-01:\n",
      "ðŸ“ˆ Predicted price: $18.67\n",
      "ðŸ“‰ Predicted direction: Down\n",
      "\n",
      "ðŸ—“ï¸ Prediction for 2025-06-02:\n",
      "ðŸ“ˆ Predicted price: $19.24\n",
      "ðŸ“‰ Predicted direction: Up\n",
      "\n",
      "--- Debugging Information ---\n",
      "Latest Closing Price (from X): $19.50\n",
      "Next Day's Closing Price (actual from data): $18.79\n",
      "Closing Price in 2 Days (actual from data): $17.95\n",
      "Closing Price in 3 Days (actual from data): $18.47\n",
      "Closing Price in 4 Days (actual from data): $18.60\n",
      "Closing Price in 5 Days (actual from data): $19.51\n"
     ]
    }
   ],
   "source": [
    "import yfinance as yf\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from ta.momentum import RSIIndicator, StochasticOscillator\n",
    "from ta.trend import MACD, SMAIndicator, EMAIndicator\n",
    "from ta.volume import OnBalanceVolumeIndicator\n",
    "from ta.volatility import BollingerBands\n",
    "from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import accuracy_score\n",
    "\n",
    "# Get stock symbol from the user\n",
    "stock_symbol = input(\"Enter the stock symbol (e.g., AAPL, MSFT, GOOG): \").upper()\n",
    "\n",
    "# Step 1: Download data\n",
    "df = yf.download(stock_symbol, start=\"2018-01-01\")\n",
    "\n",
    "# Step 2: Clean and flatten\n",
    "df = df[['Open', 'High', 'Low', 'Close', 'Volume']].copy()\n",
    "\n",
    "# Force flatten all columns to Series\n",
    "for col in df.columns:\n",
    "    df[col] = df[col].astype(float).squeeze()\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 3: Add indicators â€” use .values.ravel() or .squeeze() to ensure 1D inputs\n",
    "df['rsi'] = RSIIndicator(close=df['Close'].squeeze()).rsi()\n",
    "df['stoch'] = StochasticOscillator(\n",
    "    high=df['High'].squeeze(),\n",
    "    low=df['Low'].squeeze(),\n",
    "    close=df['Close'].squeeze()\n",
    ").stoch()\n",
    "df['macd'] = MACD(close=df['Close'].squeeze()).macd_diff()\n",
    "df['obv'] = OnBalanceVolumeIndicator(\n",
    "    close=df['Close'].squeeze(),\n",
    "    volume=df['Volume'].squeeze()\n",
    ").on_balance_volume()\n",
    "df['sma_10'] = SMAIndicator(close=df['Close'].squeeze(), window=10).sma_indicator()\n",
    "df['ema_20'] = EMAIndicator(close=df['Close'].squeeze(), window=20).ema_indicator()\n",
    "\n",
    "bb = BollingerBands(close=df['Close'].squeeze(), window=20, window_dev=2)\n",
    "df['bb_bbm'] = bb.bollinger_mavg()\n",
    "df['bb_bbh'] = bb.bollinger_hband()\n",
    "df['bb_bbl'] = bb.bollinger_lband()\n",
    "\n",
    "# Step 4: Target for prediction\n",
    "# 1-day prediction\n",
    "df['next_1d_close'] = df['Close'].shift(1)\n",
    "df['dir_1d'] = (df['next_1d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 2-day prediction\n",
    "df['next_2d_close'] = df['Close'].shift(2)\n",
    "df['dir_2d'] = (df['next_2d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 3-day prediction\n",
    "df['next_3d_close'] = df['Close'].shift(3)\n",
    "df['dir_3d'] = (df['next_3d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 4-day prediction\n",
    "df['next_4d_close'] = df['Close'].shift(4)\n",
    "df['dir_4d'] = (df['next_4d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "# 5-day prediction\n",
    "df['next_5d_close'] = df['Close'].shift(5)\n",
    "df['dir_5d'] = (df['next_5d_close'].squeeze() > df['Close'].squeeze()).astype(int)\n",
    "\n",
    "df.dropna(inplace=True)\n",
    "\n",
    "# Step 5: Prepare features and target variables\n",
    "features = ['rsi', 'stoch', 'macd', 'obv', 'sma_10', 'ema_20', 'bb_bbm', 'bb_bbh', 'bb_bbl']\n",
    "X = df[features]\n",
    "\n",
    "y_dir_1d = df['dir_1d']\n",
    "y_dir_2d = df['dir_2d']\n",
    "y_dir_3d = df['dir_3d']\n",
    "y_dir_4d = df['dir_4d']\n",
    "y_dir_5d = df['dir_5d']\n",
    "\n",
    "# Step 6: Split data into training and testing sets\n",
    "test_size = 0.2  # 20% for testing\n",
    "random_state = 42 # for reproducibility\n",
    "\n",
    "X_train, X_test, y_train_1d, y_test_1d = train_test_split(X, y_dir_1d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "X_train, X_test, y_train_2d, y_test_2d = train_test_split(X, y_dir_2d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "X_train, X_test, y_train_3d, y_test_3d = train_test_split(X, y_dir_3d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "X_train, X_test, y_train_4d, y_test_4d = train_test_split(X, y_dir_4d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "X_train, X_test, y_train_5d, y_test_5d = train_test_split(X, y_dir_5d, test_size=test_size, random_state=random_state, shuffle=False)\n",
    "\n",
    "# Step 7: Train direction classification models and evaluate accuracy\n",
    "print(\"\\n--- Direction Prediction Accuracy on Test Set ---\")\n",
    "\n",
    "# 1-day prediction\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_1d.fit(X_train, y_train_1d)\n",
    "y_pred_1d = classifier_1d.predict(X_test)\n",
    "accuracy_1d = accuracy_score(y_test_1d, y_pred_1d)\n",
    "print(f\"Accuracy for 1-day direction prediction: {accuracy_1d * 100:.2f}%\")\n",
    "\n",
    "# 2-day prediction\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_2d.fit(X_train, y_train_2d)\n",
    "y_pred_2d = classifier_2d.predict(X_test)\n",
    "accuracy_2d = accuracy_score(y_test_2d, y_pred_2d)\n",
    "print(f\"Accuracy for 2-day direction prediction: {accuracy_2d * 100:.2f}%\")\n",
    "\n",
    "# 3-day prediction\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_3d.fit(X_train, y_train_3d)\n",
    "y_pred_3d = classifier_3d.predict(X_test)\n",
    "accuracy_3d = accuracy_score(y_test_3d, y_pred_3d)\n",
    "print(f\"Accuracy for 3-day direction prediction: {accuracy_3d * 100:.2f}%\")\n",
    "\n",
    "# 4-day prediction\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_4d.fit(X_train, y_train_4d)\n",
    "y_pred_4d = classifier_4d.predict(X_test)\n",
    "accuracy_4d = accuracy_score(y_test_4d, y_pred_4d)\n",
    "print(f\"Accuracy for 4-day direction prediction: {accuracy_4d * 100:.2f}%\")\n",
    "\n",
    "# 5-day prediction\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "classifier_5d.fit(X_train, y_train_5d)\n",
    "y_pred_5d = classifier_5d.predict(X_test)\n",
    "accuracy_5d = accuracy_score(y_test_5d, y_pred_5d)\n",
    "print(f\"Accuracy for 5-day direction prediction: {accuracy_5d * 100:.2f}%\")\n",
    "\n",
    "# Step 8: Train final models on the entire dataset and predict\n",
    "# Get the last date from the downloaded data\n",
    "last_date = df.index[-1]\n",
    "\n",
    "# Calculate prediction dates\n",
    "prediction_date_1d = (last_date + pd.Timedelta(days=1)).strftime('%Y-%m-%d')\n",
    "prediction_date_2d = (last_date + pd.Timedelta(days=2)).strftime('%Y-%m-%d')\n",
    "prediction_date_3d = (last_date + pd.Timedelta(days=3)).strftime('%Y-%m-%d')\n",
    "prediction_date_4d = (last_date + pd.Timedelta(days=4)).strftime('%Y-%m-%d')\n",
    "prediction_date_5d = (last_date + pd.Timedelta(days=5)).strftime('%Y-%m-%d')\n",
    "prediction_date_prediction = last_date.strftime('%Y-%m-%d')\n",
    "\n",
    "X_train_full = X\n",
    "y_train_full_1d = y_dir_1d\n",
    "y_train_full_2d = y_dir_2d\n",
    "y_train_full_3d = y_dir_3d\n",
    "y_train_full_4d = y_dir_4d\n",
    "y_train_full_5d = y_dir_5d\n",
    "\n",
    "regressor_1d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_1d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_1d.fit(X_train_full, df['next_1d_close'])\n",
    "classifier_1d.fit(X_train_full, y_train_full_1d)\n",
    "predicted_price_1d = regressor_1d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_1d = classifier_1d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "regressor_2d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_2d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_2d.fit(X_train_full, df['next_2d_close'])\n",
    "classifier_2d.fit(X_train_full, y_train_full_2d)\n",
    "predicted_price_2d = regressor_2d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_2d = classifier_2d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "regressor_3d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_3d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_3d.fit(X_train_full, df['next_3d_close'])\n",
    "classifier_3d.fit(X_train_full, y_train_full_3d)\n",
    "predicted_price_3d = regressor_3d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_3d = classifier_3d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "regressor_4d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_4d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_4d.fit(X_train_full, df['next_4d_close'])\n",
    "classifier_4d.fit(X_train_full, y_train_full_4d)\n",
    "predicted_price_4d = regressor_4d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_4d = classifier_4d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "regressor_5d = RandomForestRegressor(n_estimators=100, random_state=random_state)\n",
    "classifier_5d = RandomForestClassifier(n_estimators=100, random_state=random_state)\n",
    "regressor_5d.fit(X_train_full, df['next_5d_close'])\n",
    "classifier_5d.fit(X_train_full, y_train_full_5d)\n",
    "predicted_price_5d = regressor_5d.predict(X.iloc[[-1]])[0]\n",
    "predicted_direction_5d = classifier_5d.predict(X.iloc[[-1]])[0]\n",
    "\n",
    "# Step 9: Results\n",
    "print(\"\\nðŸ“Š Stock Forecast\")\n",
    "print(f\"Stock Symbol: {stock_symbol}\")\n",
    "print(f\"Date of Prediction: {prediction_date_prediction}\")\n",
    "print(\"\\n--- Predictions ---\")\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_1d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_1d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_1d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_2d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_2d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_2d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_3d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_3d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_3d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_4d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_4d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_4d == 1 else 'Down'}\")\n",
    "\n",
    "print(f\"\\nðŸ—“ï¸ Prediction for {prediction_date_5d}:\")\n",
    "print(f\"ðŸ“ˆ Predicted price: ${predicted_price_5d:.2f}\")\n",
    "print(f\"ðŸ“‰ Predicted direction: {'Up' if predicted_direction_5d == 1 else 'Down'}\")\n",
    "\n",
    "print(\"\\n--- Debugging Information ---\")\n",
    "print(f\"Latest Closing Price (from X): ${df['Close'].iloc[-1].item():.2f}\")\n",
    "if len(df) > 1:\n",
    "    print(f\"Next Day's Closing Price (actual from data): ${df['Close'].iloc[-2].item():.2f}\")\n",
    "if len(df) > 2:\n",
    "    print(f\"Closing Price in 2 Days (actual from data): ${df['Close'].iloc[-3].item():.2f}\")\n",
    "if len(df) > 3:\n",
    "    print(f\"Closing Price in 3 Days (actual from data): ${df['Close'].iloc[-4].item():.2f}\")\n",
    "if len(df) > 4:\n",
    "    print(f\"Closing Price in 4 Days (actual from data): ${df['Close'].iloc[-5].item():.2f}\")\n",
    "if len(df) > 5:\n",
    "    print(f\"Closing Price in 5 Days (actual from data): ${df['Close'].iloc[-6].item():.2f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "7dfa82bb-a7b2-4c9b-a4d7-ff6095aa023c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting streamlit\n",
      "  Downloading streamlit-1.45.1-py3-none-any.whl.metadata (8.9 kB)\n",
      "Collecting altair<6,>=4.0 (from streamlit)\n",
      "  Downloading altair-5.5.0-py3-none-any.whl.metadata (11 kB)\n",
      "Collecting blinker<2,>=1.5.0 (from streamlit)\n",
      "  Downloading blinker-1.9.0-py3-none-any.whl.metadata (1.6 kB)\n",
      "Collecting cachetools<6,>=4.0 (from streamlit)\n",
      "  Downloading cachetools-5.5.2-py3-none-any.whl.metadata (5.4 kB)\n",
      "Collecting click<9,>=7.0 (from streamlit)\n",
      "  Downloading click-8.2.1-py3-none-any.whl.metadata (2.5 kB)\n",
      "Requirement already satisfied: numpy<3,>=1.23 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from streamlit) (2.2.2)\n",
      "Requirement already satisfied: packaging<25,>=20 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from streamlit) (24.2)\n",
      "Requirement already satisfied: pandas<3,>=1.4.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from streamlit) (2.2.3)\n",
      "Requirement already satisfied: pillow<12,>=7.1.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from streamlit) (11.1.0)\n",
      "Requirement already satisfied: protobuf<7,>=3.20 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from streamlit) (6.31.0)\n",
      "Collecting pyarrow>=7.0 (from streamlit)\n",
      "  Downloading pyarrow-20.0.0-cp313-cp313-win_amd64.whl.metadata (3.4 kB)\n",
      "Requirement already satisfied: requests<3,>=2.27 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from streamlit) (2.32.3)\n",
      "Collecting tenacity<10,>=8.1.0 (from streamlit)\n",
      "  Downloading tenacity-9.1.2-py3-none-any.whl.metadata (1.2 kB)\n",
      "Collecting toml<2,>=0.10.1 (from streamlit)\n",
      "  Downloading toml-0.10.2-py2.py3-none-any.whl.metadata (7.1 kB)\n",
      "Requirement already satisfied: typing-extensions<5,>=4.4.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from streamlit) (4.12.2)\n",
      "Collecting watchdog<7,>=2.1.5 (from streamlit)\n",
      "  Downloading watchdog-6.0.0-py3-none-win_amd64.whl.metadata (44 kB)\n",
      "Collecting gitpython!=3.1.19,<4,>=3.0.7 (from streamlit)\n",
      "  Downloading GitPython-3.1.44-py3-none-any.whl.metadata (13 kB)\n",
      "Collecting pydeck<1,>=0.8.0b4 (from streamlit)\n",
      "  Downloading pydeck-0.9.1-py2.py3-none-any.whl.metadata (4.1 kB)\n",
      "Requirement already satisfied: tornado<7,>=6.0.3 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from streamlit) (6.4.2)\n",
      "Requirement already satisfied: jinja2 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from altair<6,>=4.0->streamlit) (3.1.6)\n",
      "Requirement already satisfied: jsonschema>=3.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from altair<6,>=4.0->streamlit) (4.23.0)\n",
      "Requirement already satisfied: narwhals>=1.14.2 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from altair<6,>=4.0->streamlit) (1.35.0)\n",
      "Requirement already satisfied: colorama in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from click<9,>=7.0->streamlit) (0.4.6)\n",
      "Collecting gitdb<5,>=4.0.1 (from gitpython!=3.1.19,<4,>=3.0.7->streamlit)\n",
      "  Downloading gitdb-4.0.12-py3-none-any.whl.metadata (1.2 kB)\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from pandas<3,>=1.4.0->streamlit) (2.9.0.post0)\n",
      "Requirement already satisfied: pytz>=2020.1 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from pandas<3,>=1.4.0->streamlit) (2024.1)\n",
      "Requirement already satisfied: tzdata>=2022.7 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from pandas<3,>=1.4.0->streamlit) (2023.3)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from requests<3,>=2.27->streamlit) (3.3.2)\n",
      "Requirement already satisfied: idna<4,>=2.5 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from requests<3,>=2.27->streamlit) (3.7)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from requests<3,>=2.27->streamlit) (2.3.0)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from requests<3,>=2.27->streamlit) (2025.1.31)\n",
      "Collecting smmap<6,>=3.0.1 (from gitdb<5,>=4.0.1->gitpython!=3.1.19,<4,>=3.0.7->streamlit)\n",
      "  Downloading smmap-5.0.2-py3-none-any.whl.metadata (4.3 kB)\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from jinja2->altair<6,>=4.0->streamlit) (3.0.2)\n",
      "Requirement already satisfied: attrs>=22.2.0 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from jsonschema>=3.0->altair<6,>=4.0->streamlit) (24.3.0)\n",
      "Requirement already satisfied: jsonschema-specifications>=2023.03.6 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from jsonschema>=3.0->altair<6,>=4.0->streamlit) (2023.7.1)\n",
      "Requirement already satisfied: referencing>=0.28.4 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from jsonschema>=3.0->altair<6,>=4.0->streamlit) (0.30.2)\n",
      "Requirement already satisfied: rpds-py>=0.7.1 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from jsonschema>=3.0->altair<6,>=4.0->streamlit) (0.22.3)\n",
      "Requirement already satisfied: six>=1.5 in c:\\users\\pavan\\desktop\\sample_project\\env\\lib\\site-packages (from python-dateutil>=2.8.2->pandas<3,>=1.4.0->streamlit) (1.16.0)\n",
      "Downloading streamlit-1.45.1-py3-none-any.whl (9.9 MB)\n",
      "   ---------------------------------------- 0.0/9.9 MB ? eta -:--:--\n",
      "   ----------------- ---------------------- 4.2/9.9 MB 25.1 MB/s eta 0:00:01\n",
      "   ----------------------------------- ---- 8.7/9.9 MB 22.1 MB/s eta 0:00:01\n",
      "   ---------------------------------------- 9.9/9.9 MB 20.7 MB/s eta 0:00:00\n",
      "Downloading altair-5.5.0-py3-none-any.whl (731 kB)\n",
      "   ---------------------------------------- 0.0/731.2 kB ? eta -:--:--\n",
      "   --------------------------------------- 731.2/731.2 kB 12.9 MB/s eta 0:00:00\n",
      "Downloading blinker-1.9.0-py3-none-any.whl (8.5 kB)\n",
      "Downloading cachetools-5.5.2-py3-none-any.whl (10 kB)\n",
      "Downloading click-8.2.1-py3-none-any.whl (102 kB)\n",
      "Downloading GitPython-3.1.44-py3-none-any.whl (207 kB)\n",
      "Downloading pyarrow-20.0.0-cp313-cp313-win_amd64.whl (25.7 MB)\n",
      "   ---------------------------------------- 0.0/25.7 MB ? eta -:--:--\n",
      "   -------- ------------------------------- 5.2/25.7 MB 27.5 MB/s eta 0:00:01\n",
      "   ------------ --------------------------- 8.1/25.7 MB 25.8 MB/s eta 0:00:01\n",
      "   ---------------------- ----------------- 14.4/25.7 MB 22.9 MB/s eta 0:00:01\n",
      "   -------------------------- ------------- 17.3/25.7 MB 23.2 MB/s eta 0:00:01\n",
      "   -------------------------------------- - 24.4/25.7 MB 23.2 MB/s eta 0:00:01\n",
      "   ---------------------------------------- 25.7/25.7 MB 21.3 MB/s eta 0:00:00\n",
      "Downloading pydeck-0.9.1-py2.py3-none-any.whl (6.9 MB)\n",
      "   ---------------------------------------- 0.0/6.9 MB ? eta -:--:--\n",
      "   ---------------------------- ----------- 5.0/6.9 MB 27.2 MB/s eta 0:00:01\n",
      "   ---------------------------------------- 6.9/6.9 MB 21.3 MB/s eta 0:00:00\n",
      "Downloading tenacity-9.1.2-py3-none-any.whl (28 kB)\n",
      "Downloading toml-0.10.2-py2.py3-none-any.whl (16 kB)\n",
      "Downloading watchdog-6.0.0-py3-none-win_amd64.whl (79 kB)\n",
      "Downloading gitdb-4.0.12-py3-none-any.whl (62 kB)\n",
      "Downloading smmap-5.0.2-py3-none-any.whl (24 kB)\n",
      "Installing collected packages: watchdog, toml, tenacity, smmap, pyarrow, click, cachetools, blinker, pydeck, gitdb, gitpython, altair, streamlit\n",
      "Successfully installed altair-5.5.0 blinker-1.9.0 cachetools-5.5.2 click-8.2.1 gitdb-4.0.12 gitpython-3.1.44 pyarrow-20.0.0 pydeck-0.9.1 smmap-5.0.2 streamlit-1.45.1 tenacity-9.1.2 toml-0.10.2 watchdog-6.0.0\n"
     ]
    }
   ],
   "source": [
    "! pip install streamlit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2003ac80-9c7c-4e82-9eaa-a15d8a8b456b",
   "metadata": {},
   "outputs": [],
   "source": [
    "! streamlit hello"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8181d7cc-7599-4db1-a75f-ed6213fa90dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "import streamlit as st\n",
    "import pandas as pd\n",
    " \n",
    "st.write(\"\"\"\n",
    "# My first app\n",
    "Hello *world!*\n",
    "\"\"\")\n",
    " \n",
    "df = pd.read_csv(\"my_data.csv\")\n",
    "st.line_chart(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "03a874b8-45f1-4198-baa6-1791bacd1e3c",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
